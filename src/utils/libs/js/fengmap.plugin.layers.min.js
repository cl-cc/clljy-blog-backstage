/**Released Version v3.1.3,BUILD 653,Time 1691032744690. Fengmap Javascript SDK , see: https://www.fengmap.com for details**/
!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.fengmap=i():t.fengmap=i()}(this,function(){return n=[function(t,i,n){"use strict";!function(s){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===r(t)?t:String(t)}(e.key),e)}}var h=null,t=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")}var i,n,e,r;function o(){return r.apply(this,arguments)}return i=t,n=null,e=[{key:"global",value:(r=function(){if("undefined"!=typeof self&&null!==self&&0!==Object.keys(self).length)return self;if("undefined"!=typeof window&&null!==window&&0!==Object.keys(window).length)return window;if(null!=s&&0!==Object.keys(s).length)return s;var t;if("undefined"!=typeof my)return h||(t=my.getAppIdSync(),h={location:{host:t.appId+".hybrid.alipay-eco.com"}}),h;throw new Error("unable to locate global object")},o.toString=function(){return r.toString()},o)}],n&&u(i.prototype,n),e&&u(i,e),Object.defineProperty(i,"prototype",{writable:!1}),t}();i.a=t}.call(this,n(1))},function(t,i){var n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(B,D,t){"use strict";t.r(D);for(var h={},r=(t.r(h),t.d(h,"ShadowMaterial",function(){return El}),t.d(h,"SpriteMaterial",function(){return kl}),t.d(h,"RawShaderMaterial",function(){return Pl}),t.d(h,"ShaderMaterial",function(){return xl}),t.d(h,"PointsMaterial",function(){return Cl}),t.d(h,"MeshPhysicalMaterial",function(){return Il}),t.d(h,"MeshStandardMaterial",function(){return Ll}),t.d(h,"MeshPhongMaterial",function(){return Nl}),t.d(h,"MeshToonMaterial",function(){return Bl}),t.d(h,"MeshNormalMaterial",function(){return Dl}),t.d(h,"MeshLambertMaterial",function(){return Fl}),t.d(h,"MeshDepthMaterial",function(){return _l}),t.d(h,"MeshDistanceMaterial",function(){return Hl}),t.d(h,"MeshBasicMaterial",function(){return ji}),t.d(h,"MeshMatcapMaterial",function(){return Ul}),t.d(h,"LineDashedMaterial",function(){return Vl}),t.d(h,"LineBasicMaterial",function(){return Gl}),t.d(h,"Material",function(){return f}),[]),F=0;F<256;F++)r[F]=(F<16?"0":"")+F.toString(16);var g={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0,e=4294967295*Math.random()|0;return(r[255&t]+r[t>>8&255]+r[t>>16&255]+r[t>>24&255]+"-"+r[255&i]+r[i>>8&255]+"-"+r[i>>16&15|64]+r[i>>24&255]+"-"+r[63&n|128]+r[n>>8&255]+"-"+r[n>>16&255]+r[n>>24&255]+r[255&e]+r[e>>8&255]+r[e>>16&255]+r[e>>24&255]).toUpperCase()},clamp:function(t,i,n){return Math.max(i,Math.min(n,t))},euclideanModulo:function(t,i){return(t%i+i)%i},mapLinear:function(t,i,n,e,r){return e+(t-i)*(r-e)/(n-i)},lerp:function(t,i,n){return(1-n)*t+n*i},smoothstep:function(t,i,n){return t<=i?0:n<=t?1:(t=(t-i)/(n-i))*t*(3-2*t)},smootherstep:function(t,i,n){return t<=i?0:n<=t?1:(t=(t-i)/(n-i))*t*t*(t*(6*t-15)+10)},randInt:function(t,i){return t+Math.floor(Math.random()*(i-t+1))},randFloat:function(t,i){return t+Math.random()*(i-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*g.DEG2RAD},radToDeg:function(t){return t*g.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,i,n,e,r){var o=Math.cos,s=Math.sin,u=o(n/2),n=s(n/2),h=o((i+e)/2),a=s((i+e)/2),c=o((i-e)/2),f=s((i-e)/2),o=o((e-i)/2),s=s((e-i)/2);"XYX"===r?t.set(u*a,n*c,n*f,u*h):"YZY"===r?t.set(n*f,u*a,n*c,u*h):"ZXZ"===r?t.set(n*c,n*f,u*a,u*h):"XZX"===r?t.set(u*a,n*s,n*o,u*h):"YXY"===r?t.set(n*o,u*a,n*s,u*h):"ZYZ"===r?t.set(n*s,n*o,u*a,u*h):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};function _(t,i,n,e){this.u=t||0,this.v=i||0,this.j=n||0,this.M=void 0!==e?e:1}Object.assign(_,{slerp:function(t,i,n,e){return n.copy(t).slerp(i,e)},slerpFlat:function(t,i,n,e,r,o,s){var u,h,a,c=n[e+0],f=n[e+1],l=n[e+2],n=n[e+3],e=r[o+0],v=r[o+1],y=r[o+2],r=r[o+3];n===r&&c===e&&f===v&&l===y||(o=1-s,u=0<=(h=c*e+f*v+l*y+n*r)?1:-1,(a=1-h*h)>Number.EPSILON&&(a=Math.sqrt(a),h=Math.atan2(a,h*u),o=Math.sin(o*h)/a,s=Math.sin(s*h)/a),c=c*o+e*(h=s*u),f=f*o+v*h,l=l*o+y*h,n=n*o+r*h,o===1-s&&(c*=a=1/Math.sqrt(c*c+f*f+l*l+n*n),f*=a,l*=a,n*=a)),t[i]=c,t[i+1]=f,t[i+2]=l,t[i+3]=n}}),Object.defineProperties(_.prototype,{x:{get:function(){return this.u},set:function(t){this.u=t,this.S()}},y:{get:function(){return this.v},set:function(t){this.v=t,this.S()}},z:{get:function(){return this.j},set:function(t){this.j=t,this.S()}},w:{get:function(){return this.M},set:function(t){this.M=t,this.S()}}}),Object.assign(_.prototype,{isQuaternion:!0,set:function(t,i,n,e){return this.u=t,this.v=i,this.j=n,this.M=e,this.S(),this},clone:function(){return new this.constructor(this.u,this.v,this.j,this.M)},copy:function(t){return this.u=t.x,this.v=t.y,this.j=t.z,this.M=t.w,this.S(),this},setFromEuler:function(t,i){var n,e,r,o,s,u,h;if(t&&t.isEuler)return s=t.u,u=t.v,n=t.j,t=t.order,o=Math.cos,h=Math.sin,e=o(s/2),r=o(u/2),o=o(n/2),s=h(s/2),u=h(u/2),h=h(n/2),"XYZ"===t?(this.u=s*r*o+e*u*h,this.v=e*u*o-s*r*h,this.j=e*r*h+s*u*o,this.M=e*r*o-s*u*h):"YXZ"===t?(this.u=s*r*o+e*u*h,this.v=e*u*o-s*r*h,this.j=e*r*h-s*u*o,this.M=e*r*o+s*u*h):"ZXY"===t?(this.u=s*r*o-e*u*h,this.v=e*u*o+s*r*h,this.j=e*r*h+s*u*o,this.M=e*r*o-s*u*h):"ZYX"===t?(this.u=s*r*o-e*u*h,this.v=e*u*o+s*r*h,this.j=e*r*h-s*u*o,this.M=e*r*o+s*u*h):"YZX"===t?(this.u=s*r*o+e*u*h,this.v=e*u*o+s*r*h,this.j=e*r*h-s*u*o,this.M=e*r*o-s*u*h):"XZY"===t&&(this.u=s*r*o-e*u*h,this.v=e*u*o-s*r*h,this.j=e*r*h+s*u*o,this.M=e*r*o+s*u*h),!1!==i&&this.S(),this;throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.")},setFromAxisAngle:function(t,i){var i=i/2,n=Math.sin(i);return this.u=t.x*n,this.v=t.y*n,this.j=t.z*n,this.M=Math.cos(i),this.S(),this},setFromRotationMatrix:function(t){var i,t=t.elements,n=t[0],e=t[4],r=t[8],o=t[1],s=t[5],u=t[9],h=t[2],a=t[6],t=t[10],c=n+s+t;return 0<c?(i=.5/Math.sqrt(c+1),this.M=.25/i,this.u=(a-u)*i,this.v=(r-h)*i,this.j=(o-e)*i):s<n&&t<n?(i=2*Math.sqrt(1+n-s-t),this.M=(a-u)/i,this.u=.25*i,this.v=(e+o)/i,this.j=(r+h)/i):t<s?(i=2*Math.sqrt(1+s-n-t),this.M=(r-h)/i,this.u=(e+o)/i,this.v=.25*i,this.j=(u+a)/i):(i=2*Math.sqrt(1+t-n-s),this.M=(o-e)/i,this.u=(r+h)/i,this.v=(u+a)/i,this.j=.25*i),this.S(),this},setFromUnitVectors:function(t,i){var n=t.dot(i)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this.u=-t.y,this.v=t.x,this.j=0):(this.u=0,this.v=-t.z,this.j=t.y)):(this.u=t.y*i.z-t.z*i.y,this.v=t.z*i.x-t.x*i.z,this.j=t.x*i.y-t.y*i.x),this.M=n,this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(g.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,i){var n=this.angleTo(t);return 0!==n&&(i=Math.min(1,i/n),this.slerp(t,i)),this},inverse:function(){return this.conjugate()},conjugate:function(){return this.u*=-1,this.v*=-1,this.j*=-1,this.S(),this},dot:function(t){return this.u*t.u+this.v*t.v+this.j*t.j+this.M*t.M},lengthSq:function(){return this.u*this.u+this.v*this.v+this.j*this.j+this.M*this.M},length:function(){return Math.sqrt(this.u*this.u+this.v*this.v+this.j*this.j+this.M*this.M)},normalize:function(){var t=this.length();return 0===t?(this.u=0,this.v=0,this.j=0,this.M=1):(this.u=this.u*(t=1/t),this.v=this.v*t,this.j=this.j*t,this.M=this.M*t),this.S(),this},multiply:function(t,i){return void 0!==i?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,i)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,i){var n=t.u,e=t.v,r=t.j,t=t.M,o=i.u,s=i.v,u=i.j,i=i.M;return this.u=n*i+t*o+e*u-r*s,this.v=e*i+t*s+r*o-n*u,this.j=r*i+t*u+n*s-e*o,this.M=t*i-n*o-e*s-r*u,this.S(),this},slerp:function(t,i){if(0!==i){if(1===i)return this.copy(t);var n,e=this.u,r=this.v,o=this.j,s=this.M,u=s*t.M+e*t.u+r*t.v+o*t.j;u<0?(this.M=-t.M,this.u=-t.u,this.v=-t.v,this.j=-t.j,u=-u):this.copy(t),1<=u?(this.M=s,this.u=e,this.v=r,this.j=o):((t=1-u*u)<=Number.EPSILON?(this.M=(n=1-i)*s+i*this.M,this.u=n*e+i*this.u,this.v=n*r+i*this.v,this.j=n*o+i*this.j,this.normalize()):(n=Math.sqrt(t),t=Math.atan2(n,u),u=Math.sin((1-i)*t)/n,i=Math.sin(i*t)/n,this.M=s*u+this.M*i,this.u=e*u+this.u*i,this.v=r*u+this.v*i,this.j=o*u+this.j*i),this.S())}return this},equals:function(t){return t.u===this.u&&t.v===this.v&&t.j===this.j&&t.M===this.M},fromArray:function(t,i){return this.u=t[i=void 0===i?0:i],this.v=t[i+1],this.j=t[i+2],this.M=t[i+3],this.S(),this},toArray:function(t,i){return(t=void 0===t?[]:t)[i=void 0===i?0:i]=this.u,t[i+1]=this.v,t[i+2]=this.j,t[i+3]=this.M,t},fromBufferAttribute:function(t,i){return this.u=t.getX(i),this.v=t.getY(i),this.j=t.getZ(i),this.M=t.getW(i),this},O:function(t){return this.S=t,this},S:function(){}});var H=new j,U=new _;function j(t,i,n){this.x=t||0,this.y=i||0,this.z=n||0}Object.assign(j.prototype,{isVector3:!0,set:function(t,i,n){return this.x=t,this.y=i,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this},addScaledVector:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this},sub:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this},multiply:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,i)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(U.setFromEuler(t))},applyAxisAngle:function(t,i){return this.applyQuaternion(U.setFromAxisAngle(t,i))},applyMatrix3:function(t){var i=this.x,n=this.y,e=this.z,t=t.elements;return this.x=t[0]*i+t[3]*n+t[6]*e,this.y=t[1]*i+t[4]*n+t[7]*e,this.z=t[2]*i+t[5]*n+t[8]*e,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var i=this.x,n=this.y,e=this.z,t=t.elements,r=1/(t[3]*i+t[7]*n+t[11]*e+t[15]);return this.x=(t[0]*i+t[4]*n+t[8]*e+t[12])*r,this.y=(t[1]*i+t[5]*n+t[9]*e+t[13])*r,this.z=(t[2]*i+t[6]*n+t[10]*e+t[14])*r,this},applyQuaternion:function(t){var i=this.x,n=this.y,e=this.z,r=t.x,o=t.y,s=t.z,t=t.w,u=t*i+o*e-s*n,h=t*n+s*i-r*e,a=t*e+r*n-o*i,i=-r*i-o*n-s*e;return this.x=u*t+i*-r+h*-s-a*-o,this.y=h*t+i*-o+a*-r-u*-s,this.z=a*t+i*-s+u*-o-h*-r,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var i=this.x,n=this.y,e=this.z,t=t.elements;return this.x=t[0]*i+t[4]*n+t[8]*e,this.y=t[1]*i+t[5]*n+t[9]*e,this.z=t[2]*i+t[6]*n+t[10]*e,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this},clampScalar:function(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this},clampLength:function(t,i){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(i,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this},lerpVectors:function(t,i,n){return this.subVectors(i,t).multiplyScalar(n).add(t)},cross:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,i)):this.crossVectors(this,t)},crossVectors:function(t,i){var n=t.x,e=t.y,t=t.z,r=i.x,o=i.y,i=i.z;return this.x=e*i-t*o,this.y=t*r-n*i,this.z=n*o-e*r,this},projectOnVector:function(t){var i=t.lengthSq();return 0===i?this.set(0,0,0):(i=t.dot(this)/i,this.copy(t).multiplyScalar(i))},projectOnPlane:function(t){return H.copy(this).projectOnVector(t),this.sub(H)},reflect:function(t){return this.sub(H.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var i=Math.sqrt(this.lengthSq()*t.lengthSq());return 0===i?Math.PI/2:(t=this.dot(t)/i,Math.acos(g.clamp(t,-1,1)))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var i=this.x-t.x,n=this.y-t.y,t=this.z-t.z;return i*i+n*n+t*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,i,n){var e=Math.sin(i)*t;return this.x=e*Math.sin(n),this.y=Math.cos(i)*t,this.z=e*Math.cos(n),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,i,n){return this.x=t*Math.sin(i),this.y=n,this.z=t*Math.cos(i),this},setFromMatrixPosition:function(t){t=t.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(t){var i=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),t=this.setFromMatrixColumn(t,2).length();return this.x=i,this.y=n,this.z=t,this},setFromMatrixColumn:function(t,i){return this.fromArray(t.elements,4*i)},setFromMatrix3Column:function(t,i){return this.fromArray(t.elements,3*i)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,i){return this.x=t[i=void 0===i?0:i],this.y=t[i+1],this.z=t[i+2],this},toArray:function(t,i){return(t=void 0===t?[]:t)[i=void 0===i?0:i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t},fromBufferAttribute:function(t,i,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this}});var G=new j,V=new p,q=new j(0,0,0),z=new j(1,1,1),X=new j,Z=new j,W=new j;function p(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function Y(){}Object.assign(p.prototype,{isMatrix4:!0,set:function(t,i,n,e,r,o,s,u,h,a,c,f,l,v,y,d){var b=this.elements;return b[0]=t,b[4]=i,b[8]=n,b[12]=e,b[1]=r,b[5]=o,b[9]=s,b[13]=u,b[2]=h,b[6]=a,b[10]=c,b[14]=f,b[3]=l,b[7]=v,b[11]=y,b[15]=d,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new p).fromArray(this.elements)},copy:function(t){var i=this.elements,t=t.elements;return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],this},copyPosition:function(t){var i=this.elements,t=t.elements;return i[12]=t[12],i[13]=t[13],i[14]=t[14],this},extractBasis:function(t,i,n){return t.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,i,n){return this.set(t.x,i.x,n.x,0,t.y,i.y,n.y,0,t.z,i.z,n.z,0,0,0,0,1),this},extractRotation:function(t){var i=this.elements,n=t.elements,e=1/G.setFromMatrixColumn(t,0).length(),r=1/G.setFromMatrixColumn(t,1).length(),t=1/G.setFromMatrixColumn(t,2).length();return i[0]=n[0]*e,i[1]=n[1]*e,i[2]=n[2]*e,i[3]=0,i[4]=n[4]*r,i[5]=n[5]*r,i[6]=n[6]*r,i[7]=0,i[8]=n[8]*t,i[9]=n[9]*t,i[10]=n[10]*t,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var i,n,e,r,o,s,u,h,a,c,f,l,v=this.elements,y=t.x,d=t.y,b=t.z,p=Math.cos(y),y=Math.sin(y),m=Math.cos(d),d=Math.sin(d),w=Math.cos(b),b=Math.sin(b);return"XYZ"===t.order?(o=p*w,s=p*b,u=y*w,h=y*b,v[0]=m*w,v[4]=-m*b,v[8]=d,v[1]=s+u*d,v[5]=o-h*d,v[9]=-y*m,v[2]=h-o*d,v[6]=u+s*d,v[10]=p*m):"YXZ"===t.order?(n=m*b,e=d*w,v[0]=(i=m*w)+(r=d*b)*y,v[4]=e*y-n,v[8]=p*d,v[1]=p*b,v[5]=p*w,v[9]=-y,v[2]=n*y-e,v[6]=r+i*y,v[10]=p*m):"ZXY"===t.order?(n=m*b,e=d*w,v[0]=(i=m*w)-(r=d*b)*y,v[4]=-p*b,v[8]=e+n*y,v[1]=n+e*y,v[5]=p*w,v[9]=r-i*y,v[2]=-p*d,v[6]=y,v[10]=p*m):"ZYX"===t.order?(o=p*w,s=p*b,u=y*w,h=y*b,v[0]=m*w,v[4]=u*d-s,v[8]=o*d+h,v[1]=m*b,v[5]=h*d+o,v[9]=s*d-u,v[2]=-d,v[6]=y*m,v[10]=p*m):"YZX"===t.order?(a=p*m,c=p*d,f=y*m,l=y*d,v[0]=m*w,v[4]=l-a*b,v[8]=f*b+c,v[1]=b,v[5]=p*w,v[9]=-y*w,v[2]=-d*w,v[6]=c*b+f,v[10]=a-l*b):"XZY"===t.order&&(a=p*m,c=p*d,f=y*m,l=y*d,v[0]=m*w,v[4]=-b,v[8]=d*w,v[1]=a*b+l,v[5]=p*w,v[9]=c*b-f,v[2]=f*b-c,v[6]=y*w,v[10]=l*b+a),v[3]=0,v[7]=0,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(q,t,z)},lookAt:function(t,i,n){var e=this.elements;return W.subVectors(t,i),0===W.lengthSq()&&(W.z=1),W.normalize(),X.crossVectors(n,W),0===X.lengthSq()&&(1===Math.abs(n.z)?W.x+=1e-4:W.z+=1e-4,W.normalize(),X.crossVectors(n,W)),X.normalize(),Z.crossVectors(W,X),e[0]=X.x,e[4]=Z.x,e[8]=W.x,e[1]=X.y,e[5]=Z.y,e[9]=W.y,e[2]=X.z,e[6]=Z.z,e[10]=W.z,this},multiply:function(t,i){return void 0!==i?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,i)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,i){var t=t.elements,i=i.elements,n=this.elements,e=t[0],r=t[4],o=t[8],s=t[12],u=t[1],h=t[5],a=t[9],c=t[13],f=t[2],l=t[6],v=t[10],y=t[14],d=t[3],b=t[7],p=t[11],t=t[15],m=i[0],w=i[4],g=i[8],j=i[12],M=i[1],S=i[5],O=i[9],E=i[13],k=i[2],T=i[6],R=i[10],A=i[14],x=i[3],P=i[7],C=i[11],i=i[15];return n[0]=e*m+r*M+o*k+s*x,n[4]=e*w+r*S+o*T+s*P,n[8]=e*g+r*O+o*R+s*C,n[12]=e*j+r*E+o*A+s*i,n[1]=u*m+h*M+a*k+c*x,n[5]=u*w+h*S+a*T+c*P,n[9]=u*g+h*O+a*R+c*C,n[13]=u*j+h*E+a*A+c*i,n[2]=f*m+l*M+v*k+y*x,n[6]=f*w+l*S+v*T+y*P,n[10]=f*g+l*O+v*R+y*C,n[14]=f*j+l*E+v*A+y*i,n[3]=d*m+b*M+p*k+t*x,n[7]=d*w+b*S+p*T+t*P,n[11]=d*g+b*O+p*R+t*C,n[15]=d*j+b*E+p*A+t*i,this},multiplyScalar:function(t){var i=this.elements;return i[0]*=t,i[4]*=t,i[8]*=t,i[12]*=t,i[1]*=t,i[5]*=t,i[9]*=t,i[13]*=t,i[2]*=t,i[6]*=t,i[10]*=t,i[14]*=t,i[3]*=t,i[7]*=t,i[11]*=t,i[15]*=t,this},determinant:function(){var t=this.elements,i=t[0],n=t[4],e=t[8],r=t[12],o=t[1],s=t[5],u=t[9],h=t[13],a=t[2],c=t[6],f=t[10],l=t[14];return t[3]*(+r*u*c-e*h*c-r*s*f+n*h*f+e*s*l-n*u*l)+t[7]*(+i*u*l-i*h*f+r*o*f-e*o*l+e*h*a-r*u*a)+t[11]*(+i*h*c-i*s*l-r*o*c+n*o*l+r*s*a-n*h*a)+t[15]*(-e*s*a-i*u*c+i*s*f+e*o*c-n*o*f+n*u*a)},transpose:function(){var t=this.elements,i=t[1];return t[1]=t[4],t[4]=i,i=t[2],t[2]=t[8],t[8]=i,i=t[6],t[6]=t[9],t[9]=i,i=t[3],t[3]=t[12],t[12]=i,i=t[7],t[7]=t[13],t[13]=i,i=t[11],t[11]=t[14],t[14]=i,this},setPosition:function(t,i,n){var e=this.elements;return t.isVector3?(e[12]=t.x,e[13]=t.y,e[14]=t.z):(e[12]=t,e[13]=i,e[14]=n),this},getInverse:function(t,i){void 0!==i&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");var i=this.elements,t=t.elements,n=t[0],e=t[1],r=t[2],o=t[3],s=t[4],u=t[5],h=t[6],a=t[7],c=t[8],f=t[9],l=t[10],v=t[11],y=t[12],d=t[13],b=t[14],t=t[15],p=f*b*a-d*l*a+d*h*v-u*b*v-f*h*t+u*l*t,m=y*l*a-c*b*a-y*h*v+s*b*v+c*h*t-s*l*t,w=c*d*a-y*f*a+y*u*v-s*d*v-c*u*t+s*f*t,g=y*f*h-c*d*h-y*u*l+s*d*l+c*u*b-s*f*b,j=n*p+e*m+r*w+o*g;return 0==j?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(i[0]=p*(p=1/j),i[1]=(d*l*o-f*b*o-d*r*v+e*b*v+f*r*t-e*l*t)*p,i[2]=(u*b*o-d*h*o+d*r*a-e*b*a-u*r*t+e*h*t)*p,i[3]=(f*h*o-u*l*o-f*r*a+e*l*a+u*r*v-e*h*v)*p,i[4]=m*p,i[5]=(c*b*o-y*l*o+y*r*v-n*b*v-c*r*t+n*l*t)*p,i[6]=(y*h*o-s*b*o-y*r*a+n*b*a+s*r*t-n*h*t)*p,i[7]=(s*l*o-c*h*o+c*r*a-n*l*a-s*r*v+n*h*v)*p,i[8]=w*p,i[9]=(y*f*o-c*d*o-y*e*v+n*d*v+c*e*t-n*f*t)*p,i[10]=(s*d*o-y*u*o+y*e*a-n*d*a-s*e*t+n*u*t)*p,i[11]=(c*u*o-s*f*o-c*e*a+n*f*a+s*e*v-n*u*v)*p,i[12]=g*p,i[13]=(c*d*r-y*f*r+y*e*l-n*d*l-c*e*b+n*f*b)*p,i[14]=(y*u*r-s*d*r-y*e*h+n*d*h+s*e*b-n*u*b)*p,i[15]=(s*f*r-c*u*r+c*e*h-n*f*h-s*e*l+n*u*l)*p,this)},invert:function(){var t=this.elements,i=t[0],n=t[1],e=t[2],r=t[3],o=t[4],s=t[5],u=t[6],h=t[7],a=t[8],c=t[9],f=t[10],l=t[11],v=t[12],y=t[13],d=t[14],b=t[15],p=c*d*h-y*f*h+y*u*l-s*d*l-c*u*b+s*f*b,m=v*f*h-a*d*h-v*u*l+o*d*l+a*u*b-o*f*b,w=a*y*h-v*c*h+v*s*l-o*y*l-a*s*b+o*c*b,g=v*c*u-a*y*u-v*s*f+o*y*f+a*s*d-o*c*d,j=i*p+n*m+e*w+r*g;return 0==j?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(t[0]=p*(p=1/j),t[1]=(y*f*r-c*d*r-y*e*l+n*d*l+c*e*b-n*f*b)*p,t[2]=(s*d*r-y*u*r+y*e*h-n*d*h-s*e*b+n*u*b)*p,t[3]=(c*u*r-s*f*r-c*e*h+n*f*h+s*e*l-n*u*l)*p,t[4]=m*p,t[5]=(a*d*r-v*f*r+v*e*l-i*d*l-a*e*b+i*f*b)*p,t[6]=(v*u*r-o*d*r-v*e*h+i*d*h+o*e*b-i*u*b)*p,t[7]=(o*f*r-a*u*r+a*e*h-i*f*h-o*e*l+i*u*l)*p,t[8]=w*p,t[9]=(v*c*r-a*y*r-v*n*l+i*y*l+a*n*b-i*c*b)*p,t[10]=(o*y*r-v*s*r+v*n*h-i*y*h-o*n*b+i*s*b)*p,t[11]=(a*s*r-o*c*r-a*n*h+i*c*h+o*n*l-i*s*l)*p,t[12]=g*p,t[13]=(a*y*e-v*c*e+v*n*f-i*y*f-a*n*d+i*c*d)*p,t[14]=(v*s*e-o*y*e-v*n*u+i*y*u+o*n*d-i*s*d)*p,t[15]=(o*c*e-a*s*e+a*n*u-i*c*u-o*n*f+i*s*f)*p,this)},scale:function(t){var i=this.elements,n=t.x,e=t.y,t=t.z;return i[0]*=n,i[4]*=e,i[8]*=t,i[1]*=n,i[5]*=e,i[9]*=t,i[2]*=n,i[6]*=e,i[10]*=t,i[3]*=n,i[7]*=e,i[11]*=t,this},getMaxScaleOnAxis:function(){var t=this.elements,i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(i,n,t))},makeTranslation:function(t,i,n){return this.set(1,0,0,t,0,1,0,i,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var i=Math.cos(t),t=Math.sin(t);return this.set(1,0,0,0,0,i,-t,0,0,t,i,0,0,0,0,1),this},makeRotationY:function(t){var i=Math.cos(t),t=Math.sin(t);return this.set(i,0,t,0,0,1,0,0,-t,0,i,0,0,0,0,1),this},makeRotationZ:function(t){var i=Math.cos(t),t=Math.sin(t);return this.set(i,-t,0,0,t,i,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,i){var n=Math.cos(i),i=Math.sin(i),e=1-n,r=t.x,o=t.y,t=t.z,s=e*r,u=e*o;return this.set(s*r+n,s*o-i*t,s*t+i*o,0,s*o+i*t,u*o+n,u*t-i*r,0,s*t-i*o,u*t+i*r,e*t*t+n,0,0,0,0,1),this},makeScale:function(t,i,n){return this.set(t,0,0,0,0,i,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,i,n){return this.set(1,i,n,0,t,1,n,0,t,i,1,0,0,0,0,1),this},compose:function(t,i,n){var e=this.elements,r=i.u,o=i.v,s=i.j,i=i.M,u=r+r,h=o+o,a=s+s,c=r*u,f=r*h,r=r*a,l=o*h,o=o*a,s=s*a,u=i*u,h=i*h,i=i*a,a=n.x,v=n.y,n=n.z;return e[0]=(1-(l+s))*a,e[1]=(f+i)*a,e[2]=(r-h)*a,e[3]=0,e[4]=(f-i)*v,e[5]=(1-(c+s))*v,e[6]=(o+u)*v,e[7]=0,e[8]=(r+h)*n,e[9]=(o-u)*n,e[10]=(1-(c+l))*n,e[11]=0,e[12]=t.x,e[13]=t.y,e[14]=t.z,e[15]=1,this},decompose:function(t,i,n){var e=this.elements,r=G.set(e[0],e[1],e[2]).length(),o=G.set(e[4],e[5],e[6]).length(),s=G.set(e[8],e[9],e[10]).length(),t=(this.determinant()<0&&(r=-r),t.x=e[12],t.y=e[13],t.z=e[14],V.copy(this),1/r),e=1/o,u=1/s;return V.elements[0]*=t,V.elements[1]*=t,V.elements[2]*=t,V.elements[4]*=e,V.elements[5]*=e,V.elements[6]*=e,V.elements[8]*=u,V.elements[9]*=u,V.elements[10]*=u,i.setFromRotationMatrix(V),n.x=r,n.y=o,n.z=s,this},makePerspective:function(t,i,n,e,r,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var s=this.elements,u=2*r/(n-e),h=(i+t)/(i-t),n=(n+e)/(n-e),e=-(o+r)/(o-r),o=-2*o*r/(o-r);return s[0]=2*r/(i-t),s[4]=0,s[8]=h,s[12]=0,s[1]=0,s[5]=u,s[9]=n,s[13]=0,s[2]=0,s[6]=0,s[10]=e,s[14]=o,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this},makeOrthographic:function(t,i,n,e,r,o){var s=this.elements,u=1/(i-t),h=1/(n-e),a=1/(o-r),i=(i+t)*u,t=(n+e)*h,n=(o+r)*a;return s[0]=2*u,s[4]=0,s[8]=0,s[12]=-i,s[1]=0,s[5]=2*h,s[9]=0,s[13]=-t,s[2]=0,s[6]=0,s[10]=-2*a,s[14]=-n,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this},equals:function(t){for(var i=this.elements,n=t.elements,e=0;e<16;e++)if(i[e]!==n[e])return!1;return!0},fromArray:function(t,i){void 0===i&&(i=0);for(var n=0;n<16;n++)this.elements[n]=t[n+i];return this},toArray:function(t,i){var n=this.elements;return(t=void 0===t?[]:t)[i=void 0===i?0:i]=n[0],t[i+1]=n[1],t[i+2]=n[2],t[i+3]=n[3],t[i+4]=n[4],t[i+5]=n[5],t[i+6]=n[6],t[i+7]=n[7],t[i+8]=n[8],t[i+9]=n[9],t[i+10]=n[10],t[i+11]=n[11],t[i+12]=n[12],t[i+13]=n[13],t[i+14]=n[14],t[i+15]=n[15],t}}),Object.assign(Y.prototype,{addEventListener:function(t,i){void 0===this.k&&(this.k={});var n=this.k;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(i)&&n[t].push(i)},hasEventListener:function(t,i){var n;return void 0!==this.k&&void 0!==(n=this.k)[t]&&-1!==n[t].indexOf(i)},removeEventListener:function(t,i){var n;void 0!==this.k&&void 0!==(t=this.k[t])&&-1!==(n=t.indexOf(i))&&t.splice(n,1)},dispatchEvent:function(t){if(void 0!==this.k){var i=this.k[t.type];if(void 0!==i){t.target=this;for(var n=i.slice(0),e=0,r=n.length;e<r;e++)n[e].call(this,t)}}}});var K=new p,Q=new _;function $(t,i,n,e){this.u=t||0,this.v=i||0,this.j=n||0,this.T=e||$.DefaultOrder}function J(){this.mask=1}function tt(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}$.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],$.DefaultOrder="XYZ",Object.defineProperties($.prototype,{x:{get:function(){return this.u},set:function(t){this.u=t,this.S()}},y:{get:function(){return this.v},set:function(t){this.v=t,this.S()}},z:{get:function(){return this.j},set:function(t){this.j=t,this.S()}},order:{get:function(){return this.T},set:function(t){this.T=t,this.S()}}}),Object.assign($.prototype,{isEuler:!0,set:function(t,i,n,e){return this.u=t,this.v=i,this.j=n,this.T=e||this.T,this.S(),this},clone:function(){return new this.constructor(this.u,this.v,this.j,this.T)},copy:function(t){return this.u=t.u,this.v=t.v,this.j=t.j,this.T=t.T,this.S(),this},setFromRotationMatrix:function(t,i,n){var e=g.clamp,t=t.elements,r=t[0],o=t[4],s=t[8],u=t[1],h=t[5],a=t[9],c=t[2],f=t[6],t=t[10];return"XYZ"===(i=i||this.T)?(this.v=Math.asin(e(s,-1,1)),Math.abs(s)<.9999999?(this.u=Math.atan2(-a,t),this.j=Math.atan2(-o,r)):(this.u=Math.atan2(f,h),this.j=0)):"YXZ"===i?(this.u=Math.asin(-e(a,-1,1)),Math.abs(a)<.9999999?(this.v=Math.atan2(s,t),this.j=Math.atan2(u,h)):(this.v=Math.atan2(-c,r),this.j=0)):"ZXY"===i?(this.u=Math.asin(e(f,-1,1)),Math.abs(f)<.9999999?(this.v=Math.atan2(-c,t),this.j=Math.atan2(-o,h)):(this.v=0,this.j=Math.atan2(u,r))):"ZYX"===i?(this.v=Math.asin(-e(c,-1,1)),Math.abs(c)<.9999999?(this.u=Math.atan2(f,t),this.j=Math.atan2(u,r)):(this.u=0,this.j=Math.atan2(-o,h))):"YZX"===i?(this.j=Math.asin(e(u,-1,1)),Math.abs(u)<.9999999?(this.u=Math.atan2(-a,h),this.v=Math.atan2(-c,r)):(this.u=0,this.v=Math.atan2(s,t))):"XZY"===i?(this.j=Math.asin(-e(o,-1,1)),Math.abs(o)<.9999999?(this.u=Math.atan2(f,h),this.v=Math.atan2(s,r)):(this.u=Math.atan2(-a,t),this.v=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+i),this.T=i,!1!==n&&this.S(),this},setFromQuaternion:function(t,i,n){return K.makeRotationFromQuaternion(t),this.setFromRotationMatrix(K,i,n)},setFromVector3:function(t,i){return this.set(t.x,t.y,t.z,i||this.T)},reorder:function(t){return Q.setFromEuler(this),this.setFromQuaternion(Q,t)},equals:function(t){return t.u===this.u&&t.v===this.v&&t.j===this.j&&t.T===this.T},fromArray:function(t){return this.u=t[0],this.v=t[1],this.j=t[2],void 0!==t[3]&&(this.T=t[3]),this.S(),this},toArray:function(t,i){return(t=void 0===t?[]:t)[i=void 0===i?0:i]=this.u,t[i+1]=this.v,t[i+2]=this.j,t[i+3]=this.T,t},toVector3:function(t){return t?t.set(this.u,this.v,this.j):new j(this.u,this.v,this.j)},O:function(t){return this.S=t,this},S:function(){}}),Object.assign(J.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}}),Object.assign(tt.prototype,{isMatrix3:!0,set:function(t,i,n,e,r,o,s,u,h){var a=this.elements;return a[0]=t,a[1]=e,a[2]=s,a[3]=i,a[4]=r,a[5]=u,a[6]=n,a[7]=o,a[8]=h,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var i=this.elements,t=t.elements;return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],this},extractBasis:function(t,i,n){return t.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){t=t.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,i){var t=t.elements,i=i.elements,n=this.elements,e=t[0],r=t[3],o=t[6],s=t[1],u=t[4],h=t[7],a=t[2],c=t[5],t=t[8],f=i[0],l=i[3],v=i[6],y=i[1],d=i[4],b=i[7],p=i[2],m=i[5],i=i[8];return n[0]=e*f+r*y+o*p,n[3]=e*l+r*d+o*m,n[6]=e*v+r*b+o*i,n[1]=s*f+u*y+h*p,n[4]=s*l+u*d+h*m,n[7]=s*v+u*b+h*i,n[2]=a*f+c*y+t*p,n[5]=a*l+c*d+t*m,n[8]=a*v+c*b+t*i,this},multiplyScalar:function(t){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=t,i[4]*=t,i[7]*=t,i[2]*=t,i[5]*=t,i[8]*=t,this},determinant:function(){var t=this.elements,i=t[0],n=t[1],e=t[2],r=t[3],o=t[4],s=t[5],u=t[6],h=t[7],t=t[8];return i*o*t-i*s*h-n*r*t+n*s*u+e*r*h-e*o*u},getInverse:function(t,i){void 0!==i&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var i=t.elements,t=this.elements,n=i[0],e=i[1],r=i[2],o=i[3],s=i[4],u=i[5],h=i[6],a=i[7],i=i[8],c=i*s-u*a,f=u*h-i*o,l=a*o-s*h,v=n*c+e*f+r*l;return 0==v?this.set(0,0,0,0,0,0,0,0,0):(t[0]=c*(c=1/v),t[1]=(r*a-i*e)*c,t[2]=(u*e-r*s)*c,t[3]=f*c,t[4]=(i*n-r*h)*c,t[5]=(r*o-u*n)*c,t[6]=l*c,t[7]=(e*h-a*n)*c,t[8]=(s*n-e*o)*c,this)},transpose:function(){var t=this.elements,i=t[1];return t[1]=t[3],t[3]=i,i=t[2],t[2]=t[6],t[6]=i,i=t[5],t[5]=t[7],t[7]=i,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var i=this.elements;return t[0]=i[0],t[1]=i[3],t[2]=i[6],t[3]=i[1],t[4]=i[4],t[5]=i[7],t[6]=i[2],t[7]=i[5],t[8]=i[8],this},setUvTransform:function(t,i,n,e,r,o,s){var u=Math.cos(r),r=Math.sin(r);this.set(n*u,n*r,-n*(u*o+r*s)+o+t,-e*r,e*u,-e*(-r*o+u*s)+s+i,0,0,1)},scale:function(t,i){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=i,n[4]*=i,n[7]*=i,this},rotate:function(t){var i=Math.cos(t),t=Math.sin(t),n=this.elements,e=n[0],r=n[3],o=n[6],s=n[1],u=n[4],h=n[7];return n[0]=i*e+t*s,n[3]=i*r+t*u,n[6]=i*o+t*h,n[1]=-t*e+i*s,n[4]=-t*r+i*u,n[7]=-t*o+i*h,this},translate:function(t,i){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=i*n[2],n[4]+=i*n[5],n[7]+=i*n[8],this},equals:function(t){for(var i=this.elements,n=t.elements,e=0;e<9;e++)if(i[e]!==n[e])return!1;return!0},fromArray:function(t,i){void 0===i&&(i=0);for(var n=0;n<9;n++)this.elements[n]=t[n+i];return this},toArray:function(t,i){var n=this.elements;return(t=void 0===t?[]:t)[i=void 0===i?0:i]=n[0],t[i+1]=n[1],t[i+2]=n[2],t[i+3]=n[3],t[i+4]=n[4],t[i+5]=n[5],t[i+6]=n[6],t[i+7]=n[7],t[i+8]=n[8],t}});var it=0,nt=new j,et=new _,rt=new p,ot=new j,st=new j,ut=new j,ht=new _,at=new j(1,0,0),ct=new j(0,1,0),ft=new j(0,0,1),lt={type:"added"},vt={type:"removed"};function u(){Object.defineProperty(this,"id",{value:it++}),this.uuid=g.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=u.DefaultUp.clone();var t=new j,i=new $,n=new _,e=new j(1,1,1);i.O(function(){n.setFromEuler(i,!1)}),n.O(function(){i.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:e},modelViewMatrix:{value:new p},normalMatrix:{value:new tt}}),this.matrix=new p,this.matrixWorld=new p,this.matrixAutoUpdate=u.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new J,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function yt(){u.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}u.DefaultUp=new j(0,1,0),u.DefaultMatrixAutoUpdate=!0,u.prototype=Object.assign(Object.create(Y.prototype),{constructor:u,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,i){this.quaternion.setFromAxisAngle(t,i)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,i){return et.setFromAxisAngle(t,i),this.quaternion.multiply(et),this},rotateOnWorldAxis:function(t,i){return et.setFromAxisAngle(t,i),this.quaternion.premultiply(et),this},rotateX:function(t){return this.rotateOnAxis(at,t)},rotateY:function(t){return this.rotateOnAxis(ct,t)},rotateZ:function(t){return this.rotateOnAxis(ft,t)},translateOnAxis:function(t,i){return nt.copy(t).applyQuaternion(this.quaternion),this.position.add(nt.multiplyScalar(i)),this},translateX:function(t){return this.translateOnAxis(at,t)},translateY:function(t){return this.translateOnAxis(ct,t)},translateZ:function(t){return this.translateOnAxis(ft,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(rt.getInverse(this.matrixWorld))},lookAt:function(t,i,n){t.isVector3?ot.copy(t):ot.set(t,i,n);t=this.parent;this.updateWorldMatrix(!0,!1),st.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?rt.lookAt(st,ot,this.up):rt.lookAt(ot,st,this.up),this.quaternion.setFromRotationMatrix(rt),t&&(rt.extractRotation(t.matrixWorld),et.setFromRotationMatrix(rt),this.quaternion.premultiply(et.inverse()))},add:function(t){if(1<arguments.length)for(var i=0;i<arguments.length;i++)this.add(arguments[i]);else t===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",t):t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),(t.parent=this).children.push(t),t.dispatchEvent(lt)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t);return this},remove:function(t){if(1<arguments.length)for(var i=0;i<arguments.length;i++)this.remove(arguments[i]);else{var n=this.children.indexOf(t);-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(vt))}return this},attach:function(t){return this.updateWorldMatrix(!0,!1),rt.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),rt.multiply(t.parent.matrixWorld)),t.applyMatrix4(rt),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,i){if(this[t]===i)return this;for(var n=0,e=this.children.length;n<e;n++){var r=this.children[n].getObjectByProperty(t,i);if(void 0!==r)return r}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new j),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new _),this.updateMatrixWorld(!0),this.matrixWorld.decompose(st,t,ut),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new j),this.updateMatrixWorld(!0),this.matrixWorld.decompose(st,ht,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new j),this.updateMatrixWorld(!0);var i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var i=this.children,n=0,e=i.length;n<e;n++)i[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var i=this.children,n=0,e=i.length;n<e;n++)i[n].traverseVisible(t)}},traverseAncestors:function(t){var i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t=!(this.matrixWorldNeedsUpdate=!1));for(var i=this.children,n=0,e=i.length;n<e;n++)i[n].updateMatrixWorld(t)},updateWorldMatrix:function(t,i){var n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i)for(var e=this.children,r=0,o=e.length;r<o;r++)e[r].updateWorldMatrix(!1,!0)},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,i){if(void 0===i&&(i=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(var n=0;n<t.children.length;n++){var e=t.children[n];this.add(e.clone())}return this}}),yt.prototype=Object.assign(Object.create(u.prototype),{constructor:yt,isScene:!0,copy:function(t,i){return u.prototype.copy.call(this,t,i),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var dt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},bt={h:0,s:0,l:0},pt={h:0,s:0,l:0};function y(t,i,n){return void 0===i&&void 0===n?this.set(t):this.setRGB(t,i,n)}function mt(t,i,n){return n<0&&(n+=1),1<n&&--n,n<1/6?t+6*(i-t)*n:n<.5?i:n<2/3?t+6*(i-t)*(2/3-n):t}function wt(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function gt(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function jt(t,i,n){this.name="",this.color=new y(t),this.near=void 0!==i?i:1,this.far=void 0!==n?n:1e3}Object.assign(y.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,i,n){return this.r=t,this.g=i,this.b=n,this},setHSL:function(t,i,n){return t=g.euclideanModulo(t,1),i=g.clamp(i,0,1),n=g.clamp(n,0,1),0===i?this.r=this.g=this.b=n:(this.r=mt(i=2*n-(n=n<=.5?n*(1+i):n+i-n*i),n,t+1/3),this.g=mt(i,n,t),this.b=mt(i,n,t-1/3)),this},setStyle:function(i){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+i+" will be ignored.")}if(h=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(i)){var n,e,r,o,s=h[1],u=h[2];switch(s){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(u))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,t(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(u))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,t(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(u))return e=parseFloat(n[1])/360,r=parseInt(n[2],10)/100,o=parseInt(n[3],10)/100,t(n[5]),this.setHSL(e,r,o)}}else if(h=/^\#([A-Fa-f0-9]+)$/.exec(i)){var s=h[1],h=s.length;if(3===h)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,this;if(6===h)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,this}return i&&0<i.length?this.setColorName(i):this},setColorName:function(t){var i=dt[t];return void 0!==i?this.setHex(i):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,i){return void 0===i&&(i=2),this.r=Math.pow(t.r,i),this.g=Math.pow(t.g,i),this.b=Math.pow(t.b,i),this},copyLinearToGamma:function(t,i){i=0<(i=void 0===i?2:i)?1/i:1;return this.r=Math.pow(t.r,i),this.g=Math.pow(t.g,i),this.b=Math.pow(t.b,i),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=wt(t.r),this.g=wt(t.g),this.b=wt(t.b),this},copyLinearToSRGB:function(t){return this.r=gt(t.r),this.g=gt(t.g),this.b=gt(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var i,n=this.r,e=this.g,r=this.b,o=Math.max(n,e,r),s=Math.min(n,e,r),u=(s+o)/2;if(s===o)a=i=0;else{var h=o-s,a=u<=.5?h/(o+s):h/(2-o-s);switch(o){case n:i=(e-r)/h+(e<r?6:0);break;case e:i=(r-n)/h+2;break;case r:i=(n-e)/h+4}i/=6}return t.h=i,t.s=a,t.l=u,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,i,n){return this.getHSL(bt),bt.h+=t,bt.s+=i,bt.l+=n,this.setHSL(bt.h,bt.s,bt.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,i){return this.r=t.r+i.r,this.g=t.g+i.g,this.b=t.b+i.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,i){return this.r+=(t.r-this.r)*i,this.g+=(t.g-this.g)*i,this.b+=(t.b-this.b)*i,this},lerpHSL:function(t,i){this.getHSL(bt),t.getHSL(pt);var t=g.lerp(bt.h,pt.h,i),n=g.lerp(bt.s,pt.s,i),i=g.lerp(bt.l,pt.l,i);return this.setHSL(t,n,i),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,i){return this.r=t[i=void 0===i?0:i],this.g=t[i+1],this.b=t[i+2],this},toArray:function(t,i){return(t=void 0===t?[]:t)[i=void 0===i?0:i]=this.r,t[i+1]=this.g,t[i+2]=this.b,t}}),y.NAMES=dt,Object.assign(jt.prototype,{isFog:!0,clone:function(){return new jt(this.color,this.near,this.far)}});var Mt=[new j,new j,new j,new j,new j,new j,new j,new j],St=new j,Ot=new Nt,Et=new j,kt=new j,Tt=new j,Rt=new j,At=new j,xt=new j,Pt=new j,Ct=new j,Lt=new j,It=new j;function Nt(t,i){this.min=void 0!==t?t:new j(1/0,1/0,1/0),this.max=void 0!==i?i:new j(-1/0,-1/0,-1/0)}function Bt(t,i,n,e,r){for(var o=0,s=t.length-3;o<=s;o+=3){It.fromArray(t,o);var u=r.x*Math.abs(It.x)+r.y*Math.abs(It.y)+r.z*Math.abs(It.z),h=i.dot(It),a=n.dot(It),c=e.dot(It);if(Math.max(-Math.max(h,a,c),Math.min(h,a,c))>u)return!1}return!0}function Dt(t,i,n,e){this.x=t||0,this.y=i||0,this.z=n||0,this.w=void 0!==e?e:1}function I(t,i){this.x=t||0,this.y=i||0}Object.assign(Nt.prototype,{isBox3:!0,set:function(t,i){return this.min.copy(t),this.max.copy(i),this},setFromArray:function(t){for(var i=1/0,n=1/0,e=1/0,r=-1/0,o=-1/0,s=-1/0,u=0,h=t.length;u<h;u+=3){var a=t[u],c=t[u+1],f=t[u+2];a<i&&(i=a),c<n&&(n=c),f<e&&(e=f),r<a&&(r=a),o<c&&(o=c),s<f&&(s=f)}return this.min.set(i,n,e),this.max.set(r,o,s),this},setFromBufferAttribute:function(t){for(var i=1/0,n=1/0,e=1/0,r=-1/0,o=-1/0,s=-1/0,u=0,h=t.count;u<h;u++){var a=t.getX(u),c=t.getY(u),f=t.getZ(u);a<i&&(i=a),c<n&&(n=c),f<e&&(e=f),r<a&&(r=a),o<c&&(o=c),s<f&&(s=f)}return this.min.set(i,n,e),this.max.set(r,o,s),this},setFromPoints:function(t){this.makeEmpty();for(var i=0,n=t.length;i<n;i++)this.expandByPoint(t[i]);return this},setFromCenterAndSize:function(t,i){i=St.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new j),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new j),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);for(var i=t.geometry,n=(void 0!==i&&(null===i.boundingBox&&i.computeBoundingBox(),Ot.copy(i.boundingBox),Ot.applyMatrix4(t.matrixWorld),this.union(Ot)),t.children),e=0,r=n.length;e<r;e++)this.expandByObject(n[e]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,i){return void 0===i&&(console.warn("THREE.Box3: .getParameter() target is now required"),i=new j),i.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,St),St.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){var i,n=0<t.normal.x?(i=t.normal.x*this.min.x,t.normal.x*this.max.x):(i=t.normal.x*this.max.x,t.normal.x*this.min.x);return 0<t.normal.y?(i+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(i+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),0<t.normal.z?(i+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(i+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),i<=-t.constant&&n>=-t.constant},intersectsTriangle:function(t){return!this.isEmpty()&&(this.getCenter(Pt),Ct.subVectors(this.max,Pt),Et.subVectors(t.a,Pt),kt.subVectors(t.b,Pt),Tt.subVectors(t.c,Pt),Rt.subVectors(kt,Et),At.subVectors(Tt,kt),xt.subVectors(Et,Tt),!!Bt([0,-Rt.z,Rt.y,0,-At.z,At.y,0,-xt.z,xt.y,Rt.z,0,-Rt.x,At.z,0,-At.x,xt.z,0,-xt.x,-Rt.y,Rt.x,0,-At.y,At.x,0,-xt.y,xt.x,0],Et,kt,Tt,Ct))&&!!Bt([1,0,0,0,1,0,0,0,1],Et,kt,Tt,Ct)&&(Lt.crossVectors(Rt,At),Bt([Lt.x,Lt.y,Lt.z],Et,kt,Tt,Ct))},clampPoint:function(t,i){return void 0===i&&(console.warn("THREE.Box3: .clampPoint() target is now required"),i=new j),i.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return St.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(St).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()||(Mt[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Mt[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Mt[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Mt[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Mt[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Mt[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Mt[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Mt[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Mt)),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.defineProperties(Dt.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(Dt.prototype,{isVector4:!0,set:function(t,i,n,e){return this.x=t,this.y=i,this.z=n,this.w=e,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,i){return void 0!==i?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this.w=t.w+i.w,this},addScaledVector:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this.w+=t.w*i,this},sub:function(t,i){return void 0!==i?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this.w=t.w-i.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var i=this.x,n=this.y,e=this.z,r=this.w,t=t.elements;return this.x=t[0]*i+t[4]*n+t[8]*e+t[12]*r,this.y=t[1]*i+t[5]*n+t[9]*e+t[13]*r,this.z=t[2]*i+t[6]*n+t[10]*e+t[14]*r,this.w=t[3]*i+t[7]*n+t[11]*e+t[15]*r,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var i=Math.sqrt(1-t.w*t.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/i,this.y=t.y/i,this.z=t.z/i),this},setAxisAngleFromRotationMatrix:function(t){var i,n,e,r,o,s,u,h,a,c,t=t.elements,f=t[0],l=t[4],v=t[8],y=t[1],d=t[5],b=t[9],p=t[2],m=t[6],t=t[10];return Math.abs(l-y)<.01&&Math.abs(v-p)<.01&&Math.abs(b-m)<.01?Math.abs(l+y)<.1&&Math.abs(v+p)<.1&&Math.abs(b+m)<.1&&Math.abs(f+d+t-3)<.1?this.set(1,0,0,0):(r=Math.PI,s=(t+1)/2,u=(l+y)/4,h=(v+p)/4,a=(b+m)/4,(o=(d+1)/2)<(c=(f+1)/2)&&s<c?e=c<.01?(i=0,n=.707106781):(n=u/(i=Math.sqrt(c)),h/i):s<o?e=o<.01?(n=0,i=.707106781):(i=u/(n=Math.sqrt(o)),a/n):s<.01?(n=i=.707106781,e=0):(i=h/(e=Math.sqrt(s)),n=a/e),this.set(i,n,e,r)):(c=Math.sqrt((m-b)*(m-b)+(v-p)*(v-p)+(y-l)*(y-l)),Math.abs(c)<.001&&(c=1),this.x=(m-b)/c,this.y=(v-p)/c,this.z=(y-l)/c,this.w=Math.acos((f+d+t-1)/2)),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this.w=Math.max(t.w,Math.min(i.w,this.w)),this},clampScalar:function(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this.w=Math.max(t,Math.min(i,this.w)),this},clampLength:function(t,i){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(i,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this.w+=(t.w-this.w)*i,this},lerpVectors:function(t,i,n){return this.subVectors(i,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,i){return this.x=t[i=void 0===i?0:i],this.y=t[i+1],this.z=t[i+2],this.w=t[i+3],this},toArray:function(t,i){return(t=void 0===t?[]:t)[i=void 0===i?0:i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t[i+3]=this.w,t},fromBufferAttribute:function(t,i,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this.w=t.getW(i),this}}),Object.defineProperties(I.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(I.prototype,{isVector2:!0,set:function(t,i){return this.x=t,this.y=i,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,i){return void 0!==i?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this},addScaledVector:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this},sub:function(t,i){return void 0!==i?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var i=this.x,n=this.y,t=t.elements;return this.x=t[0]*i+t[3]*n+t[6],this.y=t[1]*i+t[4]*n+t[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this},clampScalar:function(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this},clampLength:function(t,i){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(i,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var i=this.x-t.x,t=this.y-t.y;return i*i+t*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this},lerpVectors:function(t,i,n){return this.subVectors(i,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,i){return this.x=t[i=void 0===i?0:i],this.y=t[i+1],this},toArray:function(t,i){return(t=void 0===t?[]:t)[i=void 0===i?0:i]=this.x,t[i+1]=this.y,t},fromBufferAttribute:function(t,i,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(i),this.y=t.getY(i),this},rotateAround:function(t,i){var n=Math.cos(i),i=Math.sin(i),e=this.x-t.x,r=this.y-t.y;return this.x=e*n-r*i+t.x,this.y=e*i+r*n+t.y,this}});var Ft=0,_t=1,Ht=2,Ut=1,Gt=100,Vt=204,qt=205,zt=3,Xt=0,Zt=1001,Wt=1006,Yt=2300,Kt=2301,Qt=3200,$t=0,Jt=7680,ti=519,e=new j;function M(t,i,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=i,this.count=void 0!==t?t.length/i:0,this.normalized=!0===n,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function ii(t,i,n){M.call(this,new Int8Array(t),i,n)}function ni(t,i,n){M.call(this,new Uint8Array(t),i,n)}function ei(t,i,n){M.call(this,new Uint8ClampedArray(t),i,n)}function ri(t,i,n){M.call(this,new Int16Array(t),i,n)}function oi(t,i,n){M.call(this,new Uint16Array(t),i,n)}function si(t,i,n){M.call(this,new Int32Array(t),i,n)}function ui(t,i,n){M.call(this,new Uint32Array(t),i,n)}function S(t,i,n){M.call(this,new Float32Array(t),i,n)}function hi(t,i,n){M.call(this,new Float64Array(t),i,n)}Object.defineProperty(M.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(M.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,i,n){t*=this.itemSize,n*=i.itemSize;for(var e=0,r=this.itemSize;e<r;e++)this.array[t+e]=i.array[n+e];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var i=this.array,n=0,e=0,r=t.length;e<r;e++){var o=t[e];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",e),o=new y),i[n++]=o.r,i[n++]=o.g,i[n++]=o.b}return this},copyVector2sArray:function(t){for(var i=this.array,n=0,e=0,r=t.length;e<r;e++){var o=t[e];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",e),o=new I),i[n++]=o.x,i[n++]=o.y}return this},copyVector3sArray:function(t){for(var i=this.array,n=0,e=0,r=t.length;e<r;e++){var o=t[e];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",e),o=new j),i[n++]=o.x,i[n++]=o.y,i[n++]=o.z}return this},copyVector4sArray:function(t){for(var i=this.array,n=0,e=0,r=t.length;e<r;e++){var o=t[e];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",e),o=new Dt),i[n++]=o.x,i[n++]=o.y,i[n++]=o.z,i[n++]=o.w}return this},applyMatrix3:function(t){for(var i=0,n=this.count;i<n;i++)e.x=this.getX(i),e.y=this.getY(i),e.z=this.getZ(i),e.applyMatrix3(t),this.setXYZ(i,e.x,e.y,e.z);return this},applyMatrix4:function(t){for(var i=0,n=this.count;i<n;i++)e.x=this.getX(i),e.y=this.getY(i),e.z=this.getZ(i),e.applyMatrix4(t),this.setXYZ(i,e.x,e.y,e.z);return this},applyNormalMatrix:function(t){for(var i=0,n=this.count;i<n;i++)e.x=this.getX(i),e.y=this.getY(i),e.z=this.getZ(i),e.applyNormalMatrix(t),this.setXYZ(i,e.x,e.y,e.z);return this},transformDirection:function(t){for(var i=0,n=this.count;i<n;i++)e.x=this.getX(i),e.y=this.getY(i),e.z=this.getZ(i),e.transformDirection(t),this.setXYZ(i,e.x,e.y,e.z);return this},set:function(t,i){return this.array.set(t,i=void 0===i?0:i),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,i){return this.array[t*this.itemSize]=i,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,i){return this.array[t*this.itemSize+1]=i,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,i){return this.array[t*this.itemSize+2]=i,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,i){return this.array[t*this.itemSize+3]=i,this},setXY:function(t,i,n){return t*=this.itemSize,this.array[t+0]=i,this.array[t+1]=n,this},setXYZ:function(t,i,n,e){return t*=this.itemSize,this.array[t+0]=i,this.array[t+1]=n,this.array[t+2]=e,this},setXYZW:function(t,i,n,e,r){return t*=this.itemSize,this.array[t+0]=i,this.array[t+1]=n,this.array[t+2]=e,this.array[t+3]=r,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),(ii.prototype=Object.create(M.prototype)).constructor=ii,(ni.prototype=Object.create(M.prototype)).constructor=ni,(ei.prototype=Object.create(M.prototype)).constructor=ei,(ri.prototype=Object.create(M.prototype)).constructor=ri,oi.prototype=Object.create(M.prototype),oi.prototype.constructor=oi,(si.prototype=Object.create(M.prototype)).constructor=si,ui.prototype=Object.create(M.prototype),ui.prototype.constructor=ui,(S.prototype=Object.create(M.prototype)).constructor=S,(hi.prototype=Object.create(M.prototype)).constructor=hi;var ai=new Nt;function ci(t,i){this.center=void 0!==t?t:new j,this.radius=void 0!==i?i:0}function fi(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}Object.assign(ci.prototype,{set:function(t,i){return this.center.copy(t),this.radius=i,this},setFromPoints:function(t,i){for(var n=this.center,e=(void 0!==i?n.copy(i):ai.setFromPoints(t).getCenter(n),0),r=0,o=t.length;r<o;r++)e=Math.max(e,n.distanceToSquared(t[r]));return this.radius=Math.sqrt(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var i=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=i*i},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,i){var n=this.center.distanceToSquared(t);return void 0===i&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),i=new j),i.copy(t),n>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new Nt),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}}),Object.assign(fi.prototype,{computeGroups:function(t){for(var i,n=[],e=void 0,r=t.faces,o=0;o<r.length;o++){var s=r[o];s.materialIndex!==e&&(e=s.materialIndex,void 0!==i&&(i.count=3*o-i.start,n.push(i)),i={start:3*o,materialIndex:e})}void 0!==i&&(i.count=3*o-i.start,n.push(i)),this.groups=n},fromGeometry:function(t){var i=t.faces,n=t.vertices,e=t.faceVertexUvs,r=e[0]&&0<e[0].length,o=e[1]&&0<e[1].length,s=t.morphTargets,u=s.length;if(0<u){for(var h=[],a=0;a<u;a++)h[a]={name:s[a].name,data:[]};this.morphTargets.position=h}var c=t.morphNormals,f=c.length;if(0<f){for(var l=[],a=0;a<f;a++)l[a]={name:c[a].name,data:[]};this.morphTargets.normal=l}var v=t.skinIndices,y=t.skinWeights,d=v.length===n.length,b=y.length===n.length;0<n.length&&0===i.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(a=0;a<i.length;a++){var p,m=i[a],w=(this.vertices.push(n[m.a],n[m.b],n[m.c]),m.vertexNormals),w=(3===w.length?this.normals.push(w[0],w[1],w[2]):(w=m.normal,this.normals.push(w,w,w)),m.vertexColors);3===w.length?this.colors.push(w[0],w[1],w[2]):(w=m.color,this.colors.push(w,w,w)),!0===r&&(void 0!==(p=e[0][a])?this.uvs.push(p[0],p[1],p[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",a),this.uvs.push(new I,new I,new I))),!0===o&&(void 0!==(p=e[1][a])?this.uvs2.push(p[0],p[1],p[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",a),this.uvs2.push(new I,new I,new I)));for(var g=0;g<u;g++){var j=s[g].vertices;h[g].data.push(j[m.a],j[m.b],j[m.c])}for(g=0;g<f;g++){var M=c[g].vertexNormals[a];l[g].data.push(M.a,M.b,M.c)}d&&this.skinIndices.push(v[m.a],v[m.b],v[m.c]),b&&this.skinWeights.push(y[m.a],y[m.b],y[m.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});var li=1,vi=new p,yi=new u,di=new j,bi=new Nt,pi=new Nt,c=new j;function mi(){Object.defineProperty(this,"id",{value:li+=2}),this.uuid=g.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}function wi(t,i,n,e){mi.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:i,widthSegments:n,heightSegments:e};for(var r=(t=t||1)/2,o=(i=i||1)/2,s=Math.floor(n)||1,u=Math.floor(e)||1,h=s+1,a=u+1,c=t/s,f=i/u,l=[],v=[],y=[],d=[],b=0;b<a;b++)for(var p=b*f-o,m=0;m<h;m++)v.push(m*c-r,-p,0),y.push(0,0,1),d.push(m/s),d.push(1-b/u);for(b=0;b<u;b++)for(m=0;m<s;m++){var w=m+h*(b+1),g=m+1+h*(b+1),j=m+1+h*b;l.push(m+h*b,w,j),l.push(w,g,j)}this.setIndex(l),this.setAttribute("position",new S(v,3)),this.setAttribute("normal",new S(y,3)),this.setAttribute("uv",new S(d,2))}mi.prototype=Object.assign(Object.create(Y.prototype),{constructor:mi,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(65535<function(t){if(0===t.length)return-1/0;for(var i=t[0],n=1,e=t.length;n<e;++n)t[n]>i&&(i=t[n]);return i}(t)?ui:oi)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,i){return this.attributes[t]=i,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,i,n){this.groups.push({start:t,count:i,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,i){this.drawRange.start=t,this.drawRange.count=i},applyMatrix4:function(t){var i=this.attributes.position,i=(void 0!==i&&(i.applyMatrix4(t),i.needsUpdate=!0),this.attributes.normal),n=(void 0!==i&&(n=(new tt).getNormalMatrix(t),i.applyNormalMatrix(n),i.needsUpdate=!0),this.attributes.tangent);return void 0!==n&&(n.transformDirection(t),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return vi.makeRotationX(t),this.applyMatrix4(vi),this},rotateY:function(t){return vi.makeRotationY(t),this.applyMatrix4(vi),this},rotateZ:function(t){return vi.makeRotationZ(t),this.applyMatrix4(vi),this},translate:function(t,i,n){return vi.makeTranslation(t,i,n),this.applyMatrix4(vi),this},scale:function(t,i,n){return vi.makeScale(t,i,n),this.applyMatrix4(vi),this},lookAt:function(t){return yi.lookAt(t),yi.updateMatrix(),this.applyMatrix4(yi.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(di).negate(),this.translate(di.x,di.y,di.z),this},setFromObject:function(t){var i,n,e=t.geometry;return t.isPoints||t.isLine?(n=new S(3*e.vertices.length,3),i=new S(3*e.colors.length,3),this.setAttribute("position",n.copyVector3sArray(e.vertices)),this.setAttribute("color",i.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length&&(n=new S(e.lineDistances.length,1),this.setAttribute("lineDistance",n.copyArray(e.lineDistances))),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())):t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e),this},setFromPoints:function(t){for(var i=[],n=0,e=t.length;n<e;n++){var r=t[n];i.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new S(i,3)),this},updateFromObject:function(t){var i,n=t.geometry;if(t.isMesh){var e=n.R;if(!0===n.elementsNeedUpdate&&(e=void 0,n.elementsNeedUpdate=!1),void 0===e)return this.fromGeometry(n);e.verticesNeedUpdate=n.verticesNeedUpdate,e.normalsNeedUpdate=n.normalsNeedUpdate,e.colorsNeedUpdate=n.colorsNeedUpdate,e.uvsNeedUpdate=n.uvsNeedUpdate,e.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=e}return!0===n.verticesNeedUpdate&&(void 0!==(i=this.attributes.position)&&(i.copyVector3sArray(n.vertices),i.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(i=this.attributes.normal)&&(i.copyVector3sArray(n.normals),i.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(i=this.attributes.color)&&(i.copyColorsArray(n.colors),i.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(i=this.attributes.uv)&&(i.copyVector2sArray(n.uvs),i.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(i=this.attributes.lineDistance)&&(i.copyArray(n.lineDistances),i.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(t.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.R=(new fi).fromGeometry(t),this.fromDirectGeometry(t.R)},fromDirectGeometry:function(t){var i,n=new Float32Array(3*t.vertices.length);for(i in this.setAttribute("position",new M(n,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(n=new Float32Array(3*t.normals.length),this.setAttribute("normal",new M(n,3).copyVector3sArray(t.normals))),0<t.colors.length&&(n=new Float32Array(3*t.colors.length),this.setAttribute("color",new M(n,3).copyColorsArray(t.colors))),0<t.uvs.length&&(n=new Float32Array(2*t.uvs.length),this.setAttribute("uv",new M(n,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(n=new Float32Array(2*t.uvs2.length),this.setAttribute("uv2",new M(n,2).copyVector2sArray(t.uvs2))),this.groups=t.groups,t.morphTargets){for(var e=[],r=t.morphTargets[i],o=0,s=r.length;o<s;o++){var u=r[o],h=new S(3*u.data.length,3);h.name=u.name,e.push(h.copyVector3sArray(u.data))}this.morphAttributes[i]=e}return 0<t.skinIndices.length&&(n=new S(4*t.skinIndices.length,4),this.setAttribute("skinIndex",n.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(n=new S(4*t.skinWeights.length,4),this.setAttribute("skinWeight",n.copyVector4sArray(t.skinWeights))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Nt);var t=this.attributes.position,i=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),i)for(var n=0,e=i.length;n<e;n++){var r=i[n];bi.setFromBufferAttribute(r),this.morphTargetsRelative?(c.addVectors(this.boundingBox.min,bi.min),this.boundingBox.expandByPoint(c),c.addVectors(this.boundingBox.max,bi.max),this.boundingBox.expandByPoint(c)):(this.boundingBox.expandByPoint(bi.min),this.boundingBox.expandByPoint(bi.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new ci);var t=this.attributes.position,i=this.morphAttributes.position;if(t){var n=this.boundingSphere.center;if(bi.setFromBufferAttribute(t),i)for(var e=0,r=i.length;e<r;e++){var o=i[e];pi.setFromBufferAttribute(o),this.morphTargetsRelative?(c.addVectors(bi.min,pi.min),bi.expandByPoint(c),c.addVectors(bi.max,pi.max),bi.expandByPoint(c)):(bi.expandByPoint(pi.min),bi.expandByPoint(pi.max))}bi.getCenter(n);for(var s=0,e=0,r=t.count;e<r;e++)c.fromBufferAttribute(t,e),s=Math.max(s,n.distanceToSquared(c));if(i)for(e=0,r=i.length;e<r;e++)for(var o=i[e],u=this.morphTargetsRelative,h=0,a=o.count;h<a;h++)c.fromBufferAttribute(o,h),u&&(di.fromBufferAttribute(t,h),c.add(di)),s=Math.max(s,n.distanceToSquared(c));this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,i=this.attributes;if(i.position){var n=i.position.array;if(void 0===i.normal)this.setAttribute("normal",new M(new Float32Array(n.length),3));else for(var e=i.normal.array,r=0,o=e.length;r<o;r++)e[r]=0;var s,u,h,a=i.normal.array,c=new j,f=new j,l=new j,v=new j,y=new j;if(t)for(var d=t.array,r=0,o=t.count;r<o;r+=3)s=3*d[r+0],u=3*d[r+1],h=3*d[r+2],c.fromArray(n,s),f.fromArray(n,u),l.fromArray(n,h),v.subVectors(l,f),y.subVectors(c,f),v.cross(y),a[s]+=v.x,a[1+s]+=v.y,a[2+s]+=v.z,a[u]+=v.x,a[1+u]+=v.y,a[2+u]+=v.z,a[h]+=v.x,a[1+h]+=v.y,a[2+h]+=v.z;else for(r=0,o=n.length;r<o;r+=9)c.fromArray(n,r),f.fromArray(n,r+3),l.fromArray(n,r+6),v.subVectors(l,f),y.subVectors(c,f),v.cross(y),a[r]=v.x,a[r+1]=v.y,a[r+2]=v.z,a[r+3]=v.x,a[r+4]=v.y,a[r+5]=v.z,a[r+6]=v.x,a[r+7]=v.y,a[r+8]=v.z;this.normalizeNormals(),i.normal.needsUpdate=!0}},normalizeNormals:function(){for(var t=this.attributes.normal,i=0,n=t.count;i<n;i++)c.x=t.getX(i),c.y=t.getY(i),c.z=t.getZ(i),c.normalize(),t.setXYZ(i,c.x,c.y,c.z)},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(wi.prototype=Object.create(mi.prototype)).constructor=wi;var gi=0;function f(){Object.defineProperty(this,"id",{value:gi++}),this.uuid=g.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=Ut,this.side=Ft,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Vt,this.blendDst=qt,this.blendEquation=Gt,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=zt,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=ti,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Jt,this.stencilZFail=Jt,this.stencilZPass=Jt,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function ji(t){f.call(this),this.type="MeshBasicMaterial",this.color=new y(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Xt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}f.prototype=Object.assign(Object.create(Y.prototype),{constructor:f,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var i in t){var n,e=t[i];void 0===e?console.warn("THREE.Material: '"+i+"' parameter is undefined."):"shading"===i?(console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e):void 0===(n=this[i])?console.warn("THREE."+this.type+": '"+i+"' is not a property of this material."):n&&n.isColor?n.set(e):n&&n.isVector3&&e&&e.isVector3?n.copy(e):this[i]=e}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var i=t.clippingPlanes,n=null;if(null!==i)for(var e=i.length,n=new Array(e),r=0;r!==e;++r)n[r]=i[r].clone();return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(f.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),((ji.prototype=Object.create(f.prototype)).constructor=ji).prototype.isMeshBasicMaterial=!0,ji.prototype.copy=function(t){return f.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};var Mi=0;function Si(t,i,n,e,r,o,s,u,h,a){Object.defineProperty(this,"id",{value:Mi++}),this.uuid=g.generateUUID(),this.name="",this.image=void 0!==t?t:Si.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==i?i:Si.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:Zt,this.wrapT=void 0!==e?e:Zt,this.magFilter=void 0!==r?r:Wt,this.minFilter=void 0!==o?o:1008,this.anisotropy=void 0!==h?h:1,this.format=void 0!==s?s:1023,this.internalFormat=null,this.type=void 0!==u?u:1009,this.offset=new I(0,0),this.repeat=new I(1,1),this.center=new I(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new tt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==a?a:3e3,this.version=0,this.onUpdate=null}function Oi(t,i,n,e,r,o,s,u,h){Si.call(this,t,i,n,e,r,o,s,u,h),this.needsUpdate=!0}Si.DEFAULT_IMAGE=void 0,Si.DEFAULT_MAPPING=300,Si.prototype=Object.assign(Object.create(Y.prototype),{constructor:Si,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300===this.mapping){if(t.applyMatrix3(this.matrix),t.x<0||1<t.x)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case Zt:t.x=t.x<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||1<t.y)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case Zt:t.y=t.y<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}return t}}),Object.defineProperty(Si.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),((Oi.prototype=Object.create(Si.prototype)).constructor=Oi).prototype.isCanvasTexture=!0;var Ei=new j,ki=new j,Ti=new tt;function Ri(t,i){this.normal=void 0!==t?t:new j(1,0,0),this.constant=void 0!==i?i:0}Object.assign(Ri.prototype,{isPlane:!0,set:function(t,i){return this.normal.copy(t),this.constant=i,this},setComponents:function(t,i,n,e){return this.normal.set(t,i,n),this.constant=e,this},setFromNormalAndCoplanarPoint:function(t,i){return this.normal.copy(t),this.constant=-i.dot(this.normal),this},setFromCoplanarPoints:function(t,i,n){n=Ei.subVectors(n,i).cross(ki.subVectors(t,i)).normalize();return this.setFromNormalAndCoplanarPoint(n,t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,i){return void 0===i&&(console.warn("THREE.Plane: .projectPoint() target is now required"),i=new j),i.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,i){void 0===i&&(console.warn("THREE.Plane: .intersectLine() target is now required"),i=new j);var n=t.delta(Ei),e=this.normal.dot(n);return 0===e?0===this.distanceToPoint(t.start)?i.copy(t.start):void 0:(e=-(t.start.dot(this.normal)+this.constant)/e)<0||1<e?void 0:i.copy(n).multiplyScalar(e).add(t.start)},intersectsLine:function(t){var i=this.distanceToPoint(t.start),t=this.distanceToPoint(t.end);return i<0&&0<t||t<0&&0<i},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new j),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,i){i=i||Ti.getNormalMatrix(t),t=this.coplanarPoint(Ei).applyMatrix4(t),i=this.normal.applyMatrix3(i).normalize();return this.constant=-t.dot(i),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});var Ai=new j,xi=new j,Pi=new j,Ci=new j,Li=new j,Ii=new j,Ni=new j;function Bi(t,i){this.origin=void 0!==t?t:new j,this.direction=void 0!==i?i:new j(0,0,-1)}Object.assign(Bi.prototype,{set:function(t,i){return this.origin.copy(t),this.direction.copy(i),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,i){return void 0===i&&(console.warn("THREE.Ray: .at() target is now required"),i=new j),i.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,Ai)),this},closestPointToPoint:function(t,i){void 0===i&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),i=new j),i.subVectors(t,this.origin);t=i.dot(this.direction);return t<0?i.copy(this.origin):i.copy(this.direction).multiplyScalar(t).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){var i=Ai.subVectors(t,this.origin).dot(this.direction);return(i<0?this.origin:(Ai.copy(this.direction).multiplyScalar(i).add(this.origin),Ai)).distanceToSquared(t)},distanceSqToSegment:function(t,i,n,e){xi.copy(t).add(i).multiplyScalar(.5),Pi.copy(i).sub(t).normalize(),Ci.copy(this.origin).sub(xi);var r,o,s,t=.5*t.distanceTo(i),i=-this.direction.dot(Pi),u=Ci.dot(this.direction),h=-Ci.dot(Pi),a=Ci.lengthSq(),c=Math.abs(1-i*i);return c=0<c?(o=i*u-h,s=t*c,0<=(r=i*h-u)?-s<=o?o<=s?(r*=c=1/c)*(r+i*(o*=c)+2*u)+o*(i*r+o+2*h)+a:(o=t,-(r=Math.max(0,-(i*o+u)))*r+o*(o+2*h)+a):(o=-t,-(r=Math.max(0,-(i*o+u)))*r+o*(o+2*h)+a):o<=-s?-(r=Math.max(0,-(-i*t+u)))*r+(o=0<r?-t:Math.min(Math.max(-t,-h),t))*(o+2*h)+a:o<=s?(r=0,(o=Math.min(Math.max(-t,-h),t))*(o+2*h)+a):-(r=Math.max(0,-(i*t+u)))*r+(o=0<r?t:Math.min(Math.max(-t,-h),t))*(o+2*h)+a):(o=0<i?-t:t,-(r=Math.max(0,-(i*o+u)))*r+o*(o+2*h)+a),n&&n.copy(this.direction).multiplyScalar(r).add(this.origin),e&&e.copy(Pi).multiplyScalar(o).add(xi),c},intersectSphere:function(t,i){Ai.subVectors(t.center,this.origin);var n=Ai.dot(this.direction),e=Ai.dot(Ai)-n*n,t=t.radius*t.radius;return t<e||(e=n+(t=Math.sqrt(t-e)),(n=n-t)<0&&e<0)?null:n<0?this.at(e,i):this.at(n,i)},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var i=t.normal.dot(this.direction);return 0===i?0===t.distanceToPoint(this.origin)?0:null:0<=(t=-(this.origin.dot(t.normal)+t.constant)/i)?t:null},intersectPlane:function(t,i){t=this.distanceToPlane(t);return null===t?null:this.at(t,i)},intersectsPlane:function(t){var i=t.distanceToPoint(this.origin);return 0===i||t.normal.dot(this.direction)*i<0},intersectBox:function(t,i){var n,e,r,o=1/this.direction.x,s=1/this.direction.y,u=1/this.direction.z,h=this.origin,o=0<=o?(n=(t.min.x-h.x)*o,(t.max.x-h.x)*o):(n=(t.max.x-h.x)*o,(t.min.x-h.x)*o),s=0<=s?(r=(t.min.y-h.y)*s,(t.max.y-h.y)*s):(r=(t.max.y-h.y)*s,(t.min.y-h.y)*s);return s<n||o<r||((n<r||n!=n)&&(n=r),(s<o||o!=o)&&(o=s),(r=0<=u?(e=(t.min.z-h.z)*u,(t.max.z-h.z)*u):(e=(t.max.z-h.z)*u,(t.min.z-h.z)*u))<n)||o<e||((n<e||n!=n)&&(n=e),(o=r<o||o!=o?r:o)<0)?null:this.at(0<=n?n:o,i)},intersectsBox:function(t){return null!==this.intersectBox(t,Ai)},intersectTriangle:function(t,i,n,e,r){Li.subVectors(i,t),Ii.subVectors(n,t),Ni.crossVectors(Li,Ii);var o,i=this.direction.dot(Ni);if(0<i){if(e)return null;o=1}else{if(!(i<0))return null;o=-1,i=-i}Ci.subVectors(this.origin,t);n=o*this.direction.dot(Ii.crossVectors(Ci,Ii));return n<0||(e=o*this.direction.dot(Li.cross(Ci)))<0||i<n+e||(t=-o*Ci.dot(Ni))<0?null:this.at(t/i,r)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});var Di=new j,Fi=new j,_i=new j,Hi=new j,Ui=new j,Gi=new j,Vi=new j,qi=new j,zi=new j,Xi=new j;function Zi(t,i,n){this.a=void 0!==t?t:new j,this.b=void 0!==i?i:new j,this.c=void 0!==n?n:new j}function Wi(t,i,n,e,r,o){this.a=t,this.b=i,this.c=n,this.normal=e&&e.isVector3?e:new j,this.vertexNormals=Array.isArray(e)?e:[],this.color=r&&r.isColor?r:new y,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==o?o:0}Object.assign(Zi,{getNormal:function(t,i,n,e){void 0===e&&(console.warn("THREE.Triangle: .getNormal() target is now required"),e=new j),e.subVectors(n,i),Di.subVectors(t,i),e.cross(Di);n=e.lengthSq();return 0<n?e.multiplyScalar(1/Math.sqrt(n)):e.set(0,0,0)},getBarycoord:function(t,i,n,e,r){Di.subVectors(e,i),Fi.subVectors(n,i),_i.subVectors(t,i);var e=Di.dot(Di),n=Di.dot(Fi),t=Di.dot(_i),i=Fi.dot(Fi),o=Fi.dot(_i),s=e*i-n*n;return void 0===r&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),r=new j),0==s?r.set(-2,-1,-1):r.set(1-(i=(i*t-n*o)*(r=1/s))-(s=(e*o-n*t)*r),s,i)},containsPoint:function(t,i,n,e){return Zi.getBarycoord(t,i,n,e,Hi),0<=Hi.x&&0<=Hi.y&&Hi.x+Hi.y<=1},getUV:function(t,i,n,e,r,o,s,u){return this.getBarycoord(t,i,n,e,Hi),u.set(0,0),u.addScaledVector(r,Hi.x),u.addScaledVector(o,Hi.y),u.addScaledVector(s,Hi.z),u},isFrontFacing:function(t,i,n,e){return Di.subVectors(n,i),Fi.subVectors(t,i),Di.cross(Fi).dot(e)<0}}),Object.assign(Zi.prototype,{set:function(t,i,n){return this.a.copy(t),this.b.copy(i),this.c.copy(n),this},setFromPointsAndIndices:function(t,i,n,e){return this.a.copy(t[i]),this.b.copy(t[n]),this.c.copy(t[e]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return Di.subVectors(this.c,this.b),Fi.subVectors(this.a,this.b),.5*Di.cross(Fi).length()},getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new j),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return Zi.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new Ri),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,i){return Zi.getBarycoord(t,this.a,this.b,this.c,i)},getUV:function(t,i,n,e,r){return Zi.getUV(t,this.a,this.b,this.c,i,n,e,r)},containsPoint:function(t){return Zi.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return Zi.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,i){void 0===i&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),i=new j);var n=this.a,e=this.b,r=this.c,o=(Ui.subVectors(e,n),Gi.subVectors(r,n),qi.subVectors(t,n),Ui.dot(qi)),s=Gi.dot(qi);if(o<=0&&s<=0)return i.copy(n);zi.subVectors(t,e);var u=Ui.dot(zi),h=Gi.dot(zi);if(0<=u&&h<=u)return i.copy(e);var a=o*h-u*s;if(a<=0&&0<=o&&u<=0)return c=o/(o-u),i.copy(n).addScaledVector(Ui,c);Xi.subVectors(t,r);var c,f,t=Ui.dot(Xi),l=Gi.dot(Xi);return 0<=l&&t<=l?i.copy(r):(o=t*s-o*l)<=0&&0<=s&&l<=0?(f=s/(s-l),i.copy(n).addScaledVector(Gi,f)):(s=u*l-t*h)<=0&&0<=h-u&&0<=t-l?(Vi.subVectors(r,e),f=(h-u)/(h-u+(t-l)),i.copy(e).addScaledVector(Vi,f)):(c=o*(r=1/(s+o+a)),f=a*r,i.copy(n).addScaledVector(Ui,c).addScaledVector(Gi,f))},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}),Object.assign(Wi.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var i=0,n=t.vertexNormals.length;i<n;i++)this.vertexNormals[i]=t.vertexNormals[i].clone();for(i=0,n=t.vertexColors.length;i<n;i++)this.vertexColors[i]=t.vertexColors[i].clone();return this}});var Yi=new p,Ki=new Bi,Qi=new ci,$i=new j,Ji=new j,tn=new j,nn=new j,en=new j,rn=new j,on=new j,sn=new j,un=new j,hn=new I,an=new I,cn=new I,fn=new j,ln=new j;function vn(t,i){u.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new mi,this.material=void 0!==i?i:new ji,this.updateMorphTargets()}function yn(t,i,n,e,r,o,s,u){e=i.side===_t?e.intersectTriangle(s,o,r,!0,u):e.intersectTriangle(r,o,s,i.side!==Ht,u);if(null===e)return null;ln.copy(u),ln.applyMatrix4(t.matrixWorld);r=n.ray.origin.distanceTo(ln);return r<n.near||r>n.far?null:{distance:r,point:ln.clone(),object:t}}function dn(t,i,n,e,r,o,s,u,h,a,c,f){$i.fromBufferAttribute(r,a),Ji.fromBufferAttribute(r,c),tn.fromBufferAttribute(r,f);var l=t.morphTargetInfluences;if(i.morphTargets&&o&&l){on.set(0,0,0),sn.set(0,0,0),un.set(0,0,0);for(var v=0,y=o.length;v<y;v++){var d=l[v],b=o[v];0!==d&&(nn.fromBufferAttribute(b,a),en.fromBufferAttribute(b,c),rn.fromBufferAttribute(b,f),s?(on.addScaledVector(nn,d),sn.addScaledVector(en,d),un.addScaledVector(rn,d)):(on.addScaledVector(nn.sub($i),d),sn.addScaledVector(en.sub(Ji),d),un.addScaledVector(rn.sub(tn),d)))}$i.add(on),Ji.add(sn),tn.add(un)}r=yn(t,i,n,e,$i,Ji,tn,fn);return r&&(u&&(hn.fromBufferAttribute(u,a),an.fromBufferAttribute(u,c),cn.fromBufferAttribute(u,f),r.uv=Zi.getUV(fn,$i,Ji,tn,hn,an,cn,new I)),h&&(hn.fromBufferAttribute(h,a),an.fromBufferAttribute(h,c),cn.fromBufferAttribute(h,f),r.uv2=Zi.getUV(fn,$i,Ji,tn,hn,an,cn,new I)),t=new Wi(a,c,f),Zi.getNormal($i,Ji,tn,t.normal),r.face=t),r}function bn(t,i,n,e){this.ray=new Bi(t,i),this.near=n||0,this.far=e||1/0,this.camera=null,this.layers=new J,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function pn(t,i){return t.distance-i.distance}function mn(t,i,n,e){if(t.layers.test(i.layers)&&t.raycast(i,n),!0===e)for(var r=t.children,o=0,s=r.length;o<s;o++)mn(r[o],i,n,!0)}vn.prototype=Object.assign(Object.create(u.prototype),{constructor:vn,isMesh:!0,copy:function(t){return u.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,i,n,e=this.geometry;if(e.isBufferGeometry){var r=e.morphAttributes,o=Object.keys(r);if(0<o.length){var s=r[o[0]];if(void 0!==s)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,i=s.length;t<i;t++)n=s[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{r=e.morphTargets;void 0!==r&&0<r.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,i){var n=this.geometry,e=this.material,r=this.matrixWorld;if(void 0!==e&&(null===n.boundingSphere&&n.computeBoundingSphere(),Qi.copy(n.boundingSphere),Qi.applyMatrix4(r),!1!==t.ray.intersectsSphere(Qi)&&(Yi.getInverse(r),Ki.copy(t.ray).applyMatrix4(Yi),null===n.boundingBox||!1!==Ki.intersectsBox(n.boundingBox))))if(n.isBufferGeometry){var o,s,u,h,a,c,f,l,v,y=n.index,d=n.attributes.position,b=n.morphAttributes.position,p=n.morphTargetsRelative,m=n.attributes.uv,w=n.attributes.uv2,g=n.groups,j=n.drawRange;if(null!==y)if(Array.isArray(e))for(h=0,c=g.length;h<c;h++)for(v=e[(l=g[h]).materialIndex],a=Math.max(l.start,j.start),f=Math.min(l.start+l.count,j.start+j.count);a<f;a+=3)o=y.getX(a),s=y.getX(a+1),u=y.getX(a+2),(P=dn(this,v,t,Ki,d,b,p,m,w,o,s,u))&&(P.faceIndex=Math.floor(a/3),P.face.materialIndex=l.materialIndex,i.push(P));else for(h=Math.max(0,j.start),c=Math.min(y.count,j.start+j.count);h<c;h+=3)o=y.getX(h),s=y.getX(h+1),u=y.getX(h+2),(P=dn(this,e,t,Ki,d,b,p,m,w,o,s,u))&&(P.faceIndex=Math.floor(h/3),i.push(P));else if(void 0!==d)if(Array.isArray(e))for(h=0,c=g.length;h<c;h++)for(v=e[(l=g[h]).materialIndex],a=Math.max(l.start,j.start),f=Math.min(l.start+l.count,j.start+j.count);a<f;a+=3)(P=dn(this,v,t,Ki,d,b,p,m,w,o=a,s=a+1,u=a+2))&&(P.faceIndex=Math.floor(a/3),P.face.materialIndex=l.materialIndex,i.push(P));else for(h=Math.max(0,j.start),c=Math.min(d.count,j.start+j.count);h<c;h+=3)(P=dn(this,e,t,Ki,d,b,p,m,w,o=h,s=h+1,u=h+2))&&(P.faceIndex=Math.floor(h/3),i.push(P))}else if(n.isGeometry){var M,S=Array.isArray(e),O=n.vertices,E=n.faces,r=n.faceVertexUvs[0];0<r.length&&(M=r);for(var k=0,T=E.length;k<T;k++){var R,A,x,P,C=E[k],L=S?e[C.materialIndex]:e;void 0!==L&&(R=O[C.a],A=O[C.b],x=O[C.c],P=yn(this,L,t,Ki,R,A,x,fn))&&(M&&M[k]&&(L=M[k],hn.copy(L[0]),an.copy(L[1]),cn.copy(L[2]),P.uv=Zi.getUV(fn,R,A,x,hn,an,cn,new I)),P.face=C,P.faceIndex=k,i.push(P))}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Object.assign(bn.prototype,{set:function(t,i){this.ray.set(t,i)},setFromCamera:function(t,i){i&&i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i&&i.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,i,n){n=n||[];return mn(t,this,n,i),n.sort(pn),n},intersectObjects:function(t,i,n){var e=n||[];if(!1===Array.isArray(t))console.warn("THREE.Raycaster.intersectObjects: objects is not an Array.");else{for(var r=0,o=t.length;r<o;r++)mn(t[r],this,e,i);e.sort(pn)}return e}});var a={AMAP_SATELLITE:1,AMAP_VECTOR:2,BAIDU_VECTOR:4,BAIDU_SATELLITE:8,TD_VECTOR:16,TD_SATELLITE:32,OSM:64},i={FOV:35,CAMERA_NEAR:1,CAMERA_FAR:1e5,ZOOM_UPPER_BOUND:30,TILT_UPPER_BOUND:90,THOUSAND:1e3,DEG2RAD:.0174532,RAD2DEG:57.2957795,DRAW_TIME:500,EPS:.001},wn=(Object.freeze(i),i);function gn(){u.call(this),this.type="Group"}function jn(t){return(jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mn(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==jn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==jn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===jn(t)?t:String(t)}(e.key),e)}}gn.prototype=Object.assign(Object.create(u.prototype),{constructor:gn,isGroup:!0});var Sn=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.disposed=!1}var i,n,e;return i=t,(n=[{key:"dispose",value:function(){this.disposed||(this.disposed=!0,this.disposeInternal())}},{key:"disposeInternal",value:function(){}}])&&Mn(i.prototype,n),e&&Mn(i,e),Object.defineProperty(i,"prototype",{writable:!1}),t}();function On(t,i){return i<t?1:t<i?-1:0}function En(t,i,n){var e,r=t.length;if(t[0]<=i)return 0;if(!(i<=t[r-1]))if(0<n){for(e=1;e<r;++e)if(t[e]<i)return e-1}else if(n<0){for(e=1;e<r;++e)if(t[e]<=i)return e}else for(e=1;e<r;++e){if(t[e]==i)return e;if(t[e]<i)return"function"==typeof n?0<n(i,t[e-1],t[e])?e-1:e:t[e-1]-i<i-t[e]?e-1:e}return r-1}function kn(t,i){for(var n=Array.isArray(i)?i:[i],e=n.length,r=0;r<e;r++)t[t.length]=n[r]}function Tn(t,i){var n=t.length;if(n===i.length){for(var e=0;e<n;e++)if(t[e]!==i[e])return;return 1}}function Rn(){return!0}function An(){}function l(){throw new Error("Unimplemented abstract method.")}var xn=0;function Pn(t){return t.ol_uid||(t.ol_uid=String(++xn))}var i="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",Cn=(i.indexOf("firefox"),-1!==i.indexOf("safari")&&i.indexOf("chrom"),-1!==i.indexOf("webkit")&&i.indexOf("edge"),i.indexOf("macintosh"),"undefined"!=typeof devicePixelRatio?devicePixelRatio:1),Ln="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,In="undefined"!=typeof Image&&Image.prototype.decode;!function(){var t=!1;try{var i=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,i),window.removeEventListener("_",null,i)}catch(t){}}();function Nn(t){return(Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bn(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Nn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Nn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Nn(t)?t:String(t)}(e.key),e)}}function Dn(n){var e=Hn();return function(){var t,i=Gn(n),i=(t=e?(t=Gn(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===Nn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Fn(t){var n="function"==typeof Map?new Map:void 0;return function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,i)}function i(){return _n(t,arguments,Gn(this).constructor)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Un(i,t)}(t)}function _n(t,i,n){return(_n=Hn()?Reflect.construct.bind():function(t,i,n){var e=[null];e.push.apply(e,i);i=new(Function.bind.apply(t,e));return n&&Un(i,n.prototype),i}).apply(null,arguments)}function Hn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function Un(t,i){return(Un=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function Gn(t){return(Gn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Vn=function(t){var i=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),t&&Un(i,t);var n,e,r=Dn(o);function o(t){var i,n;if(this instanceof o)return(n=r.call(this,i="Assertion failed. See https://openlayers.org/en/latest/doc/errors/#"+t+" for details.")).code=t,n.name="AssertionError",n.message=i,n;throw new TypeError("Cannot call a class as a function")}return i=o,n&&Bn(i.prototype,n),e&&Bn(i,e),Object.defineProperty(i,"prototype",{writable:!1}),i}(Fn(Error));function v(t,i){if(!t)throw new Vn(i)}new Array(6);function qn(){return[1,0,0,1,0,0]}function zn(t,i){var n=i[0],e=i[1];return i[0]=t[0]*n+t[2]*e+t[4],i[1]=t[1]*n+t[3]*e+t[5],i}function Xn(t,i,n,e,r,o,s,u){var h=Math.sin(o),o=Math.cos(o);return t[0]=e*o,t[1]=r*h,t[2]=-e*h,t[3]=r*o,t[4]=s*e*o-u*e*h+i,t[5]=s*r*h+u*r*o+n,t}function Zn(t,i){var n=i[0]*i[3]-i[1]*i[2],e=(v(0!=n,32),i[0]),r=i[1],o=i[2],s=i[3],u=i[4],i=i[5];return t[0]=s/n,t[1]=-r/n,t[2]=-o/n,t[3]=e/n,t[4]=(o*i-s*u)/n,t[5]=-(e*i-r*u)/n,t}var Wn={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},d={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Yn(t,i,n){i=i<t[0]?t[0]-i:t[2]<i?i-t[2]:0,n=n<t[1]?t[1]-n:t[3]<n?n-t[3]:0;return i*i+n*n}function Kn(t,i){return Qn(t,i[0],i[1])}function Qn(t,i,n){return t[0]<=i&&i<=t[2]&&t[1]<=n&&n<=t[3]}function $n(t,i){var n=t[0],e=t[1],r=t[2],t=t[3],o=i[0],i=i[1],s=d.UNKNOWN;return o<n?s|=d.LEFT:r<o&&(s|=d.RIGHT),i<e?s|=d.BELOW:t<i&&(s|=d.ABOVE),s=s===d.UNKNOWN?d.INTERSECTING:s}function Jn(){return[1/0,1/0,-1/0,-1/0]}function te(t,i,n,e,r){return r?(r[0]=t,r[1]=i,r[2]=n,r[3]=e,r):[t,i,n,e]}function ie(t){return te(1/0,1/0,-1/0,-1/0,t)}function ne(t,i){return t[0]==i[0]&&t[2]==i[2]&&t[1]==i[1]&&t[3]==i[3]}function ee(t,i,n,e,r){for(;n<e;n+=r)o=t,s=i[n],u=i[n+1],o[0]=Math.min(o[0],s),o[1]=Math.min(o[1],u),o[2]=Math.max(o[2],s),o[3]=Math.max(o[3],u);var o,s,u;return t}function re(t){return[t[0],t[1]]}function oe(t){return[t[2],t[1]]}function se(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function ue(t,i,n,e,r){var o=i*e[0]/2,i=i*e[1]/2,e=Math.cos(n),n=Math.sin(n),s=o*e,o=o*n,e=i*e,i=i*n,n=t[0],t=t[1],u=n-s+i,h=n-s-i,a=n+s-i,n=n+s+i,s=t-o-e,i=t-o+e,c=t+o+e,t=t+o-e;return te(Math.min(u,h,a,n),Math.min(s,i,c,t),Math.max(u,h,a,n),Math.max(s,i,c,t),r)}function he(t){return t[3]-t[1]}function ae(t,i,n){n=n||Jn();return ve(t,i)?(t[0]>i[0]?n[0]=t[0]:n[0]=i[0],t[1]>i[1]?n[1]=t[1]:n[1]=i[1],t[2]<i[2]?n[2]=t[2]:n[2]=i[2],t[3]<i[3]?n[3]=t[3]:n[3]=i[3]):ie(n),n}function ce(t){return[t[0],t[3]]}function fe(t){return[t[2],t[3]]}function le(t){return t[2]-t[0]}function ve(t,i){return t[0]<=i[2]&&t[2]>=i[0]&&t[1]<=i[3]&&t[3]>=i[1]}function ye(t){return t[2]<t[0]||t[3]<t[1]}function de(t,i,n,e){var r=[];if(1<e)for(var o=t[2]-t[0],s=t[3]-t[1],u=0;u<e;++u)r.push(t[0]+o*u/e,t[1],t[2],t[1]+s*u/e,t[2]-o*u/e,t[3],t[0],t[3]-s*u/e);else r=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];i(r,r,2);for(var h,a=[],c=[],f=0,l=r.length;f<l;f+=2)a.push(r[f]),c.push(r[f+1]);return i=a,h=c,n=n,te(Math.min.apply(null,i),Math.min.apply(null,h),Math.max.apply(null,i),Math.max.apply(null,h),n)}function be(t,i,n){return Math.min(Math.max(t,i),n)}var pe="cosh"in Math?Math.cosh:function(t){t=Math.exp(t);return(t+1/t)/2};"log2"in Math&&Math.log2;function me(t,i,n,e){n-=t,t=e-i;return n*n+t*t}function we(t){return t*Math.PI/180}function ge(t,i){t%=i;return t*i<0?t+i:t}function je(t,i){i=Math.pow(10,i);return Math.round(t*i)/i}function Me(t,i){return Math.floor(je(t,i))}function Se(t,i){return Math.ceil(je(t,i))}var Oe=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,Ee=/^([a-z]*)$|^hsla?\(.*\)$/i;function ke(t){var i,n,e;return"string"==typeof t?t:((i=(t=t)[0])!=(0|i)&&(i=i+.5|0),(n=t[1])!=(0|n)&&(n=n+.5|0),(e=t[2])!=(0|e)&&(e=e+.5|0),t=void 0===t[3]?1:Math.round(100*t[3])/100,"rgba("+i+","+n+","+e+","+t+")")}function Te(t){var i=document.createElement("div");return i.style.color=t,""!==i.style.color?(document.body.appendChild(i),t=getComputedStyle(i).color,document.body.removeChild(i),t):""}Re={},Ae=0;var Re,Ae,xe=function(t){var i;if(Re.hasOwnProperty(t))i=Re[t];else{if(1024<=Ae){var n,e=0;for(n in Re)0==(3&e++)&&(delete Re[n],--Ae)}i=function(t){var i,n,e,r,o;Ee.exec(t)&&(t=Te(t));{var s;Oe.exec(t)?(s=t.length-1,o=s<=4?1:2,s=4==s||8==s,i=parseInt(t.substr(1+0*o,o),16),n=parseInt(t.substr(+o+1,o),16),e=parseInt(t.substr(1+2*o,o),16),r=s?parseInt(t.substr(1+3*o,o),16):255,1==o&&(i=(i<<4)+i,n=(n<<4)+n,e=(e<<4)+e,s)&&(r=(r<<4)+r),o=[i,n,e,r/255]):0==t.indexOf("rgba(")?Ce(o=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((o=t.slice(4,-1).split(",").map(Number)).push(1),Ce(o)):v(!1,14)}return o}(t),Re[t]=i,++Ae}return i};function Pe(t){return Array.isArray(t)?t:xe(t)}function Ce(t){t[0]=be(t[0]+.5|0,0,255),t[1]=be(t[1]+.5|0,0,255),t[2]=be(t[2]+.5|0,0,255),t[3]=be(t[3],0,1)}function Le(t){return(Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ie(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Le(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Le(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Le(t)?t:String(t)}(e.key),e)}}i=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}var i,n,e;return i=t,(n=[{key:"clear",value:function(){this.cache_={},this.cacheSize_=0}},{key:"canExpireCache",value:function(){return this.cacheSize_>this.maxCacheSize_}},{key:"expire",value:function(){if(this.canExpireCache()){var t,i=0;for(t in this.cache_){var n=this.cache_[t];0!=(3&i++)||n.hasListener()||(delete this.cache_[t],--this.cacheSize_)}}}},{key:"get",value:function(t,i,n){t=Ne(t,i,n);return t in this.cache_?this.cache_[t]:null}},{key:"set",value:function(t,i,n,e){t=Ne(t,i,n);this.cache_[t]=e,++this.cacheSize_}},{key:"setSize",value:function(t){this.maxCacheSize_=t,this.expire()}}])&&Ie(i.prototype,n),e&&Ie(i,e),Object.defineProperty(i,"prototype",{writable:!1}),t}();function Ne(t,i,n){return i+":"+t+":"+(n?ke(n):"null")}var Be=new i;function De(t){return(De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fe(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==De(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==De(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===De(t)?t:String(t)}(e.key),e)}}var _e=function(){function i(t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}var t,n,e;return t=i,(n=[{key:"preventDefault",value:function(){this.defaultPrevented=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}])&&Fe(t.prototype,n),e&&Fe(t,e),Object.defineProperty(t,"prototype",{writable:!1}),i}(),He="propertychange",Ue="function"==typeof Object.assign?Object.assign:function(t,i){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),e=1,r=arguments.length;e<r;++e){var o=arguments[e];if(null!=o)for(var s in o)o.hasOwnProperty(s)&&(n[s]=o[s])}return n};function Ge(t){for(var i in t)delete t[i]}"function"==typeof Object.values&&Object.values;function Ve(t){for(var i in t)return;return!i}function qe(t){return(qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ze(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==qe(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==qe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===qe(t)?t:String(t)}(e.key),e)}}function Xe(t,i){return(Xe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function Ze(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=We(n),i=(t=e?(t=We(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===qe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function We(t){return(We=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ye=function(){var t=r,i=Sn;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&Xe(t,i);var n,e=Ze(r);function r(t){var i;if(this instanceof r)return(i=e.call(this)).eventTarget_=t,i.pendingRemovals_=null,i.dispatching_=null,i.listeners_=null,i;throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"addEventListener",value:function(t,i){var n;t&&i&&-1===(n=(n=this.listeners_||(this.listeners_={}))[t]||(n[t]=[])).indexOf(i)&&n.push(i)}},{key:"dispatchEvent",value:function(t){var i="string"==typeof t,n=i?t:t.type,e=this.listeners_&&this.listeners_[n];if(e){var r,o=i?new _e(t):t,i=(o.target||(o.target=this.eventTarget_||this),this.dispatching_||(this.dispatching_={})),t=this.pendingRemovals_||(this.pendingRemovals_={});n in i||(i[n]=0,t[n]=0),++i[n];for(var s=0,u=e.length;s<u;++s)if(!1===(r="handleEvent"in e[s]?e[s].handleEvent(o):e[s].call(this,o))||o.propagationStopped){r=!1;break}if(0==--i[n]){var h=t[n];for(delete t[n];h--;)this.removeEventListener(n,An);delete i[n]}return r}}},{key:"disposeInternal",value:function(){this.listeners_&&Ge(this.listeners_)}},{key:"getListeners",value:function(t){return this.listeners_&&this.listeners_[t]||void 0}},{key:"hasListener",value:function(t){return!!this.listeners_&&(t?t in this.listeners_:0<Object.keys(this.listeners_).length)}},{key:"removeEventListener",value:function(t,i){var n=this.listeners_&&this.listeners_[t];n&&-1!==(i=n.indexOf(i))&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[i]=An,++this.pendingRemovals_[t]):(n.splice(i,1),0===n.length&&delete this.listeners_[t]))}}])&&ze(t.prototype,i),n&&ze(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}(),Ke="change",Qe="error",$e="load",Je="resize";function b(t,i,n,e,r){e&&e!==t&&(n=n.bind(e)),r&&(o=n,n=function(){t.removeEventListener(i,n),o.apply(this,arguments)});var o,e={target:t,type:i,listener:n};return t.addEventListener(i,n),e}function tr(t,i,n,e){return b(t,i,n,e,!0)}function ir(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),Ge(t))}function nr(t){return(nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function er(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==nr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==nr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===nr(t)?t:String(t)}(e.key),e)}}function rr(t,i){return(rr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function or(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=sr(n),i=(t=e?(t=sr(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===nr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function sr(t){return(sr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}i=function(){var t=r,i=Ye;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&rr(t,i);var n,e=or(r);function r(){var t;if(this instanceof r)return(t=e.call(this)).on=t.onInternal,t.once=t.onceInternal,t.un=t.unInternal,t.revision_=0,t;throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"changed",value:function(){++this.revision_,this.dispatchEvent(Ke)}},{key:"getRevision",value:function(){return this.revision_}},{key:"onInternal",value:function(t,i){if(Array.isArray(t)){for(var n=t.length,e=new Array(n),r=0;r<n;++r)e[r]=b(this,t[r],i);return e}return b(this,t,i)}},{key:"onceInternal",value:function(t,i){if(Array.isArray(t))for(var n=t.length,e=new Array(n),r=0;r<n;++r)e[r]=tr(this,t[r],i);else e=tr(this,t,i);return i.ol_key=e}},{key:"unInternal",value:function(t,i){var n=i.ol_key;if(n){var e=n;if(Array.isArray(e))for(var r=0,o=e.length;r<o;++r)ir(e[r]);else ir(e)}else if(Array.isArray(t))for(var s=0,u=t.length;s<u;++s)this.removeEventListener(t[s],i);else this.removeEventListener(t,i)}}])&&er(t.prototype,i),n&&er(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();i.prototype.on,i.prototype.once,i.prototype.un;var ur=i;function hr(t){return(hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ar(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==hr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==hr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===hr(t)?t:String(t)}(e.key),e)}}function cr(t,i,n){return i&&ar(t.prototype,i),n&&ar(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function fr(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function lr(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&vr(t,i)}function vr(t,i){return(vr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function yr(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=br(n),i=(t=e?(t=br(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===hr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return dr(i)}}function dr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function br(t){return(br=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var pr=function(){lr(r,_e);var e=yr(r);function r(t,i,n){return fr(this,r),(t=e.call(this,t)).key=i,t.oldValue=n,t}return cr(r)}(),mr=function(){lr(e,ur);var n=yr(e);function e(t){var i;return fr(this,e),(i=n.call(this)).on,i.once,i.un,Pn(dr(i)),i.values_=null,void 0!==t&&i.setProperties(t),i}return cr(e,[{key:"get",value:function(t){var i;return i=this.values_&&this.values_.hasOwnProperty(t)?this.values_[t]:i}},{key:"getKeys",value:function(){return this.values_&&Object.keys(this.values_)||[]}},{key:"getProperties",value:function(){return this.values_&&Ue({},this.values_)||{}}},{key:"hasProperties",value:function(){return!!this.values_}},{key:"notify",value:function(t,i){var n="change:".concat(t);this.hasListener(n)&&this.dispatchEvent(new pr(n,t,i)),n=He,this.hasListener(n)&&this.dispatchEvent(new pr(n,t,i))}},{key:"addChangeListener",value:function(t,i){this.addEventListener("change:".concat(t),i)}},{key:"removeChangeListener",value:function(t,i){this.removeEventListener("change:".concat(t),i)}},{key:"set",value:function(t,i,n){var e=this.values_||(this.values_={});n?e[t]=i:(n=e[t])!==(e[t]=i)&&this.notify(t,n)}},{key:"setProperties",value:function(t,i){for(var n in t)this.set(n,t[n],i)}},{key:"applyProperties",value:function(t){t.values_&&Ue(this.values_||(this.values_={}),t.values_)}},{key:"unset",value:function(t,i){var n;this.values_&&t in this.values_&&(n=this.values_[t],delete this.values_[t],Ve(this.values_)&&(this.values_=null),i||this.notify(t,n))}}]),e}(),wr="opacity",gr="visible",jr="extent",Mr="zIndex",Sr="maxResolution",Or="minResolution",Er="maxZoom",kr="minZoom",Tr="source",Rr="map";function Ar(t){return(Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xr(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Ar(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Ar(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Ar(t)?t:String(t)}(e.key),e)}}function Pr(){return(Pr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,n){var e=function(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=Ir(t)););return t}(t,i);if(e)return(e=Object.getOwnPropertyDescriptor(e,i)).get?e.get.call(arguments.length<3?t:n):e.value}).apply(this,arguments)}function Cr(t,i){return(Cr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function Lr(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Ir(n),i=(t=e?(t=Ir(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===Ar(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Ir(t){return(Ir=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Nr=function(){var t=r,i=mr;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&Cr(t,i);var n,e=Lr(r);function r(t){var i;if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");(i=e.call(this)).on,i.once,i.un,i.background_=t.background;var n=Ue({},t);return"object"===Ar(t.properties)&&(delete n.properties,Ue(n,t.properties)),n[wr]=void 0!==t.opacity?t.opacity:1,v("number"==typeof n[wr],64),n[gr]=void 0===t.visible||t.visible,n[Mr]=t.zIndex,n[Sr]=void 0!==t.maxResolution?t.maxResolution:1/0,n[Or]=void 0!==t.minResolution?t.minResolution:0,n[kr]=void 0!==t.minZoom?t.minZoom:-1/0,n[Er]=void 0!==t.maxZoom?t.maxZoom:1/0,i.className_=void 0!==n.className?n.className:"ol-layer",delete n.className,i.setProperties(n),i.state_=null,i}return t=r,(i=[{key:"getBackground",value:function(){return this.background_}},{key:"getClassName",value:function(){return this.className_}},{key:"getLayerState",value:function(t){var t=this.state_||{layer:this,managed:void 0===t||t},i=this.getZIndex();return t.opacity=be(Math.round(100*this.getOpacity())/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=void 0!==i||t.managed?i:1/0,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t}},{key:"getLayersArray",value:l},{key:"getLayerStatesArray",value:function(t){return l()}},{key:"getExtent",value:function(){return this.get(jr)}},{key:"getMaxResolution",value:function(){return this.get(Sr)}},{key:"getMinResolution",value:function(){return this.get(Or)}},{key:"getMinZoom",value:function(){return this.get(kr)}},{key:"getMaxZoom",value:function(){return this.get(Er)}},{key:"getOpacity",value:function(){return this.get(wr)}},{key:"getSourceState",value:function(){return l()}},{key:"getVisible",value:function(){return this.get(gr)}},{key:"getZIndex",value:function(){return this.get(Mr)}},{key:"setBackground",value:function(t){this.background_=t,this.changed()}},{key:"setExtent",value:function(t){this.set(jr,t)}},{key:"setMaxResolution",value:function(t){this.set(Sr,t)}},{key:"setMinResolution",value:function(t){this.set(Or,t)}},{key:"setMaxZoom",value:function(t){this.set(Er,t)}},{key:"setMinZoom",value:function(t){this.set(kr,t)}},{key:"setOpacity",value:function(t){v("number"==typeof t,64),this.set(wr,t)}},{key:"setVisible",value:function(t){this.set(gr,t)}},{key:"setZIndex",value:function(t){this.set(Mr,t)}},{key:"disposeInternal",value:function(){this.state_&&(this.state_.layer=null,this.state_=null),Pr(Ir(r.prototype),"disposeInternal",this).call(this)}}])&&xr(t.prototype,i),n&&xr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}(),Br="prerender",Dr="postrender",Fr="precompose",_r="rendercomplete",Hr="undefined",Ur="ready";function Gr(t){return(Gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vr(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Gr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Gr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Gr(t)?t:String(t)}(e.key),e)}}function qr(){return(qr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,n){var e=function(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=Zr(t)););return t}(t,i);if(e)return(e=Object.getOwnPropertyDescriptor(e,i)).get?e.get.call(arguments.length<3?t:n):e.value}).apply(this,arguments)}function zr(t,i){return(zr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function Xr(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Zr(n),i=(t=e?(t=Zr(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===Gr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Zr(t){return(Zr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wr(t,i){if(t.visible){var n=i.resolution;if(!(n<t.minResolution||n>=t.maxResolution))return(n=i.zoom)>t.minZoom&&n<=t.maxZoom}}var Yr=function(){var t=r,i=Nr;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&zr(t,i);var n,e=Xr(r);function r(t){var i;if(this instanceof r)return delete(i=Ue({},t)).source,(i=e.call(this,i)).on,i.once,i.un,i.mapPrecomposeKey_=null,i.mapRenderKey_=null,i.sourceChangeKey_=null,i.renderer_=null,i.rendered=!1,t.render&&(i.render=t.render),t.map&&i.setMap(t.map),i.addChangeListener(Tr,i.handleSourcePropertyChange_),t=t.source||null,i.setSource(t),i;throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"getLayersArray",value:function(t){t=t||[];return t.push(this),t}},{key:"getLayerStatesArray",value:function(t){t=t||[];return t.push(this.getLayerState()),t}},{key:"getSource",value:function(){return this.get(Tr)||null}},{key:"getRenderSource",value:function(){return this.getSource()}},{key:"getSourceState",value:function(){var t=this.getSource();return t?t.getState():Hr}},{key:"handleSourceChange_",value:function(){this.changed()}},{key:"handleSourcePropertyChange_",value:function(){this.sourceChangeKey_&&(ir(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=b(t,Ke,this.handleSourceChange_,this)),this.changed()}},{key:"getFeatures",value:function(t){return this.renderer_?this.renderer_.getFeatures(t):new Promise(function(t){return t([])})}},{key:"getData",value:function(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null}},{key:"render",value:function(t,i){var n=this.getRenderer();if(n.prepareFrame(t))return this.rendered=!0,n.renderFrame(t,i)}},{key:"unrender",value:function(){this.rendered=!1}},{key:"setMapInternal",value:function(t){t||this.unrender(),this.set(Rr,t)}},{key:"getMapInternal",value:function(){return this.get(Rr)}},{key:"setMap",value:function(t){this.mapPrecomposeKey_&&(ir(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(ir(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=b(t,Fr,function(t){var t=t.frameState.layerStatesArray,i=this.getLayerState(!1);v(!t.some(function(t){return t.layer===i.layer}),67),t.push(i)},this),this.mapRenderKey_=b(this,Ke,t.render,t),this.changed())}},{key:"setSource",value:function(t){this.set(Tr,t)}},{key:"getRenderer",value:function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}},{key:"hasRenderer",value:function(){return!!this.renderer_}},{key:"createRenderer",value:function(){return null}},{key:"disposeInternal",value:function(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),qr(Zr(r.prototype),"disposeInternal",this).call(this)}}])&&Vr(t.prototype,i),n&&Vr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function Kr(t,i){for(var n=!0,e=t.length-1;0<=e;--e)if(t[e]!=i[e]){n=!1;break}return n}function Qr(t,i,n){var e=i.getExtent(),r=0;return i.canWrapX()&&(t[0]<e[0]||t[0]>e[2])&&(i=n||le(e),r=Math.floor((t[0]-e[0])/i)),r}function $r(t){return($r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jr(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==$r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==$r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===$r(t)?t:String(t)}(e.key),e)}}function to(t,i){return(to=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function io(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=no(n),i=(t=e?(t=no(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===$r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function no(t){return(no=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function eo(t,i){Be.expire()}var ro=function(){var t=r,i=Sn;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&to(t,i);var n,e=io(r);function r(t){var i;if(this instanceof r)return(i=e.call(this)).map_=t,i;throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"dispatchRenderEvent",value:function(t,i){l()}},{key:"calculateMatrices2D",value:function(t){var i=t.viewState,n=t.coordinateToPixelTransform,e=t.pixelToCoordinateTransform;Xn(n,t.size[0]/2,t.size[1]/2,1/i.resolution,-1/i.resolution,-i.rotation,-i.center[0],-i.center[1]),Zn(e,n)}},{key:"forEachFeatureAtCoordinate",value:function(t,i,n,e,r,o,s,u){var h,a=i.viewState;function c(t,i,n,e){return r.call(o,i,t?n:null,e)}for(var f,l,v,y,d=a.projection,b=(f=t.slice(),(v=d).canWrapX()&&(l=le(v.getExtent()),v=Qr(f,v,l))&&(f[0]-=v*l),f),p=[[0,0]],m=(d.canWrapX()&&e&&(v=le(d.getExtent()),p.push([-v,0],[v,0])),i.layerStatesArray),w=m.length,g=[],j=[],M=0;M<p.length;M++)for(var S=w-1;0<=S;--S){var O=m[S],E=O.layer;if(E.hasRenderer()&&Wr(O,a)&&s.call(u,E)){var k=E.getRenderer(),E=E.getSource();if(k&&E&&(E=E.getWrapX()?b:t,O=c.bind(null,O.managed),j[0]=E[0]+p[M][0],j[1]=E[1]+p[M][1],h=k.forEachFeatureAtCoordinate(j,i,n,O,g)),h)return h}}if(0!==g.length)return y=1/g.length,g.forEach(function(t,i){return t.distanceSq+=i*y}),g.sort(function(t,i){return t.distanceSq-i.distanceSq}),g.some(function(t){return h=t.callback(t.feature,t.layer,t.geometry)}),h}},{key:"forEachLayerAtPixel",value:function(t,i,n,e,r){return l()}},{key:"hasFeatureAtCoordinate",value:function(t,i,n,e,r,o){return void 0!==this.forEachFeatureAtCoordinate(t,i,n,e,Rn,this,r,o)}},{key:"getMap",value:function(){return this.map_}},{key:"renderFrame",value:function(t){l()}},{key:"scheduleExpireIconCache",value:function(t){Be.canExpireCache()&&t.postRenderFunctions.push(eo)}}])&&Jr(t.prototype,i),n&&Jr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function oo(t){return(oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function so(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==oo(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==oo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===oo(t)?t:String(t)}(e.key),e)}}function uo(){return(uo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,n){var e=function(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=co(t)););return t}(t,i);if(e)return(e=Object.getOwnPropertyDescriptor(e,i)).get?e.get.call(arguments.length<3?t:n):e.value}).apply(this,arguments)}function ho(t,i){return(ho=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function ao(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=co(n),i=(t=e?(t=co(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===oo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function co(t){return(co=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var fo=function(){var t=r,i=ro;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&ho(t,i);var n,e=ao(r);function r(t){if(this instanceof r)return(t=e.call(this,t)).children_=[],t.renderedVisible_=!0,t;throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"disposeInternal",value:function(){uo(co(r.prototype),"disposeInternal",this).call(this)}},{key:"renderFrame",value:function(t){this.calculateMatrices2D(t);for(var i=t.layerStatesArray.sort(function(t,i){return t.zIndex-i.zIndex}),n=t.viewState,e=[],r=null,o=this.children_.length=0,s=i.length;o<s;++o){var u=i[o],h=(t.layerIndex=o,u.layer),a=h.getSourceState();!Wr(u,n)||a!=Ur&&a!=Hr?h.unrender():(u=h.render(t,r))&&(u!==r&&(this.children_.push(u),r=u),"getDeclutter"in h)&&e.push(h)}for(var c=e.length-1;0<=c;--c)e[c].renderDeclutter(t);this.scheduleExpireIconCache(t)}}])&&so(t.prototype,i),n&&so(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}(),lo="add",vo="remove";function yo(t){return(yo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bo(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==yo(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==yo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===yo(t)?t:String(t)}(e.key),e)}}function po(t,i,n){return i&&bo(t.prototype,i),n&&bo(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function mo(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function wo(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&go(t,i)}function go(t,i){return(go=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function jo(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Mo(n),i=(t=e?(t=Mo(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===yo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Mo(t){return(Mo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var So="length",Oo=function(){wo(r,_e);var e=jo(r);function r(t,i,n){return mo(this,r),(t=e.call(this,t)).element=i,t.index=n,t}return po(r)}(),Eo=function(){wo(s,mr);var o=jo(s);function s(t,i){mo(this,s),(n=o.call(this)).on,n.once,n.un;var n,i=i||{};if(n.unique_=!!i.unique,n.array_=t||[],n.unique_)for(var e=0,r=n.array_.length;e<r;++e)n.assertUnique_(n.array_[e],e);return n.updateLength_(),n}return po(s,[{key:"clear",value:function(){for(;0<this.getLength();)this.pop()}},{key:"extend",value:function(t){for(var i=0,n=t.length;i<n;++i)this.push(t[i]);return this}},{key:"forEach",value:function(t){for(var i=this.array_,n=0,e=i.length;n<e;++n)t(i[n],n,i)}},{key:"getArray",value:function(){return this.array_}},{key:"item",value:function(t){return this.array_[t]}},{key:"getLength",value:function(){return this.get(So)}},{key:"insertAt",value:function(t,i){this.unique_&&this.assertUnique_(i),this.array_.splice(t,0,i),this.updateLength_(),this.dispatchEvent(new Oo(lo,i,t))}},{key:"pop",value:function(){return this.removeAt(this.getLength()-1)}},{key:"push",value:function(t){this.unique_&&this.assertUnique_(t);var i=this.getLength();return this.insertAt(i,t),this.getLength()}},{key:"remove",value:function(t){for(var i=this.array_,n=0,e=i.length;n<e;++n)if(i[n]===t)return this.removeAt(n)}},{key:"removeAt",value:function(t){var i=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Oo(vo,i,t)),i}},{key:"setAt",value:function(t,i){var n=this.getLength();if(t<n){this.unique_&&this.assertUnique_(i,t);var e=this.array_[t];this.array_[t]=i,this.dispatchEvent(new Oo(vo,e,t)),this.dispatchEvent(new Oo(lo,i,t))}else{for(var r=n;r<t;++r)this.insertAt(r,void 0);this.insertAt(t,i)}}},{key:"updateLength_",value:function(){this.set(So,this.array_.length)}},{key:"assertUnique_",value:function(t,i){for(var n=0,e=this.array_.length;n<e;++n)if(this.array_[n]===t&&n!==i)throw new Vn(58)}}]),s}();function ko(t){return(ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function To(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==ko(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==ko(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===ko(t)?t:String(t)}(e.key),e)}}function Ro(t,i,n){return i&&To(t.prototype,i),n&&To(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ao(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function xo(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&Po(t,i)}function Po(t,i){return(Po=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function Co(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Lo(n),i=(t=e?(t=Lo(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===ko(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Lo(t){return(Lo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Io=function(){xo(e,_e);var n=Co(e);function e(t,i){return Ao(this,e),(t=n.call(this,t)).layer=i,t}return Ro(e)}(),No="layers",Bo=function(){xo(e,Nr);var n=Co(e);function e(t){Ao(this,e);var t=t||{},i=Ue({},t),t=(delete i.layers,t.layers),i=n.call(this,i);return i.on,i.once,i.un,i.layersListenerKeys_=[],i.listenerKeys_={},i.addChangeListener(No,i.handleLayersChanged_),t?Array.isArray(t)?t=new Eo(t.slice(),{unique:!0}):v("function"==typeof t.getArray,43):t=new Eo(void 0,{unique:!0}),i.setLayers(t),i}return Ro(e,[{key:"handleLayerChange_",value:function(){this.changed()}},{key:"handleLayersChanged_",value:function(){this.layersListenerKeys_.forEach(ir),this.layersListenerKeys_.length=0;var t,i=this.getLayers();for(t in this.layersListenerKeys_.push(b(i,lo,this.handleLayersAdd_,this),b(i,vo,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[t].forEach(ir);Ge(this.listenerKeys_);for(var n=i.getArray(),e=0,r=n.length;e<r;e++){var o=n[e];this.registerLayerListeners_(o),this.dispatchEvent(new Io("addlayer",o))}this.changed()}},{key:"registerLayerListeners_",value:function(t){var i=[b(t,He,this.handleLayerChange_,this),b(t,Ke,this.handleLayerChange_,this)];t instanceof e&&i.push(b(t,"addlayer",this.handleLayerGroupAdd_,this),b(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[Pn(t)]=i}},{key:"handleLayerGroupAdd_",value:function(t){this.dispatchEvent(new Io("addlayer",t.layer))}},{key:"handleLayerGroupRemove_",value:function(t){this.dispatchEvent(new Io("removelayer",t.layer))}},{key:"handleLayersAdd_",value:function(t){t=t.element;this.registerLayerListeners_(t),this.dispatchEvent(new Io("addlayer",t)),this.changed()}},{key:"handleLayersRemove_",value:function(t){var t=t.element,i=Pn(t);this.listenerKeys_[i].forEach(ir),delete this.listenerKeys_[i],this.dispatchEvent(new Io("removelayer",t)),this.changed()}},{key:"getLayers",value:function(){return this.get(No)}},{key:"setLayers",value:function(t){var i=this.getLayers();if(i)for(var n=i.getArray(),e=0,r=n.length;e<r;++e)this.dispatchEvent(new Io("removelayer",n[e]));this.set(No,t)}},{key:"getLayersArray",value:function(t){var i=void 0!==t?t:[];return this.getLayers().forEach(function(t){t.getLayersArray(i)}),i}},{key:"getLayerStatesArray",value:function(t){var i=void 0!==t?t:[],n=i.length,e=(this.getLayers().forEach(function(t){t.getLayerStatesArray(i)}),this.getLayerState()),r=e.zIndex;t||void 0!==e.zIndex||(r=0);for(var o=n,s=i.length;o<s;o++){var u=i[o];u.opacity*=e.opacity,u.visible=u.visible&&e.visible,u.maxResolution=Math.min(u.maxResolution,e.maxResolution),u.minResolution=Math.max(u.minResolution,e.minResolution),u.minZoom=Math.max(u.minZoom,e.minZoom),u.maxZoom=Math.min(u.maxZoom,e.maxZoom),void 0!==e.extent&&(void 0!==u.extent?u.extent=ae(u.extent,e.extent):u.extent=e.extent),void 0===u.zIndex&&(u.zIndex=r)}return i}},{key:"getSourceState",value:function(){return Ur}}]),e}();function Do(t){return(Do="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fo(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Do(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Do(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Do(t)?t:String(t)}(e.key),e)}}function _o(t,i){return(_o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function Ho(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Uo(n),i=(t=e?(t=Uo(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===Do(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Uo(t){return(Uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Go=function(){var t=o,i=_e;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&_o(t,i);var n,e,r=Ho(o);function o(t,i,n){if(this instanceof o)return(t=r.call(this,t)).map=i,t.frameState=void 0!==n?n:null,t;throw new TypeError("Cannot call a class as a function")}return t=o,n&&Fo(t.prototype,n),e&&Fo(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}(),Vo="postrender",qo="movestart",zo="moveend",Xo={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};function Zo(t){return(Zo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wo(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Zo(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Zo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Zo(t)?t:String(t)}(e.key),e)}}var Yo=function(){function n(t,i){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");this.priorityFunction_=t,this.keyFunction_=i,this.elements_=[],this.priorities_=[],this.queuedElements_={}}var t,i,e;return t=n,(i=[{key:"clear",value:function(){this.elements_.length=0,this.priorities_.length=0,Ge(this.queuedElements_)}},{key:"dequeue",value:function(){var t=this.elements_,i=this.priorities_,n=t[0],t=(1==t.length?(t.length=0,i.length=0):(t[0]=t.pop(),i[0]=i.pop(),this.siftUp_(0)),this.keyFunction_(n));return delete this.queuedElements_[t],n}},{key:"enqueue",value:function(t){v(!(this.keyFunction_(t)in this.queuedElements_),31);var i=this.priorityFunction_(t);return i!=1/0&&(this.elements_.push(t),this.priorities_.push(i),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}},{key:"getCount",value:function(){return this.elements_.length}},{key:"getLeftChildIndex_",value:function(t){return 2*t+1}},{key:"getRightChildIndex_",value:function(t){return 2*t+2}},{key:"getParentIndex_",value:function(t){return t-1>>1}},{key:"heapify_",value:function(){for(var t=(this.elements_.length>>1)-1;0<=t;t--)this.siftUp_(t)}},{key:"isEmpty",value:function(){return 0===this.elements_.length}},{key:"isKeyQueued",value:function(t){return t in this.queuedElements_}},{key:"isQueued",value:function(t){return this.isKeyQueued(this.keyFunction_(t))}},{key:"siftUp_",value:function(t){for(var i=this.elements_,n=this.priorities_,e=i.length,r=i[t],o=n[t],s=t;t<e>>1;){var u=this.getLeftChildIndex_(t),h=this.getRightChildIndex_(t),h=h<e&&n[h]<n[u]?h:u;i[t]=i[h],n[t]=n[h],t=h}i[t]=r,n[t]=o,this.siftDown_(s,t)}},{key:"siftDown_",value:function(t,i){for(var n=this.elements_,e=this.priorities_,r=n[i],o=e[i];t<i;){var s=this.getParentIndex_(i);if(!(e[s]>o))break;n[i]=n[s],e[i]=e[s],i=s}n[i]=r,e[i]=o}},{key:"reprioritize",value:function(){for(var t,i,n=this.priorityFunction_,e=this.elements_,r=this.priorities_,o=0,s=e.length,u=0;u<s;++u)(i=n(t=e[u]))==1/0?delete this.queuedElements_[this.keyFunction_(t)]:(r[o]=i,e[o++]=t);e.length=o,r.length=o,this.heapify_()}}])&&Wo(t.prototype,i),e&&Wo(t,e),Object.defineProperty(t,"prototype",{writable:!1}),n}(),Ko=0,Qo=1,$o=2,Jo=3,ts=4;function is(t){return(is="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ns(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==is(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==is(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===is(t)?t:String(t)}(e.key),e)}}function es(){return(es="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,n){var e=function(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=us(t)););return t}(t,i);if(e)return(e=Object.getOwnPropertyDescriptor(e,i)).get?e.get.call(arguments.length<3?t:n):e.value}).apply(this,arguments)}function rs(t,i){return(rs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function os(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=us(n),i=(t=e?(t=us(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===is(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ss(i)}}function ss(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function us(t){return(us=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var hs=function(){var t=r,i=Yo;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&rs(t,i);var n,e=os(r);function r(i,t){var n;if(this instanceof r)return(n=e.call(this,function(t){return i.apply(null,t)},function(t){return t[0].getKey()})).boundHandleTileChange_=n.handleTileChange.bind(ss(n)),n.tileChangeCallback_=t,n.tilesLoading_=0,n.tilesLoadingKeys_={},n;throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"enqueue",value:function(t){var i=es(us(r.prototype),"enqueue",this).call(this,t);return i&&t[0].addEventListener(Ke,this.boundHandleTileChange_),i}},{key:"getTilesLoading",value:function(){return this.tilesLoading_}},{key:"handleTileChange",value:function(t){var t=t.target,i=t.getState();i!==$o&&i!==Jo&&i!==ts||(t.removeEventListener(Ke,this.boundHandleTileChange_),(i=t.getKey())in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_())}},{key:"loadMoreTiles",value:function(t,i){for(var n,e,r=0;this.tilesLoading_<t&&r<i&&0<this.getCount();)e=(n=this.dequeue()[0]).getKey(),n.getState()!==Ko||e in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[e]=!0,++this.tilesLoading_,++r,n.load())}}])&&ns(t.prototype,i),n&&ns(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();i={RADIANS:"radians",DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"};var as={},cs=(as[i.RADIANS]=6370997/(2*Math.PI),as[i.DEGREES]=2*Math.PI*6370997/360,as[i.FEET]=.3048,as[i.METERS]=1,as[i.USFEET]=1200/3937,i),fs=0,ls=1,vs={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},ys=42,ds=256;function bs(t){return(bs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ps(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==bs(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==bs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===bs(t)?t:String(t)}(e.key),e)}}var ms=function(){function i(t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}var t,n,e;return t=i,(n=[{key:"canWrapX",value:function(){return this.canWrapX_}},{key:"getCode",value:function(){return this.code_}},{key:"getExtent",value:function(){return this.extent_}},{key:"getUnits",value:function(){return this.units_}},{key:"getMetersPerUnit",value:function(){return this.metersPerUnit_||as[this.units_]}},{key:"getWorldExtent",value:function(){return this.worldExtent_}},{key:"getAxisOrientation",value:function(){return this.axisOrientation_}},{key:"isGlobal",value:function(){return this.global_}},{key:"setGlobal",value:function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}},{key:"getDefaultTileGrid",value:function(){return this.defaultTileGrid_}},{key:"setDefaultTileGrid",value:function(t){this.defaultTileGrid_=t}},{key:"setExtent",value:function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}},{key:"setWorldExtent",value:function(t){this.worldExtent_=t}},{key:"setGetPointResolution",value:function(t){this.getPointResolutionFunc_=t}},{key:"getPointResolutionFunc",value:function(){return this.getPointResolutionFunc_}}])&&ps(t.prototype,n),e&&ps(t,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function ws(t){return(ws="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gs(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==ws(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==ws(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===ws(t)?t:String(t)}(e.key),e)}}function js(t,i){return(js=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function Ms(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Ss(n),i=(t=e?(t=Ss(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===ws(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Ss(t){return(Ss=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Os=6378137,Es=Math.PI*Os,ks=[-Es,-Es,Es,Es],Ts=[-180,-85,180,85],Rs=Os*Math.log(Math.tan(Math.PI/2)),i=function(){var t=o,i=ms;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&js(t,i);var n,e,r=Ms(o);function o(t){if(this instanceof o)return r.call(this,{code:t,units:cs.METERS,extent:ks,global:!0,worldExtent:Ts,getPointResolution:function(t,i){return t/pe(i[1]/Os)}});throw new TypeError("Cannot call a class as a function")}return t=o,n&&gs(t.prototype,n),e&&gs(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}(),i=[new i("EPSG:3857"),new i("EPSG:102100"),new i("EPSG:102113"),new i("EPSG:900913"),new i("http://www.opengis.net/def/crs/EPSG/0/3857"),new i("http://www.opengis.net/gml/srs/epsg.xml#3857")];function As(t,i,n){var e=t.length,r=1<n?n:2,o=i;void 0===o&&(o=2<r?t.slice():new Array(e));for(var s=0;s<e;s+=r){o[s]=Es*t[s]/180;var u=Os*Math.log(Math.tan(Math.PI*(+t[s+1]+90)/360));Rs<u?u=Rs:u<-Rs&&(u=-Rs),o[s+1]=u}return o}function xs(t,i,n){var e=t.length,r=1<n?n:2,o=i;void 0===o&&(o=2<r?t.slice():new Array(e));for(var s=0;s<e;s+=r)o[s]=180*t[s]/Es,o[s+1]=360*Math.atan(Math.exp(t[s+1]/Os))/Math.PI-90;return o}function Ps(t){return(Ps="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cs(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Ps(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Ps(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Ps(t)?t:String(t)}(e.key),e)}}function Ls(t,i){return(Ls=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function Is(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Ns(n),i=(t=e?(t=Ns(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===Ps(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Ns(t){return(Ns=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Bs=[-180,-90,180,90],Ds=6378137*Math.PI/180,n=function(){var t=o,i=ms;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&Ls(t,i);var n,e,r=Is(o);function o(t,i){if(this instanceof o)return r.call(this,{code:t,units:cs.DEGREES,extent:Bs,axisOrientation:i,global:!0,metersPerUnit:Ds,worldExtent:Bs});throw new TypeError("Cannot call a class as a function")}return t=o,n&&Cs(t.prototype,n),e&&Cs(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}(),n=[new n("CRS:84"),new n("EPSG:4326","neu"),new n("urn:ogc:def:crs:OGC:1.3:CRS84"),new n("urn:ogc:def:crs:OGC:2:84"),new n("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new n("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new n("http://www.opengis.net/def/crs/EPSG/0/4326","neu")],Fs={};var _s={};function Hs(t,i,n){t=t.getCode(),i=i.getCode();t in _s||(_s[t]={}),_s[t][i]=n}var Us="Point",Gs="LinearRing",Vs="Polygon";var qs=!0;function zs(t){qs=!(void 0===t||t)}function Xs(t,i,n){var e;if(void 0!==i){for(var r=0,o=t.length;r<o;++r)i[r]=t[r];e=i}else e=t.slice();return e}function Zs(t,i,n){if(void 0!==i&&t!==i){for(var e=0,r=t.length;e<r;++e)i[e]=t[e];t=i}return t}function Ws(t){var i;i=t.getCode(),Hs(Fs[i]=t,t,Xs)}function Ys(t){return"string"==typeof t?Fs[i=t]||Fs[i.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:t||null;var i}function Ks(t){t.forEach(Ws),t.forEach(function(i){t.forEach(function(t){i!==t&&Hs(i,t,Xs)})})}function Qs(t,i){return t?"string"==typeof t?Ys(t):t:Ys(i)}function $s(t,i){var n;return t===i||(n=t.getUnits()===i.getUnits(),(t.getCode()===i.getCode()||Js(t,i)===Xs)&&n)}function Js(t,i){var n,t=t.getCode(),i=i.getCode();i=i,n=(t=t)in _s&&i in _s[t]?_s[t][i]:n;return n||Zs}function tu(t,i){return Js(Ys(t),Ys(i))}function iu(t,i,n){return tu(i,n)(t,void 0,t.length)}function nu(t,i,n,e){return de(t,tu(i,n),void 0,e)}var eu,ru,ou,su=null;function uu(t,i){return su?iu(t,i,su):t}function hu(t,i){return su?iu(t,su,i):(qs&&!Kr(t,[0,0])&&-180<=t[0]&&t[0]<=180&&-90<=t[1]&&t[1]<=90&&(qs=!1,console.warn("Call useGeographic() ol/proj once to work with [longitude, latitude] coordinates.")),t)}function au(t,i){return su?nu(t,su,i):t}function cu(a,c,f){return function(t,i,n,e,r){var o,s,u,h;if(t)return i||c?(s=c?0:n[0]*i,n=c?0:n[1]*i,u=r?r[0]:0,r=r?r[1]:0,o=a[0]+s/2+u,s=a[2]-s/2+u,u=a[1]+n/2+r,s<o&&(s=o=(s+o)/2),(n=a[3]-n/2+r)<u&&(n=u=(n+u)/2),r=be(t[0],o,s),h=be(t[1],u,n),e&&f&&i&&(r+=-(e=30*i)*Math.log(1+Math.max(0,o-t[0])/e)+e*Math.log(1+Math.max(0,t[0]-s)/e),h+=-e*Math.log(1+Math.max(0,u-t[1])/e)+e*Math.log(1+Math.max(0,t[1]-n)/e)),[r,h]):t}}function fu(t){return t}function lu(u,h,a,c,f){return function(t,i,n,e){var r,o,s;if(void 0!==t)return n=c?(r=u,s=le(o=c)/n[0],o=he(o)/n[1],f?Math.min(r,Math.max(s,o)):Math.min(r,Math.min(s,o))):u,(void 0===a||a)&&e?(r=t,s=n,o=h,e=Math.min(r,s),e*=Math.log(1+50*Math.max(0,r/s-1))/50+1,o&&(e=Math.max(e,o),e/=Math.log(1+50*Math.max(0,o/r-1))/50+1),be(e,o/2,2*s)):be(t,h,n)}}function vu(t){if(void 0!==t)return 0}function yu(t){if(void 0!==t)return t}function du(t){return Math.pow(t,3)}function bu(t){return 1-du(1-t)}function pu(t){return 3*t*t-2*t*t*t}function mu(t){return(mu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wu(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==mu(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==mu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===mu(t)?t:String(t)}(e.key),e)}}function gu(t,i){return(gu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function ju(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Mu(n),i=(t=e?(t=Mu(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===mu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Mu(t){return(Mu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Ks(i),Ks(n),eu=i,ru=As,ou=xs,n.forEach(function(i){eu.forEach(function(t){Hs(i,t,ru),Hs(t,i,ou)})});function Su(t,i){setTimeout(function(){t(i)},0)}function Ou(t,i,n,e,r){var o=Math.cos(-r),r=Math.sin(-r),s=t[0]*o-t[1]*r,t=t[1]*o+t[0]*r;return[(s+=(i[0]/2-n[0])*e)*o-(t+=(n[1]-i[1]/2)*e)*(r=-r),t*o+s*r]}var Eu=function(){var t=r,i=mr;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&gu(t,i);var n,e=ju(r);function r(t){var i;if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");(i=e.call(this)).on,i.once,i.un;t=Ue({},t);return i.hints_=[0,0],i.animations_=[],i.updateAnimationKey_,i.projection_=Qs(t.projection,"EPSG:3857"),i.viewportSize_=[100,100],i.targetCenter_=null,i.targetResolution_,i.targetRotation_,i.nextCenter_=null,i.nextResolution_,i.nextRotation_,i.cancelAnchor_=void 0,t.center&&(t.center=hu(t.center,i.projection_)),t.extent&&(t.extent=au(t.extent,i.projection_)),t.projection&&zs(),i.applyOptions_(t),i}return t=r,(i=[{key:"applyOptions_",value:function(t){var i,n=Ue({},t);for(i in vs)delete n[i];this.setProperties(n,!0);var e=function(t){var i,n=void 0!==t.minZoom?t.minZoom:0,e=void 0!==t.maxZoom?t.maxZoom:28,r=void 0!==t.zoomFactor?t.zoomFactor:2,o=void 0!==t.multiWorld&&t.multiWorld,s=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,u=void 0!==t.showFullExtent&&t.showFullExtent,h=Qs(t.projection,"EPSG:3857"),a=h.getExtent(),c=t.constrainOnlyCenter,f=t.extent;o||f||!h.isGlobal()||(c=!1,f=a);o=(a?Math.max(le(a),he(a)):360*as[cs.DEGREES]/h.getMetersPerUnit())/ds/Math.pow(2,0),a=o/Math.pow(2,28);void 0!==(h=t.maxResolution)?n=0:h=o/Math.pow(r,n);void 0===(i=t.minResolution)&&(i=void 0!==t.maxZoom?void 0!==t.maxResolution?h/Math.pow(r,e):o/Math.pow(r,e):a);return e=n+Math.floor(Math.log(h/i)/Math.log(r)),i=h/Math.pow(r,e-n),{constraint:lu(h,i,s,!c&&f,u),maxResolution:h,minResolution:i,minZoom:n,zoomFactor:r}}(t),r=(this.maxResolution_=e.maxResolution,this.minResolution_=e.minResolution,this.zoomFactor_=e.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=e.minZoom,function(t){if(void 0!==t.extent)return i=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint,cu(t.extent,t.constrainOnlyCenter,i);var i=Qs(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&i.isGlobal())return(t=i.getExtent().slice())[0]=-1/0,t[2]=1/0,cu(t,!1,!1);return fu}(t)),e=e.constraint,o=void 0===(o=t).enableRotation||o.enableRotation?void 0===(o=o.constrainRotation)||!0===o?function(t){var n=t||we(5);return function(t,i){return i?t:void 0!==t?Math.abs(t)<=n?0:t:void 0}}():!1!==o&&"number"==typeof o?function(t){var n=2*Math.PI/t;return function(t,i){return i?t:void 0!==t?Math.floor(t/n+.5)*n:void 0}}(o):yu:vu;this.constraints_={center:r,resolution:e,rotation:o},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)}},{key:"padding",get:function(){return this.padding_},set:function(t){var i,n,e=this.padding_,r=(this.padding_=t,this.getCenter());r&&(t=t||[0,0,0,0],e=e||[0,0,0,0],i=(n=this.getResolution())/2*(t[3]-e[3]+e[1]-t[1]),n=n/2*(t[0]-e[0]+e[2]-t[2]),this.setCenterInternal([r[0]+i,r[1]-n]))}},{key:"getUpdatedOptions_",value:function(t){var i=this.getProperties();return void 0!==i.resolution?i.resolution=this.getResolution():i.zoom=this.getZoom(),i.center=this.getCenterInternal(),i.rotation=this.getRotation(),Ue({},i,t)}},{key:"animate",value:function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var i=new Array(arguments.length),n=0;n<i.length;++n){var e=arguments[n];e.center&&((e=Ue({},e)).center=hu(e.center,this.getProjection())),e.anchor&&((e=Ue({},e)).anchor=hu(e.anchor,this.getProjection())),i[n]=e}this.animateInternal.apply(this,i)}},{key:"animateInternal",value:function(t){for(var i,n=arguments.length,e=(1<n&&"function"==typeof arguments[n-1]&&(i=arguments[n-1],--n),0);e<n&&!this.isDef();++e){var r=arguments[e];r.center&&this.setCenterInternal(r.center),void 0!==r.zoom?this.setZoom(r.zoom):r.resolution&&this.setResolution(r.resolution),void 0!==r.rotation&&this.setRotation(r.rotation)}if(e===n)i&&Su(i,!0);else{for(var o=Date.now(),s=this.targetCenter_.slice(),u=this.targetResolution_,h=this.targetRotation_,a=[];e<n;++e){var c=arguments[e],f={start:o,complete:!1,anchor:c.anchor,duration:void 0!==c.duration?c.duration:1e3,easing:c.easing||pu,callback:i};c.center&&(f.sourceCenter=s,f.targetCenter=c.center.slice(),s=f.targetCenter),void 0!==c.zoom?(f.sourceResolution=u,f.targetResolution=this.getResolutionForZoom(c.zoom),u=f.targetResolution):c.resolution&&(f.sourceResolution=u,f.targetResolution=c.resolution,u=f.targetResolution),void 0!==c.rotation&&(f.sourceRotation=h,c=ge(c.rotation-h+Math.PI,2*Math.PI)-Math.PI,f.targetRotation=h+c,h=f.targetRotation),!function(t){if(t.sourceCenter&&t.targetCenter&&!Kr(t.sourceCenter,t.targetCenter))return;return t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation}(f)?o+=f.duration:f.complete=!0,a.push(f)}this.animations_.push(a),this.setHint(fs,1),this.updateAnimations_()}}},{key:"getAnimating",value:function(){return 0<this.hints_[fs]}},{key:"getInteracting",value:function(){return 0<this.hints_[ls]}},{key:"cancelAnimations",value:function(){var t;this.setHint(fs,-this.hints_[fs]);for(var i=0,n=this.animations_.length;i<n;++i){var e=this.animations_[i];if(e[0].callback&&Su(e[0].callback,!1),!t)for(var r=0,o=e.length;r<o;++r){var s=e[r];if(!s.complete){t=s.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}},{key:"updateAnimations_",value:function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),i=!1,n=this.animations_.length-1;0<=n;--n){for(var e,r=this.animations_[n],o=!0,s=0,u=r.length;s<u;++s){var h=r[s];if(!h.complete){var a,c,f,l,v=t-h.start,v=0<h.duration?v/h.duration:1,v=(1<=v?(h.complete=!0,v=1):o=!1,h.easing(v));if(h.sourceCenter&&(c=h.sourceCenter[0],l=h.sourceCenter[1],a=h.targetCenter[0],f=h.targetCenter[1],this.nextCenter_=h.targetCenter,this.targetCenter_=[c+v*(a-c),l+v*(f-l)]),h.sourceResolution&&h.targetResolution&&(a=1===v?h.targetResolution:h.sourceResolution+v*(h.targetResolution-h.sourceResolution),h.anchor&&(c=this.getViewportSize_(this.getRotation()),f=this.constraints_.resolution(a,0,c,!0),this.targetCenter_=this.calculateCenterZoom(f,h.anchor)),this.nextResolution_=h.targetResolution,this.targetResolution_=a,this.applyTargetState_(!0)),void 0!==h.sourceRotation&&void 0!==h.targetRotation&&(l=1===v?ge(h.targetRotation+Math.PI,2*Math.PI)-Math.PI:h.sourceRotation+v*(h.targetRotation-h.sourceRotation),h.anchor&&(v=this.constraints_.rotation(l,!0),this.targetCenter_=this.calculateCenterRotate(v,h.anchor)),this.nextRotation_=h.targetRotation,this.targetRotation_=l),this.applyTargetState_(!0),i=!0,!h.complete)break}}o&&(this.animations_[n]=null,this.setHint(fs,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN,e=r[0].callback)&&Su(e,!0)}this.animations_=this.animations_.filter(Boolean),i&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}}},{key:"calculateCenterRotate",value:function(t,i){var n,e,r,o=this.getCenterInternal();return void 0!==o&&(n=[o[0]-i[0],o[1]-i[1]],o=n,t=t-this.getRotation(),e=Math.cos(t),t=Math.sin(t),r=o[0]*e-o[1]*t,e=o[1]*e+o[0]*t,o[0]=r,o[1]=e,t=i,(r=n)[0]+=+t[0],r[1]+=+t[1]),n}},{key:"calculateCenterZoom",value:function(t,i){var n,e=this.getCenterInternal(),r=this.getResolution();return n=void 0!==e&&void 0!==r?[i[0]-t*(i[0]-e[0])/r,i[1]-t*(i[1]-e[1])/r]:n}},{key:"getViewportSize_",value:function(t){var i,n,e=this.viewportSize_;return t?(i=e[0],n=e[1],[Math.abs(i*Math.cos(t))+Math.abs(n*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(n*Math.cos(t))]):e}},{key:"setViewportSize",value:function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}},{key:"getCenter",value:function(){var t=this.getCenterInternal();return t&&uu(t,this.getProjection())}},{key:"getCenterInternal",value:function(){return this.get(vs.CENTER)}},{key:"getConstraints",value:function(){return this.constraints_}},{key:"getConstrainResolution",value:function(){return this.get("constrainResolution")}},{key:"getHints",value:function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}},{key:"calculateExtent",value:function(t){var i,t=this.calculateExtentInternal(t);return t=t,i=this.getProjection(),su?nu(t,i,su):t}},{key:"calculateExtentInternal",value:function(t){var t=t||this.getViewportSizeMinusPadding_(),i=this.getCenterInternal(),n=(v(i,1),this.getResolution()),e=(v(void 0!==n,2),this.getRotation());return v(void 0!==e,3),ue(i,n,e,t)}},{key:"getMaxResolution",value:function(){return this.maxResolution_}},{key:"getMinResolution",value:function(){return this.minResolution_}},{key:"getMaxZoom",value:function(){return this.getZoomForResolution(this.minResolution_)}},{key:"setMaxZoom",value:function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}},{key:"getMinZoom",value:function(){return this.getZoomForResolution(this.maxResolution_)}},{key:"setMinZoom",value:function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}},{key:"setConstrainResolution",value:function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}},{key:"getProjection",value:function(){return this.projection_}},{key:"getResolution",value:function(){return this.get(vs.RESOLUTION)}},{key:"getResolutions",value:function(){return this.resolutions_}},{key:"getResolutionForExtent",value:function(t,i){return this.getResolutionForExtentInternal(au(t,this.getProjection()),i)}},{key:"getResolutionForExtentInternal",value:function(t,i){var i=i||this.getViewportSizeMinusPadding_(),n=le(t)/i[0],t=he(t)/i[1];return Math.max(n,t)}},{key:"getResolutionForValueFunction",value:function(t){var i=t||2,n=this.getConstrainedResolution(this.maxResolution_),t=this.minResolution_,e=Math.log(n/t)/Math.log(i);return function(t){return n/Math.pow(i,t*e)}}},{key:"getRotation",value:function(){return this.get(vs.ROTATION)}},{key:"getValueForResolutionFunction",value:function(t){var i=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),t=this.minResolution_,e=Math.log(n/t)/i;return function(t){return Math.log(n/t)/i/e}}},{key:"getViewportSizeMinusPadding_",value:function(t){var t=this.getViewportSize_(t),i=this.padding_;return t=i?[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]:t}},{key:"getState",value:function(){var t,i=this.getProjection(),n=this.getResolution(),e=this.getRotation(),r=this.getCenterInternal(),o=this.padding_;return o&&(t=this.getViewportSizeMinusPadding_(),r=Ou(r,this.getViewportSize_(),[t[0]/2+o[3],t[1]/2+o[0]],n,e)),{center:r.slice(0),projection:void 0!==i?i:null,resolution:n,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:e,zoom:this.getZoom()}}},{key:"getZoom",value:function(){var t,i=this.getResolution();return t=void 0!==i?this.getZoomForResolution(i):t}},{key:"getZoomForResolution",value:function(t){var i,n,e=this.minZoom_||0;return n=this.resolutions_?(n=En(this.resolutions_,t,1),i=this.resolutions_[e=n],n==this.resolutions_.length-1?2:i/this.resolutions_[n+1]):(i=this.maxResolution_,this.zoomFactor_),e+Math.log(i/t)/Math.log(n)}},{key:"getResolutionForZoom",value:function(t){var i,n;return this.resolutions_?this.resolutions_.length<=1?0:(i=be(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[i]/this.resolutions_[i+1],this.resolutions_[i]/Math.pow(n,be(t-i,0,1))):this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}},{key:"fit",value:function(t,i){this.fitInternal(t,i)}},{key:"rotatedExtentForGeometry",value:function(t){for(var i=this.getRotation(),n=Math.cos(i),e=Math.sin(-i),r=t.getFlatCoordinates(),o=t.getStride(),s=1/0,u=1/0,h=-1/0,a=-1/0,c=0,f=r.length;c<f;c+=o)var l=r[c]*n-r[c+1]*e,v=r[c]*e+r[c+1]*n,s=Math.min(s,l),u=Math.min(u,v),h=Math.max(h,l),a=Math.max(a,v);return[s,u,h,a]}},{key:"fitInternal",value:function(t,i){var i=i||{},n=(n=i.size)||this.getViewportSizeMinusPadding_(),e=void 0!==i.padding?i.padding:[0,0,0,0],r=void 0!==i.nearest&&i.nearest,o=void 0!==i.minResolution?i.minResolution:void 0!==i.maxZoom?this.getResolutionForZoom(i.maxZoom):0,t=this.rotatedExtentForGeometry(t),n=this.getResolutionForExtentInternal(t,[n[0]-e[1]-e[3],n[1]-e[0]-e[2]]),n=isNaN(n)?o:Math.max(n,o),o=(n=this.getConstrainedResolution(n,r?0:1),this.getRotation()),r=Math.sin(o),o=Math.cos(o),t=se(t),e=(t[0]+=(e[1]-e[3])/2*n,t[1]+=(e[0]-e[2])/2*n,t[0]*o-t[1]*r),o=t[1]*o+t[0]*r,t=this.getConstrainedCenter([e,o],n),r=i.callback||An;void 0!==i.duration?this.animateInternal({resolution:n,center:t,duration:i.duration,easing:i.easing},r):(this.targetResolution_=n,this.targetCenter_=t,this.applyTargetState_(!1,!0),Su(r,!0))}},{key:"centerOn",value:function(t,i,n){this.centerOnInternal(hu(t,this.getProjection()),i,n)}},{key:"centerOnInternal",value:function(t,i,n){this.setCenterInternal(Ou(t,i,n,this.getResolution(),this.getRotation()))}},{key:"calculateCenterShift",value:function(t,i,n,e){var r,o=this.padding_;return o&&t&&(e=Ou(t,e,[(e=this.getViewportSizeMinusPadding_(-n))[0]/2+o[3],e[1]/2+o[0]],i,n),r=[t[0]-e[0],t[1]-e[1]]),r}},{key:"isDef",value:function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}},{key:"adjustCenter",value:function(t){var i=uu(this.targetCenter_,this.getProjection());this.setCenter([i[0]+t[0],i[1]+t[1]])}},{key:"adjustCenterInternal",value:function(t){var i=this.targetCenter_;this.setCenterInternal([i[0]+t[0],i[1]+t[1]])}},{key:"adjustResolution",value:function(t,i){i=i&&hu(i,this.getProjection());this.adjustResolutionInternal(t,i)}},{key:"adjustResolutionInternal",value:function(t,i){var n=this.getAnimating()||this.getInteracting(),e=this.getViewportSize_(this.getRotation()),e=this.constraints_.resolution(this.targetResolution_*t,0,e,n);i&&(this.targetCenter_=this.calculateCenterZoom(e,i)),this.targetResolution_*=t,this.applyTargetState_()}},{key:"adjustZoom",value:function(t,i){this.adjustResolution(Math.pow(this.zoomFactor_,-t),i)}},{key:"adjustRotation",value:function(t,i){i=i&&hu(i,this.getProjection()),this.adjustRotationInternal(t,i)}},{key:"adjustRotationInternal",value:function(t,i){var n=this.getAnimating()||this.getInteracting(),n=this.constraints_.rotation(this.targetRotation_+t,n);i&&(this.targetCenter_=this.calculateCenterRotate(n,i)),this.targetRotation_+=t,this.applyTargetState_()}},{key:"setCenter",value:function(t){this.setCenterInternal(t&&hu(t,this.getProjection()))}},{key:"setCenterInternal",value:function(t){this.targetCenter_=t,this.applyTargetState_()}},{key:"setHint",value:function(t,i){return this.hints_[t]+=i,this.changed(),this.hints_[t]}},{key:"setResolution",value:function(t){this.targetResolution_=t,this.applyTargetState_()}},{key:"setRotation",value:function(t){this.targetRotation_=t,this.applyTargetState_()}},{key:"setZoom",value:function(t){this.setResolution(this.getResolutionForZoom(t))}},{key:"applyTargetState_",value:function(t,i){var i=this.getAnimating()||this.getInteracting()||i,n=this.constraints_.rotation(this.targetRotation_,i),e=this.getViewportSize_(n),r=this.constraints_.resolution(this.targetResolution_,0,e,i),i=this.constraints_.center(this.targetCenter_,r,e,i,this.calculateCenterShift(this.targetCenter_,r,n,e));this.get(vs.ROTATION)!==n&&this.set(vs.ROTATION,n),this.get(vs.RESOLUTION)!==r&&(this.set(vs.RESOLUTION,r),this.set("zoom",this.getZoom(),!0)),i&&this.get(vs.CENTER)&&Kr(this.get(vs.CENTER),i)||this.set(vs.CENTER,i),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}},{key:"resolveConstraints",value:function(t,i,n){var t=void 0!==t?t:200,i=i||0,e=this.constraints_.rotation(this.targetRotation_),r=this.getViewportSize_(e),i=this.constraints_.resolution(this.targetResolution_,i,r),r=this.constraints_.center(this.targetCenter_,i,r,!1,this.calculateCenterShift(this.targetCenter_,i,e,r));0!==t||this.cancelAnchor_?(n=n||(0===t?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===i&&this.getRotation()===e&&this.getCenterInternal()&&Kr(this.getCenterInternal(),r)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:e,center:r,resolution:i,duration:t,easing:bu,anchor:n}))):(this.targetResolution_=i,this.targetRotation_=e,this.targetCenter_=r,this.applyTargetState_())}},{key:"beginInteraction",value:function(){this.resolveConstraints(0),this.setHint(ls,1)}},{key:"endInteraction",value:function(t,i,n){n=n&&hu(n,this.getProjection());this.endInteractionInternal(t,i,n)}},{key:"endInteractionInternal",value:function(t,i,n){this.setHint(ls,-1),this.resolveConstraints(t,i,n)}},{key:"getConstrainedCenter",value:function(t,i){var n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,i||this.getResolution(),n)}},{key:"getConstrainedZoom",value:function(t,i){t=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(t,i))}},{key:"getConstrainedResolution",value:function(t,i){var i=i||0,n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,i,n)}}])&&wu(t.prototype,i),n&&wu(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function ku(t,i){return Array.isArray(t)?t:(void 0===i?i=[t,t]:(i[0]=t,i[1]=t),i)}function Tu(t){return(Tu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ru(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Tu(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Tu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Tu(t)?t:String(t)}(e.key),e)}}function Au(){return(Au="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,n){var e=function(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=Lu(t)););return t}(t,i);if(e)return(e=Object.getOwnPropertyDescriptor(e,i)).get?e.get.call(arguments.length<3?t:n):e.value}).apply(this,arguments)}function xu(t,i){return(xu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function Pu(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Lu(n),i=(t=e?(t=Lu(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===Tu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Cu(i)}}function Cu(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Lu(t){return(Lu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Iu(t){t instanceof Yr?t.setMapInternal(null):t instanceof Bo&&t.getLayers().forEach(Iu)}var Nu=function(){var t=u,i=mr;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&xu(t,i);var n,s=Pu(u);function u(t){var i;if(!(this instanceof u))throw new TypeError("Cannot call a class as a function");(i=s.call(this)).on,i.once,i.size_=t.size,void 0===i.size_&&(i.size_=[2e3,2e3]),i.un;e={},r=(n=t).layers&&"function"==typeof n.layers.getLayers?n.layers:new Bo({layers:n.layers}),e[Xo.LAYERGROUP]=r,e[Xo.TARGET]=n.target,e[Xo.VIEW]=n.view instanceof Eu?n.view:new Eu;var n,e,r={values:e},o=(i.renderComplete_,i.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,i.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:Cn,i.postRenderTimeoutHandle_,i.animationDelayKey_,i.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(Cu(i)),i.coordinateToPixelTransform_=qn(),i.pixelToCoordinateTransform_=qn(),i.frameIndex_=0,i.frameState_=null,i.previousExtent_=null,i.viewPropertyListenerKey_=null,i.viewChangeListenerKey_=null,i.layerGroupPropertyListenerKeys_=null,i.moveTolerance_=t.moveTolerance,i.targetChangeHandlerKeys_=null,i.overlayIdIndex_={},i.renderer_=null,i.postRenderFunctions_=[],i.tileQueue_=new hs(i.getTilePriority.bind(Cu(i)),i.handleTileChange_.bind(Cu(i))),i.addChangeListener(Xo.VIEW,i.handleViewChanged_),i.addChangeListener(Xo.TARGET,i.handleTargetChanged_),i.setProperties(r.values),Cu(i));return!t.view||t.view instanceof Eu||t.view.then(function(t){o.setView(new Eu(t))}),i}return t=u,(i=[{key:"createRenderer",value:function(){throw new Error("Use a map type that has a createRenderer method")}},{key:"addLayer",value:function(t){this.getLayerGroup().getLayers().push(t)}},{key:"handleLayerAdd_",value:function(t){!function t(i,n){if(i instanceof Yr)i.setMapInternal(n);else if(i instanceof Bo)for(var e=i.getLayers().getArray(),r=0,o=e.length;r<o;++r)t(e[r],n)}(t.layer,this)}},{key:"addOverlay",value:function(t){this.getOverlays().push(t)}},{key:"addOverlayInternal_",value:function(t){var i=t.getId();void 0!==i&&(this.overlayIdIndex_[i.toString()]=t),t.setMap(this)}},{key:"disposeInternal",value:function(){this.setTarget(null),Au(Lu(u.prototype),"disposeInternal",this).call(this)}},{key:"getAllLayers",value:function(){var n=[];return function i(t){t.forEach(function(t){t instanceof Bo?i(t.getLayers()):n.push(t)})}(this.getLayers()),n}},{key:"getTarget",value:function(){return this.get(Xo.TARGET)}},{key:"getOverlays",value:function(){return this.overlays_}},{key:"getOverlayById",value:function(t){t=this.overlayIdIndex_[t.toString()];return void 0!==t?t:null}},{key:"getLayerGroup",value:function(){return this.get(Xo.LAYERGROUP)}},{key:"setLayers",value:function(t){var i=this.getLayerGroup();t instanceof Eo?i.setLayers(t):((i=i.getLayers()).clear(),i.extend(t))}},{key:"getLayers",value:function(){return this.getLayerGroup().getLayers()}},{key:"getLoadingOrNotReady",value:function(){for(var t=this.getLayerGroup().getLayerStatesArray(),i=0,n=t.length;i<n;++i){var e=t[i].layer;if(!e.getRenderer().ready)return!0;e=e.getSource();if(e&&e.loading)return!0}return!1}},{key:"getRenderer",value:function(){return this.renderer_}},{key:"getSize",value:function(){return this.size_}},{key:"getView",value:function(){return this.get(Xo.VIEW)}},{key:"getOverlayContainer",value:function(){return this.overlayContainer_}},{key:"getOverlayContainerStopEvent",value:function(){return this.overlayContainerStopEvent_}},{key:"getTilePriority",value:function(t,i,n,e){return r=this.frameState_,t=t,i=i,n=n,e=e,r&&i in r.wantedTiles&&r.wantedTiles[i][t.getKey()]?(i=r.viewState.center,t=n[0]-i[0],r=n[1]-i[1],65536*Math.log(e)+Math.sqrt(t*t+r*r)/e):1/0;var r}},{key:"handlePostRender",value:function(){for(var t,i,n,e=this.frameState_,r=this.tileQueue_,o=(r.isEmpty()||(n=i=this.maxTilesLoading_,e&&((t=e.viewHints)[fs]||t[ls])&&(i=(t=8<Date.now()-e.time)?0:8,n=t?0:2),r.getTilesLoading()<i&&(r.reprioritize(),r.loadMoreTiles(i,n))),e&&this.hasListener(_r)&&!e.animate&&this.renderComplete_&&this.renderer_.dispatchRenderEvent(_r,e),this.postRenderFunctions_),s=0,u=o.length;s<u;++s)o[s](this,e);o.length=0}},{key:"handleTargetChanged_",value:function(){this.renderer_||(this.renderer_=this.createRenderer()),this.targetChangeHandlerKeys_=[b(document,Je,this.updateSize,this)],this.updateSize()}},{key:"handleTileChange_",value:function(){this.render()}},{key:"handleViewPropertyChanged_",value:function(){this.render()}},{key:"handleViewChanged_",value:function(){this.viewPropertyListenerKey_&&(ir(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(ir(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=b(t,He,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=b(t,Ke,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}},{key:"isRendered",value:function(){return!!this.frameState_}},{key:"render",value:function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}},{key:"removeLayer",value:function(t){return this.getLayerGroup().getLayers().remove(t)}},{key:"handleLayerRemove_",value:function(t){Iu(t.layer)}},{key:"removeOverlay",value:function(t){return this.getOverlays().remove(t)}},{key:"renderFrame_",value:function(t){var i,n=this,e=this.getSize(),r=this.getView(),o=this.frameState_,s=null;void 0!==e&&0<(i=e)[0]&&0<i[1]&&r&&r.isDef()&&(i=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),r=r.getState(),s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:ue(r.center,r.resolution,r.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:r,viewHints:i,wantedTiles:{},mapId:Pn(this),renderTargets:{}},r.nextCenter)&&r.nextResolution&&(t=isNaN(r.nextRotation)?r.rotation:r.nextRotation,s.nextExtent=ue(r.nextCenter,r.nextResolution,t,e)),this.frameState_=s,this.renderer_.renderFrame(s),!s||(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),!o||this.previousExtent_&&(ye(this.previousExtent_)||ne(s.extent,this.previousExtent_))||(this.dispatchEvent(new Go(qo,this,o)),this.previousExtent_=ie(this.previousExtent_)),!this.previousExtent_)||s.viewHints[fs]||s.viewHints[ls]||ne(s.extent,this.previousExtent_)||(this.dispatchEvent(new Go(zo,this,s)),i=s.extent,(r=this.previousExtent_)?(r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3]):i.slice()),this.dispatchEvent(new Go(Vo,this,s)),this.renderComplete_=!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(function(){n.postRenderTimeoutHandle_=void 0,n.handlePostRender()},0))}},{key:"setSize",value:function(t){this.set(Xo.SIZE,t)}},{key:"setTarget",value:function(t){this.set(Xo.TARGET,t)}},{key:"setView",value:function(t){var i;!t||t instanceof Eu?this.set(Xo.VIEW,t):(this.set(Xo.VIEW,new Eu),i=this,t.then(function(t){i.setView(new Eu(t))}))}},{key:"updateSize",value:function(){var t=this.size_;this.setSize(t),this.updateViewportSize_()}},{key:"updateViewportSize_",value:function(){var t,i=this.getView();i&&(t=this.size_,i.setViewportSize(t))}}])&&Ru(t.prototype,i),n&&Ru(t,n),Object.defineProperty(t,"prototype",{writable:!1}),u}();function Bu(t){return(Bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Du(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Bu(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Bu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Bu(t)?t:String(t)}(e.key),e)}}function Fu(t,i){return(Fu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function _u(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Hu(n),i=(t=e?(t=Hu(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===Bu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Hu(t){return(Hu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Uu=function(){var t=r,i=Nu;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&Fu(t,i);var n,e=_u(r);function r(t){if(this instanceof r)return t=Ue({},t),e.call(this,t);throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"createRenderer",value:function(){return new fo(this)}}])&&Du(t.prototype,i),n&&Du(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function Gu(t){return(Gu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vu(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Gu(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Gu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Gu(t)?t:String(t)}(e.key),e)}}function qu(t,i){return(qu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function zu(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Xu(n),i=(t=e?(t=Xu(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===Gu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Xu(t){return(Xu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Zu=function(){var t=o,i=Ye;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&qu(t,i);var n,r=zu(o);function o(t,i,n){var e;if(this instanceof o)return n=n||{},(e=r.call(this)).tileCoord=t,e.state=i,e.interimTile=null,e.key="",e.transition_=void 0===n.transition?250:n.transition,e.transitionStarts_={},e.interpolate=!!n.interpolate,e;throw new TypeError("Cannot call a class as a function")}return t=o,(i=[{key:"changed",value:function(){this.dispatchEvent(Ke)}},{key:"release",value:function(){}},{key:"getKey",value:function(){return this.key+"/"+this.tileCoord}},{key:"getInterimTile",value:function(){if(this.interimTile){var t=this.interimTile;do{if(t.getState()==$o)return this.transition_=0,t}while(t=t.interimTile)}return this}},{key:"refreshInterimChain",value:function(){if(this.interimTile){var t=this.interimTile,i=this;do{if(t.getState()==$o){t.interimTile=null;break}}while(t.getState()!=Qo&&t.getState()==Ko?i.interimTile=t.interimTile:i=t,t=i.interimTile)}}},{key:"getTileCoord",value:function(){return this.tileCoord}},{key:"getState",value:function(){return this.state}},{key:"setState",value:function(t){if(this.state!==Jo&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}},{key:"load",value:function(){l()}},{key:"getAlpha",value:function(t,i){if(!this.transition_)return 1;var n=this.transitionStarts_[t];if(n){if(-1===n)return 1}else this.transitionStarts_[t]=n=i;t=i-n+1e3/60;return t>=this.transition_?1:du(t/this.transition_)}},{key:"inTransition",value:function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}},{key:"endTransition",value:function(t){this.transition_&&(this.transitionStarts_[t]=-1)}}])&&Vu(t.prototype,i),n&&Vu(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}();var Wu=0,Yu=2,Ku=3;function Qu(t,i,n){var e=!0,r=!1,o=!1,s=[tr(t,$e,function(){o=!0,r||i()})];return t.src&&In?(r=!0,t.decode().then(function(){e&&i()}).catch(function(t){e&&(o?i:n)()})):s.push(tr(t,Qe,n)),function(){e=!1,s.forEach(ir)}}function $u(t){return($u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ju(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==$u(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==$u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===$u(t)?t:String(t)}(e.key),e)}}function th(t,i){return(th=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function ih(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=nh(n),i=(t=e?(t=nh(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===$u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function nh(t){return(nh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var eh=function(){var t=u,i=Zu;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&th(t,i);var n,s=ih(u);function u(t,i,n,e,r,o){if(this instanceof u)return(t=s.call(this,t,i,o)).crossOrigin_=e,t.src_=n,t.key=n,t.image_=new Image,null!==e&&(t.image_.crossOrigin=e),t.unlisten_=null,t.tileLoadFunction_=r,t;throw new TypeError("Cannot call a class as a function")}return t=u,(i=[{key:"getImage",value:function(){return this.image_}},{key:"setImage",value:function(t){this.image_=t,this.state=$o,this.unlistenImage_(),this.changed()}},{key:"handleImageError_",value:function(){this.state=Jo,this.unlistenImage_(),this.image_=getBlankImage(),this.changed()}},{key:"handleImageLoad_",value:function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=$o:this.state=ts,this.unlistenImage_(),this.changed()}},{key:"load",value:function(){this.state==Jo&&(this.state=Ko,this.image_=new Image,null!==this.crossOrigin_)&&(this.image_.crossOrigin=this.crossOrigin_),this.state==Ko&&(this.state=Qo,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=Qu(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}},{key:"unlistenImage_",value:function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}])&&Ju(t.prototype,i),n&&Ju(t,n),Object.defineProperty(t,"prototype",{writable:!1}),u}();function rh(t){return(rh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oh(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==rh(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==rh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===rh(t)?t:String(t)}(e.key),e)}}var sh=function(){function i(t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}var t,n,e;return t=i,(n=[{key:"canExpireCache",value:function(){return 0<this.highWaterMark&&this.getCount()>this.highWaterMark}},{key:"expireCache",value:function(t){for(;this.canExpireCache();)this.pop()}},{key:"clear",value:function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}},{key:"containsKey",value:function(t){return this.entries_.hasOwnProperty(t)}},{key:"forEach",value:function(t){for(var i=this.oldest_;i;)t(i.value_,i.key_,this),i=i.newer}},{key:"get",value:function(t,i){t=this.entries_[t];return v(void 0!==t,15),t!==this.newest_&&(t===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(t.newer.older=t.older,t.older.newer=t.newer),t.newer=null,t.older=this.newest_,this.newest_.newer=t,this.newest_=t),t.value_}},{key:"remove",value:function(t){var i=this.entries_[t];return v(void 0!==i,15),i===this.newest_?(this.newest_=i.older,this.newest_&&(this.newest_.newer=null)):i===this.oldest_?(this.oldest_=i.newer,this.oldest_&&(this.oldest_.older=null)):(i.newer.older=i.older,i.older.newer=i.newer),delete this.entries_[t],--this.count_,i.value_}},{key:"getCount",value:function(){return this.count_}},{key:"getKeys",value:function(){for(var t=new Array(this.count_),i=0,n=this.newest_;n;n=n.older)t[i++]=n.key_;return t}},{key:"getValues",value:function(){for(var t=new Array(this.count_),i=0,n=this.newest_;n;n=n.older)t[i++]=n.value_;return t}},{key:"peekLast",value:function(){return this.oldest_.value_}},{key:"peekLastKey",value:function(){return this.oldest_.key_}},{key:"peekFirstKey",value:function(){return this.newest_.key_}},{key:"pop",value:function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}},{key:"replace",value:function(t,i){this.get(t),this.entries_[t].value_=i}},{key:"set",value:function(t,i){v(!(t in this.entries_),16);i={key_:t,newer:null,older:this.newest_,value_:i};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_}},{key:"setSize",value:function(t){this.highWaterMark=t}}])&&oh(t.prototype,n),e&&oh(t,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function uh(t,i,n,e){return void 0!==e?(e[0]=t,e[1]=i,e[2]=n,e):[t,i,n]}function hh(t,i,n){return t+"/"+i+"/"+n}function ah(t){return(ah="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ch(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==ah(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==ah(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===ah(t)?t:String(t)}(e.key),e)}}function fh(t,i){return(fh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function lh(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=vh(n),i=(t=e?(t=vh(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===ah(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function vh(t){return(vh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var yh=function(){var t=r,i=sh;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&fh(t,i);var n,e=lh(r);function r(){var t=this,i=r;if(t instanceof i)return e.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"expireCache",value:function(t){for(;this.canExpireCache();){if(this.peekLast().getKey()in t)break;this.pop().release()}}},{key:"pruneExceptNewestZ",value:function(){var n;0!==this.getCount()&&(n=this.peekFirstKey().split("/").map(Number)[0],this.forEach(function(t){var i;t.tileCoord[0]!==n&&(this.remove(hh((i=t.tileCoord)[0],i[1],i[2])),t.release())}.bind(this)))}}])&&ch(t.prototype,i),n&&ch(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}(),dh="tileloadstart",bh="tileloadend",ph="tileloaderror";function mh(t){return(mh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wh(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==mh(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==mh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===mh(t)?t:String(t)}(e.key),e)}}function gh(t,i){return(gh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function jh(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Sh(n),i=(t=e?(t=Sh(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===mh(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Mh(i)}}function Mh(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Sh(t){return(Sh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oh(i){return i?Array.isArray(i)?function(t){return i}:"function"==typeof i?i:function(t){return[i]}:null}var Eh=function(){var t=r,i=mr;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&gh(t,i);var n,e=jh(r);function r(t){var i;if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");(i=e.call(this)).projection=Ys(t.projection),i.attributions_=Oh(t.attributions),i.attributionsCollapsible_=void 0===t.attributionsCollapsible||t.attributionsCollapsible,i.loading=!1,i.state_=void 0!==t.state?t.state:Ur,i.wrapX_=void 0!==t.wrapX&&t.wrapX,i.interpolate_=!!t.interpolate,i.viewResolver=null,i.viewRejector=null;var n=Mh(i);return i.viewPromise_=new Promise(function(t,i){n.viewResolver=t,n.viewRejector=i}),i}return t=r,(i=[{key:"getAttributions",value:function(){return this.attributions_}},{key:"getAttributionsCollapsible",value:function(){return this.attributionsCollapsible_}},{key:"getProjection",value:function(){return this.projection}},{key:"getResolutions",value:function(){return l()}},{key:"getView",value:function(){return this.viewPromise_}},{key:"getState",value:function(){return this.state_}},{key:"getWrapX",value:function(){return this.wrapX_}},{key:"getInterpolate",value:function(){return this.interpolate_}},{key:"refresh",value:function(){this.changed()}},{key:"setAttributions",value:function(t){this.attributions_=Oh(t),this.changed()}},{key:"setState",value:function(t){this.state_=t,this.changed()}}])&&wh(t.prototype,i),n&&wh(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function kh(t){return(kh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Th(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==kh(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==kh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===kh(t)?t:String(t)}(e.key),e)}}var Rh=function(){function r(t,i,n,e){if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");this.minX=t,this.maxX=i,this.minY=n,this.maxY=e}var t,i,n;return t=r,(i=[{key:"contains",value:function(t){return this.containsXY(t[1],t[2])}},{key:"containsTileRange",value:function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}},{key:"containsXY",value:function(t,i){return this.minX<=t&&t<=this.maxX&&this.minY<=i&&i<=this.maxY}},{key:"equals",value:function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}},{key:"extend",value:function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}},{key:"getHeight",value:function(){return this.maxY-this.minY+1}},{key:"getSize",value:function(){return[this.getWidth(),this.getHeight()]}},{key:"getWidth",value:function(){return this.maxX-this.minX+1}},{key:"intersects",value:function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}])&&Th(t.prototype,i),n&&Th(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function Ah(t,i,n,e,r){return void 0!==r?(r.minX=t,r.maxX=i,r.minY=n,r.maxY=e,r):new Rh(t,i,n,e)}var xh=Rh;function Ph(t){return(Ph="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ch(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Ph(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Ph(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Ph(t)?t:String(t)}(e.key),e)}}var Lh=[0,0,0],Ih=function(){function h(t){var n,e,r,i;if(!(this instanceof h))throw new TypeError("Cannot call a class as a function");if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,v((n=this.resolutions_,e=!0,r=function(t,i){return i-t}||On,n.every(function(t,i){return 0===i||!(0<(i=r(n[i-1],t))||e&&0===i)})),17),!t.origins)for(var o=0,s=this.resolutions_.length-1;o<s;++o)if(i){if(this.resolutions_[o]/this.resolutions_[o+1]!==i){i=void 0;break}}else i=this.resolutions_[o]/this.resolutions_[o+1];this.zoomFactor_=i,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,v(this.origins_.length==this.resolutions_.length,20));var u=t.extent;void 0===u||this.origin_||this.origins_||(this.origin_=ce(u)),v(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,v(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:ds,v(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==u?u:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(function(t,i){t=new xh(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));return u&&(i=this.getTileRangeForExtentAndZ(u,i),t.minX=Math.max(i.minX,t.minX),t.maxX=Math.min(i.maxX,t.maxX),t.minY=Math.max(i.minY,t.minY),t.maxY=Math.min(i.maxY,t.maxY)),t},this):u&&this.calculateTileRanges_(u)}var t,i,n;return t=h,(i=[{key:"forEachTileCoord",value:function(t,i,n){for(var e=this.getTileRangeForExtentAndZ(t,i),r=e.minX,o=e.maxX;r<=o;++r)for(var s=e.minY,u=e.maxY;s<=u;++s)n([i,r,s])}},{key:"forEachTileCoordParentTileRange",value:function(t,i,n,e){var r,o,s=null,u=t[0]-1;for(2===this.zoomFactor_?(r=t[1],o=t[2]):s=this.getTileCoordExtent(t,e);u>=this.minZoom;){if(i(u,2===this.zoomFactor_?Ah(r=Math.floor(r/2),r,o=Math.floor(o/2),o,n):this.getTileRangeForExtentAndZ(s,u,n)))return!0;--u}return!1}},{key:"getExtent",value:function(){return this.extent_}},{key:"getMaxZoom",value:function(){return this.maxZoom}},{key:"getMinZoom",value:function(){return this.minZoom}},{key:"getOrigin",value:function(t){return this.origin_||this.origins_[t]}},{key:"getResolution",value:function(t){return this.resolutions_[t]}},{key:"getResolutions",value:function(){return this.resolutions_}},{key:"getTileCoordChildTileRange",value:function(t,i,n){var e;return t[0]<this.maxZoom?2===this.zoomFactor_?Ah(e=2*t[1],1+e,e=2*t[2],1+e,i):(e=this.getTileCoordExtent(t,n||this.tmpExtent_),this.getTileRangeForExtentAndZ(e,t[0]+1,i)):null}},{key:"getTileRangeForTileCoordAndZ",value:function(t,i,n){var e,r,o,s,u,h;return i>this.maxZoom||i<this.minZoom?null:(h=t[0],e=t[1],r=t[2],i===h?Ah(e,r,e,r,n):this.zoomFactor_?(o=Math.pow(this.zoomFactor_,i-h),s=Math.floor(e*o),u=Math.floor(r*o),i<h?Ah(s,s,u,u,n):Ah(s,Math.floor(o*(e+1))-1,u,Math.floor(o*(r+1))-1,n)):(h=this.getTileCoordExtent(t,this.tmpExtent_),this.getTileRangeForExtentAndZ(h,i,n)))}},{key:"getTileRangeExtent",value:function(t,i,n){var e=this.getOrigin(t),r=this.getResolution(t),t=ku(this.getTileSize(t),this.tmpSize_),o=e[0]+i.minX*t[0]*r,s=e[0]+(i.maxX+1)*t[0]*r;return te(o,e[1]+i.minY*t[1]*r,s,e[1]+(i.maxY+1)*t[1]*r,n)}},{key:"getTileRangeForExtentAndZ",value:function(t,i,n){var e=Lh,r=(this.getTileCoordForXYAndZ_(t[0],t[3],i,!1,e),e[1]),o=e[2];return this.getTileCoordForXYAndZ_(t[2],t[1],i,!0,e),Ah(r,e[1],o,e[2],n)}},{key:"getTileCoordCenter",value:function(t){var i=this.getOrigin(t[0]),n=this.getResolution(t[0]),e=ku(this.getTileSize(t[0]),this.tmpSize_);return[i[0]+(t[1]+.5)*e[0]*n,i[1]-(t[2]+.5)*e[1]*n]}},{key:"getTileCoordExtent",value:function(t,i){var n=this.getOrigin(t[0]),e=this.getResolution(t[0]),r=ku(this.getTileSize(t[0]),this.tmpSize_),o=n[0]+t[1]*r[0]*e,n=n[1]-(t[2]+1)*r[1]*e;return te(o,n,o+r[0]*e,n+r[1]*e,i)}},{key:"getTileCoordForCoordAndResolution",value:function(t,i,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],i,!1,n)}},{key:"getTileCoordForXYAndResolution_",value:function(t,i,n,e,r){var o=this.getZForResolution(n),s=n/this.getResolution(o),u=this.getOrigin(o),h=ku(this.getTileSize(o),this.tmpSize_),t=s*(t-u[0])/n/h[0],s=s*(u[1]-i)/n/h[1],s=e?(t=Se(t,5)-1,Se(s,5)-1):(t=Me(t,5),Me(s,5));return uh(o,t,s,r)}},{key:"getTileCoordForXYAndZ_",value:function(t,i,n,e,r){var o=this.getOrigin(n),s=this.getResolution(n),u=ku(this.getTileSize(n),this.tmpSize_),t=(t-o[0])/s/u[0],o=(o[1]-i)/s/u[1],o=e?(t=Se(t,5)-1,Se(o,5)-1):(t=Me(t,5),Me(o,5));return uh(n,t,o,r)}},{key:"getTileCoordForCoordAndZ",value:function(t,i,n){return this.getTileCoordForXYAndZ_(t[0],t[1],i,!1,n)}},{key:"getTileCoordResolution",value:function(t){return this.resolutions_[t[0]]}},{key:"getTileSize",value:function(t){return this.tileSize_||this.tileSizes_[t]}},{key:"getFullTileRange",value:function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}},{key:"getZForResolution",value:function(t,i){return be(En(this.resolutions_,t,i||0),this.minZoom,this.maxZoom)}},{key:"calculateTileRanges_",value:function(t){for(var i=this.resolutions_.length,n=new Array(i),e=this.minZoom;e<i;++e)n[e]=this.getTileRangeForExtentAndZ(t,e);this.fullTileRanges_=n}}])&&Ch(t.prototype,i),n&&Ch(t,n),Object.defineProperty(t,"prototype",{writable:!1}),h}();function Nh(t){var i,n,e,r=t.getDefaultTileGrid();return r||(r=function(t,i,n,e){e=void 0!==e?e:Wn.TOP_LEFT,i=Bh(t,i,n);return new Ih({extent:t,origin:function(t,i){var n;return i===Wn.BOTTOM_LEFT?n=re(t):i===Wn.BOTTOM_RIGHT?n=oe(t):i===Wn.TOP_LEFT?n=ce(t):i===Wn.TOP_RIGHT?n=fe(t):v(!1,13),n}(t,e),resolutions:i,tileSize:n})}(Dh(t),i,n,e),t.setDefaultTileGrid(r)),r}function Bh(t,i,n,e){for(var i=void 0!==i?i:ys,r=he(t),t=le(t),n=ku(void 0!==n?n:ds),o=0<e?e:Math.max(t/n[0],r/n[1]),s=i+1,u=new Array(s),h=0;h<s;++h)u[h]=o/Math.pow(2,h);return u}function Dh(t){var i=(t=Ys(t)).getExtent();return i=i?i:te(-(t=180*as[cs.DEGREES]/t.getMetersPerUnit()),-t,t,t)}function Fh(t){return(Fh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _h(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function Hh(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Fh(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Fh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Fh(t)?t:String(t)}(e.key),e)}}function Uh(t,i,n){return i&&Hh(t.prototype,i),n&&Hh(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Gh(){return(Gh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,n){var e=function(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=Xh(t)););return t}(t,i);if(e)return(e=Object.getOwnPropertyDescriptor(e,i)).get?e.get.call(arguments.length<3?t:n):e.value}).apply(this,arguments)}function Vh(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&qh(t,i)}function qh(t,i){return(qh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function zh(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Xh(n),i=(t=e?(t=Xh(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===Fh(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Xh(t){return(Xh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var i=function(){Vh(e,Eh);var n=zh(e);function e(t){var i;_h(this,e),(i=n.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate})).on,i.once,i.un,i.opaque_=void 0!==t.opaque&&t.opaque,i.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,i.tileGrid=void 0!==t.tileGrid?t.tileGrid:null;return i.tileGrid&&ku(i.tileGrid.getTileSize(i.tileGrid.getMinZoom()),[256,256]),i.tileCache=new yh(t.cacheSize||0),i.tmpSize=[0,0],i.key_=t.key||"",i.tileOptions={transition:t.transition,interpolate:t.interpolate},i.zDirection=t.zDirection||0,i}return Uh(e,[{key:"canExpireCache",value:function(){return this.tileCache.canExpireCache()}},{key:"expireCache",value:function(t,i){t=this.getTileCacheForProjection(t);t&&t.expireCache(i)}},{key:"forEachLoadedTile",value:function(t,i,n,e){var r=this.getTileCacheForProjection(t);if(!r)return!1;for(var o,s,u=!0,h=n.minX;h<=n.maxX;++h)for(var a=n.minY;a<=n.maxY;++a)o=hh(i,h,a),s=!1,(s=r.containsKey(o)?(s=(o=r.get(o)).getState()===$o)&&!1!==e(o):s)||(u=!1);return u}},{key:"getGutterForProjection",value:function(t){return 0}},{key:"getKey",value:function(){return this.key_}},{key:"setKey",value:function(t){this.key_!==t&&(this.key_=t,this.changed())}},{key:"getOpaque",value:function(t){return this.opaque_}},{key:"getResolutions",value:function(){return this.tileGrid?this.tileGrid.getResolutions():null}},{key:"getTile",value:function(t,i,n,e,r){return l()}},{key:"getTileGrid",value:function(){return this.tileGrid}},{key:"getTileGridForProjection",value:function(t){return this.tileGrid||Nh(t)}},{key:"getTileCacheForProjection",value:function(t){return v($s(this.getProjection(),t),68),this.tileCache}},{key:"getTilePixelRatio",value:function(t){return this.tilePixelRatio_}},{key:"getTilePixelSize",value:function(t,i,n){var n=this.getTileGridForProjection(n),i=this.getTilePixelRatio(i),n=ku(n.getTileSize(t),this.tmpSize);return 1==i?n:(t=n,n=i,(i=void 0===(i=this.tmpSize)?[0,0]:i)[0]=t[0]*n+.5|0,i[1]=t[1]*n+.5|0,i)}},{key:"getTileCoordForTileUrlFunction",value:function(t,i){var n,e,r,o,i=void 0!==i?i:this.getProjection(),s=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(n=s,i=i,r=(e=t)[0],o=n.getTileCoordCenter(e),t=Kn(i=Dh(i),o)?e:(e=le(i),i=Math.ceil((i[0]-o[0])/e),o[0]+=e*i,n.getTileCoordForCoordAndZ(o,r))),function(t,i){var n=t[0],e=t[1],t=t[2];if(!(i.getMinZoom()>n||n>i.getMaxZoom()))return!(i=i.getFullTileRange(n))||i.containsXY(e,t)}(t,s)?t:null}},{key:"clear",value:function(){this.tileCache.clear()}},{key:"refresh",value:function(){this.clear(),Gh(Xh(e.prototype),"refresh",this).call(this)}},{key:"updateCacheSize",value:function(t,i){i=this.getTileCacheForProjection(i);t>i.highWaterMark&&(i.highWaterMark=t)}},{key:"useTile",value:function(t,i,n,e){}}]),e}(),Zh=function(){Vh(e,_e);var n=zh(e);function e(t,i){return _h(this,e),(t=n.call(this,t)).tile=i,t}return Uh(e)}(),Wh=i;function Yh(t,i){for(var r,n=t.length,e=new Array(n),o=0;o<n;++o)e[o]=function(e,r){var o=/\{z\}/g,s=/\{x\}/g,u=/\{y\}/g,h=/\{-y\}/g;return function(i,t,n){if(i)return e.replace(o,i[0].toString()).replace(s,i[1].toString()).replace(u,i[2].toString()).replace(h,function(){var t=i[0],t=r.getFullTileRange(t);return v(t,55),(t.getHeight()-i[2]-1).toString()})}}(t[o],i);return 1!==(r=e).length?function(t,i,n){var e;if(t)return e=ge((t[1]<<t[0])+t[2],r.length),r[e](t,i,n)}:r[0]}function Kh(t){return(Kh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qh(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Kh(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Kh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Kh(t)?t:String(t)}(e.key),e)}}function $h(t,i){return($h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function Jh(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=ta(n),i=(t=e?(t=ta(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===Kh(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function ta(t){return(ta=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ia=function(){var t=r,i=Wh;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&$h(t,i);var n,e=Jh(r);function r(t){var i;if(this instanceof r)return(i=e.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})).generateTileUrlFunction_=i.tileUrlFunction===r.prototype.tileUrlFunction,i.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(i.tileUrlFunction=t.tileUrlFunction),i.urls=null,t.urls?i.setUrls(t.urls):t.url&&i.setUrl(t.url),i.tileLoadingKeys_={},i;throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"getTileLoadFunction",value:function(){return this.tileLoadFunction}},{key:"getTileUrlFunction",value:function(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}},{key:"getUrls",value:function(){return this.urls}},{key:"handleTileChange",value:function(t){var i,t=t.target,n=Pn(t),e=t.getState();e==Qo?(this.tileLoadingKeys_[n]=!0,i=dh):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],i=e==Jo?ph:e==$o?bh:void 0),null!=i&&this.dispatchEvent(new Zh(i,t))}},{key:"setTileLoadFunction",value:function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}},{key:"setTileUrlFunction",value:function(t,i){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==i?this.setKey(i):this.changed()}},{key:"setUrl",value:function(t){t=function(t){var i=[],n=/\{([a-z])-([a-z])\}/.exec(t);if(n)for(var e=n[1].charCodeAt(0),r=n[2].charCodeAt(0),o=e;o<=r;++o)i.push(t.replace(n[0],String.fromCharCode(o)));else if(n=/\{(\d+)-(\d+)\}/.exec(t))for(var s=parseInt(n[2],10),u=parseInt(n[1],10);u<=s;u++)i.push(t.replace(n[0],u.toString()));else i.push(t);return i}(t);this.urls=t,this.setUrls(t)}},{key:"setUrls",value:function(t){var i=(this.urls=t).join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(Yh(t,this.tileGrid),i):this.setKey(i)}},{key:"tileUrlFunction",value:function(t,i,n){}},{key:"useTile",value:function(t,i,n){t=hh(t,i,n);this.tileCache.containsKey(t)&&this.tileCache.get(t)}}])&&Qh(t.prototype,i),n&&Qh(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function na(t){return(na="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ea(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==na(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==na(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===na(t)?t:String(t)}(e.key),e)}}function ra(){return(ra="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,n){var e=function(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=ua(t)););return t}(t,i);if(e)return(e=Object.getOwnPropertyDescriptor(e,i)).get?e.get.call(arguments.length<3?t:n):e.value}).apply(this,arguments)}function oa(t,i){return(oa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function sa(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=ua(n),i=(t=e?(t=ua(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===na(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function ua(t){return(ua=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ha(t,i){t.getImage().src=i}var aa=function(){var t=r,i=ia;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&oa(t,i);var n,e=sa(r);function r(t){var i;if(this instanceof r)return i=void 0===t.imageSmoothing||t.imageSmoothing,void 0!==t.interpolate&&(i=t.interpolate),(i=e.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction||ha,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:i,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})).crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,i.tileClass=void 0!==t.tileClass?t.tileClass:eh,i.tileCacheForProjection={},i.tileGridForProjection={},i.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,i.renderReprojectionEdges_=!1,i;throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"canExpireCache",value:function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}},{key:"expireCache",value:function(t,i){var n,e=this.getTileCacheForProjection(t);for(n in this.tileCache.expireCache(this.tileCache==e?i:{}),this.tileCacheForProjection){var r=this.tileCacheForProjection[n];r.expireCache(r==e?i:{})}}},{key:"getGutterForProjection",value:function(t){return this.getProjection()&&t&&!$s(this.getProjection(),t)?0:this.getGutter()}},{key:"getGutter",value:function(){return 0}},{key:"getKey",value:function(){var t=ra(ua(r.prototype),"getKey",this).call(this);return this.getInterpolate()||(t+=":disable-interpolation"),t}},{key:"getOpaque",value:function(t){return!(this.getProjection()&&t&&!$s(this.getProjection(),t))&&ra(ua(r.prototype),"getOpaque",this).call(this,t)}},{key:"getTileGridForProjection",value:function(t){var i=this.getProjection();return!this.tileGrid||i&&!$s(i,t)?((i=Pn(t))in this.tileGridForProjection||(this.tileGridForProjection[i]=Nh(t)),this.tileGridForProjection[i]):this.tileGrid}},{key:"getTileCacheForProjection",value:function(t){var i=this.getProjection();return!i||$s(i,t)?this.tileCache:((i=Pn(t))in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new yh(this.tileCache.highWaterMark)),this.tileCacheForProjection[i])}},{key:"createTile_",value:function(t,i,n,e,r,o){t=[t,i,n],i=this.getTileCoordForTileUrlFunction(t,r),n=i?this.tileUrlFunction(i,e,r):void 0,i=new this.tileClass(t,void 0!==n?Ko:ts,void 0!==n?n:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return i.key=o,i.addEventListener(Ke,this.handleTileChange.bind(this)),i}},{key:"getTile",value:function(t,i,n,e,r){var o=this.getProjection();return this.getTileInternal(t,i,n,e,o||r)}},{key:"getTileInternal",value:function(t,i,n,e,r){var o,s=null,u=hh(t,i,n),h=this.getKey();return this.tileCache.containsKey(u)?(s=this.tileCache.get(u)).key!=h&&(o=s,s=this.createTile_(t,i,n,e,r,h),o.getState()==Ko?s.interimTile=o.interimTile:s.interimTile=o,s.refreshInterimChain(),this.tileCache.replace(u,s)):(s=this.createTile_(t,i,n,e,r,h),this.tileCache.set(u,s)),s}},{key:"setRenderReprojectionEdges",value:function(t){if(this.renderReprojectionEdges_!=t){for(var i in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[i].clear();this.changed()}}}])&&ea(t.prototype,i),n&&ea(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function ca(t){return(ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fa(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==ca(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==ca(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===ca(t)?t:String(t)}(e.key),e)}}function la(t,i){return(la=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function va(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=ya(n),i=(t=e?(t=ya(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===ca(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function ya(t){return(ya=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var da=function(){var t=s,i=aa;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&la(t,i);var n,e,o=va(s);function s(t){var i,n,e,r;if(this instanceof s)return i=void 0===(t=t||{}).imageSmoothing||t.imageSmoothing,void 0!==t.interpolate&&(i=t.interpolate),n=void 0!==t.projection?t.projection:"EPSG:3857",e=void 0!==t.tileGrid?t.tileGrid:(e={extent:Dh(n),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize},r={extent:r=(e=e||{}).extent||Ys("EPSG:3857").getExtent(),minZoom:e.minZoom,tileSize:e.tileSize,resolutions:Bh(r,e.maxZoom,e.tileSize,e.maxResolution)},new Ih(r)),o.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:i,opaque:t.opaque,projection:n,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:e,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection});throw new TypeError("Cannot call a class as a function")}return t=s,n&&fa(t.prototype,n),e&&fa(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();function ba(t){return(ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pa(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==ba(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==ba(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===ba(t)?t:String(t)}(e.key),e)}}function ma(t,i){return(ma=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function wa(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=ga(n),i=(t=e?(t=ga(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===ba(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function ga(t){return(ga=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ja=function(){var t=s,i=da;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&ma(t,i);var n,e,o=wa(s);function s(t){var i,n,e,r;if(this instanceof s)return i=void 0===(t=t||{}).imageSmoothing||t.imageSmoothing,void 0!==t.interpolate&&(i=t.interpolate),n=void 0!==t.attributions?t.attributions:['&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.'],e=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",r=void 0!==t.url?t.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png",o.call(this,{attributions:n,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:e,interpolate:i,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,opaque:void 0===t.opaque||t.opaque,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:r,wrapX:t.wrapX,zDirection:t.zDirection});throw new TypeError("Cannot call a class as a function")}return t=s,n&&pa(t.prototype,n),e&&pa(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}(),Ma="preload",Sa="useInterimTilesOnError";function Oa(t){return(Oa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ea(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Oa(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Oa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Oa(t)?t:String(t)}(e.key),e)}}function ka(){return(ka="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,n){var e=function(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=Aa(t)););return t}(t,i);if(e)return(e=Object.getOwnPropertyDescriptor(e,i)).get?e.get.call(arguments.length<3?t:n):e.value}).apply(this,arguments)}function Ta(t,i){return(Ta=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function Ra(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Aa(n),i=(t=e?(t=Aa(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===Oa(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Aa(t){return(Aa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var xa=function(){var t=r,i=Yr;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&Ta(t,i);var n,e=Ra(r);function r(t){var i;if(this instanceof r)return delete(i=Ue({},t=t||{})).preload,delete i.useInterimTilesOnError,(i=e.call(this,i)).on,i.once,i.un,i.setPreload(void 0!==t.preload?t.preload:0),i.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError),i;throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"getPreload",value:function(){return this.get(Ma)}},{key:"setPreload",value:function(t){this.set(Ma,t)}},{key:"getUseInterimTilesOnError",value:function(){return this.get(Sa)}},{key:"setUseInterimTilesOnError",value:function(t){this.set(Sa,t)}},{key:"getData",value:function(t){return ka(Aa(r.prototype),"getData",this).call(this,t)}}])&&Ea(t.prototype,i),n&&Ea(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function Pa(t){return(Pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ca(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Pa(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Pa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Pa(t)?t:String(t)}(e.key),e)}}function La(){return(La="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,n){var e=function(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=Da(t)););return t}(t,i);if(e)return(e=Object.getOwnPropertyDescriptor(e,i)).get?e.get.call(arguments.length<3?t:n):e.value}).apply(this,arguments)}function Ia(t,i){return(Ia=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function Na(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Da(n),i=(t=e?(t=Da(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===Pa(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ba(i)}}function Ba(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Da(t){return(Da=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Fa=function(){var t=r,i=ur;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&Ia(t,i);var n,e=Na(r);function r(t){var i;if(this instanceof r)return(i=e.call(this)).ready=!0,i.boundHandleImageChange_=i.handleImageChange_.bind(Ba(i)),i.layer_=t,i.declutterExecutorGroup=null,i;throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"getFeatures",value:function(t){return l()}},{key:"getData",value:function(t){return null}},{key:"prepareFrame",value:function(t){return l()}},{key:"renderFrame",value:function(t,i){return l()}},{key:"loadedTileCallback",value:function(t,i,n){t[i]||(t[i]={}),t[i][n.tileCoord.toString()]=n}},{key:"createLoadedTileFinder",value:function(e,r,o){return function(t,i){var n=this.loadedTileCallback.bind(this,o,t);return e.forEachLoadedTile(r,t,i,n)}.bind(this)}},{key:"forEachFeatureAtCoordinate",value:function(t,i,n,e,r){}},{key:"getDataAtPixel",value:function(t,i,n){return null}},{key:"getLayer",value:function(){return this.layer_}},{key:"handleFontsChanged",value:function(){}},{key:"handleImageChange_",value:function(t){t.target.getState()===Yu&&this.renderIfReadyAndVisible()}},{key:"loadImage",value:function(t){var i=t.getState();return i!=Yu&&i!=Ku&&t.addEventListener(Ke,this.boundHandleImageChange_),i==Wu&&(t.load(),i=t.getState()),i==Yu}},{key:"renderIfReadyAndVisible",value:function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==Ur&&t.changed()}},{key:"disposeInternal",value:function(){delete this.layer_,La(Da(r.prototype),"disposeInternal",this).call(this)}}])&&Ca(t.prototype,i),n&&Ca(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function _a(t){return(_a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ha(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==_a(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==_a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===_a(t)?t:String(t)}(e.key),e)}}function Ua(t,i){return(Ua=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function Ga(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Va(n),i=(t=e?(t=Va(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===_a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Va(t){return(Va=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var qa=function(){var t=o,i=_e;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&Ua(t,i);var n,e,r=Ga(o);function o(t,i,n,e){if(this instanceof o)return(t=r.call(this,t)).inversePixelTransform=i,t.frameState=n,t.context=e,t;throw new TypeError("Cannot call a class as a function")}return t=o,n&&Ha(t.prototype,n),e&&Ha(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();function za(t){return(za="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xa(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==za(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==za(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===za(t)?t:String(t)}(e.key),e)}}function Za(){return(Za="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,n){var e=function(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=Ka(t)););return t}(t,i);if(e)return(e=Object.getOwnPropertyDescriptor(e,i)).get?e.get.call(arguments.length<3?t:n):e.value}).apply(this,arguments)}function Wa(t,i){return(Wa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function Ya(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Ka(n),i=(t=e?(t=Ka(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===za(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Ka(t){return(Ka=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Qa=null;var $a=function(){var t=r,i=Fa;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&Wa(t,i);var n,e=Ya(r);function r(t){if(this instanceof r)return(t=e.call(this,t)).container=null,t.renderedResolution,t.tempTransform=qn(),t.pixelTransform=qn(),t.inversePixelTransform=qn(),t.context=null,t.containerReused=!1,t.pixelContext_=null,t.frameState=null,t;throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"getImageData",value:function(t,i,n){var e,r;Qa||((e=document.createElement("canvas")).width=1,e.height=1,Qa=e.getContext("2d")),Qa.clearRect(0,0,1,1);try{Qa.drawImage(t,i,n,1,1,0,0,1,1),r=Qa.getImageData(0,0,1,1).data}catch(t){return null}return r}},{key:"getBackground",value:function(t){var i=this.getLayer().getBackground();return(i="function"==typeof i?i(t.viewState.resolution):i)||void 0}},{key:"useContainer",value:function(t,i,n,e){var r,o,s,u,h,a=this.getLayer().getClassName();(r=t&&t.className===a&&""===t.style.opacity&&1===n&&(!e||t.style.backgroundColor&&Tn(Pe(t.style.backgroundColor),Pe(e)))&&(n=t.firstElementChild)instanceof HTMLCanvasElement?n.getContext("2d"):r)&&r.canvas.style.transform===i?(this.container=t,this.context=r,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),this.container||((n=document.createElement("div")).className=a,(i=n.style).position="absolute",i.width="100%",i.height="100%",e&&(i.backgroundColor=e),u=u&&u.length?u.shift():Ln?new OffscreenCanvas(o||300,s||300):document.createElement("canvas"),o&&(u.width=o),s&&(u.height=s),t=(r=u.getContext("2d",h)).canvas,n.appendChild(t),(i=t.style).position="absolute",i.left="0",i.transformOrigin="top left",this.container=n,this.context=r)}},{key:"clipUnrotated",value:function(t,i,n){var e=ce(n),r=fe(n),o=oe(n),n=re(n),i=(zn(i.coordinateToPixelTransform,e),zn(i.coordinateToPixelTransform,r),zn(i.coordinateToPixelTransform,o),zn(i.coordinateToPixelTransform,n),this.inversePixelTransform);zn(i,e),zn(i,r),zn(i,o),zn(i,n),t.save(),t.beginPath(),t.moveTo(Math.round(e[0]),Math.round(e[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(n[0]),Math.round(n[1])),t.clip()}},{key:"dispatchRenderEvent_",value:function(t,i,n){var e=this.getLayer();e.hasListener(t)&&(t=new qa(t,this.inversePixelTransform,n,i),e.dispatchEvent(t))}},{key:"preRender",value:function(t,i){this.frameState=i,this.dispatchRenderEvent_(Br,t,i)}},{key:"postRender",value:function(t,i){this.dispatchRenderEvent_(Dr,t,i)}},{key:"getRenderTransform",value:function(t,i,n,e,r,o,s){e/=i,i=-t[0]+s,s=-t[1];return Xn(this.tempTransform,r/2,o/2,e,-e,-n,i,s)}},{key:"getDataAtPixel",value:function(t,i,n){var e=zn(this.inversePixelTransform,t.slice()),r=this.context,o=this.getLayer().getExtent();if(o&&!Kn(o,zn(i.pixelToCoordinateTransform,t.slice())))return null;var s,o=Math.round(e[0]),i=Math.round(e[1]),t=this.pixelContext_;t||((e=document.createElement("canvas")).width=1,e.height=1,t=e.getContext("2d"),this.pixelContext_=t),t.clearRect(0,0,1,1);try{t.drawImage(r.canvas,o,i,1,1,0,0,1,1),s=t.getImageData(0,0,1,1).data}catch(t){return"SecurityError"===t.name?(this.pixelContext_=null,new Uint8Array):s}return 0===s[3]?null:s}},{key:"disposeInternal",value:function(){delete this.frameState,Za(Ka(r.prototype),"disposeInternal",this).call(this)}}])&&Xa(t.prototype,i),n&&Xa(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function Ja(t){return(Ja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tc(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Ja(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Ja(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Ja(t)?t:String(t)}(e.key),e)}}function ic(){return(ic="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,n){var e=function(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=rc(t)););return t}(t,i);if(e)return(e=Object.getOwnPropertyDescriptor(e,i)).get?e.get.call(arguments.length<3?t:n):e.value}).apply(this,arguments)}function nc(t,i){return(nc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function ec(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=rc(n),i=(t=e?(t=rc(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===Ja(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function rc(t){return(rc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var oc=function(){var t=r,i=$a;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&nc(t,i);var n,e=ec(r);function r(t){var i;if(this instanceof r)return(i=e.call(this,t)).extentChanged=!0,i.renderedExtent_=null,i.renderedPixelRatio,i.renderedProjection=null,i.renderedRevision,i.renderedTiles=[],i.newTiles_=!1,i.tmpExtent=Jn(),i.tmpTileRange_=new xh(0,0,0,0),i.thirdMap_=t.thirdMap_,i.layercount_=t.layercount_,i;throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"isDrawableTile",value:function(t){var i=this.getLayer(),t=t.getState(),i=i.getUseInterimTilesOnError();return t==$o||t==ts||t==Jo&&!i}},{key:"getTile",value:function(t,i,n,e){var r=e.pixelRatio,e=e.viewState.projection,o=this.getLayer(),t=o.getSource().getTile(t,i,n,r,e);return t.getState()==Jo&&(o.getUseInterimTilesOnError()?0<o.getPreload()&&(this.newTiles_=!0):t.setState($o)),t=this.isDrawableTile(t)?t:t.getInterimTile()}},{key:"getData",value:function(t){var i=this.frameState;if(i){var n=this.getLayer(),e=zn(i.pixelToCoordinateTransform,t.slice()),t=n.getExtent();if(!t||Kn(t,e))for(var r=i.pixelRatio,o=i.viewState.projection,t=i.viewState,s=n.getRenderSource(),u=s.getTileGridForProjection(t.projection),h=s.getTilePixelRatio(i.pixelRatio),a=u.getZForResolution(t.resolution);a>=u.getMinZoom();--a){var c,f,l,v,y=u.getTileCoordForCoordAndZ(e,a),d=s.getTile(a,y[1],y[2],r,o);if(!(d instanceof eh))return null;if(d.getState()===$o)return v=u.getOrigin(a),c=ku(u.getTileSize(a)),f=u.getResolution(a),l=Math.floor(h*((e[0]-v[0])/f-y[1]*c[0])),v=Math.floor(h*((v[1]-e[1])/f-y[2]*c[1])),this.getImageData(d.getImage(),l,v)}}return null}},{key:"loadedTileCallback",value:function(t,i,n){return!!this.isDrawableTile(n)&&ic(rc(r.prototype),"loadedTileCallback",this).call(this,t,i,n)}},{key:"prepareFrame",value:function(t){return!!this.getLayer().getSource()}},{key:"renderFrame",value:function(t,B){var i=t.layerStatesArray[t.layerIndex],n=t.viewState,e=n.projection,r=n.resolution,o=n.center,n=n.rotation,s=t.pixelRatio,u=this.getLayer(),h=u.getSource(),D=h.getRevision(),a=h.getTileGridForProjection(e),c=a.getZForResolution(r,h.zDirection),f=a.getResolution(c),l=t.extent,v=(i.extent&&au(i.extent,e)&&(l=ae(l,au(i.extent,e))),h.getTilePixelRatio(s)),y=Math.round(t.size[0]*v),d=Math.round(t.size[1]*v),F=(n&&(d=y=Math.round(Math.sqrt(y*y+d*d))),f*y/2/v),_=f*d/2/v,b=[o[0]-F,o[1]-_,o[0]+F,o[1]+_],p=a.getTileRangeForExtentAndZ(l,c),m={},H=(m[c]={},this.createLoadedTileFinder(h,e,m)),U=this.tmpExtent,G=this.tmpTileRange_;this.newTiles_=!1;for(var w=p.minX;w<=p.maxX;++w)for(var g=p.minY;g<=p.maxY;++g){var j=this.getTile(c,w,g,t);if(this.isDrawableTile(j)){var M=Pn(this);if(j.getState()==$o&&(S=(m[c][j.tileCoord.toString()]=j).inTransition(M),this.newTiles_||!S&&-1!==this.renderedTiles.indexOf(j)||(this.newTiles_=!0)),1===j.getAlpha(M,t.time))continue}var S=a.getTileCoordChildTileRange(j.tileCoord,G,U),M=!1;(M=S?H(c+1,S):M)||a.forEachTileCoordParentTileRange(j.tileCoord,H,G,U)}for(var V,O=f/r,E=(Xn(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/v,1/v,n,-y/2,-d/2),Zn(this.inversePixelTransform,this.pixelTransform),Xn(this.tempTransform,y/2,d/2,O,O,0,-y/2,-d/2),this.renderedTiles.length=0,Object.keys(m).map(Number)),k=(E.sort(On),1!==i.opacity||this.containerReused&&!h.getOpaque(t.viewState.projection)?(V=[],0):E=E.reverse(),[]),T=null,R=E.length-1;0<=R;--R){var q,A=E[R],x=((null===T||A<T)&&(T=A),h.getTilePixelSize(A,s,e)),z=a.getResolution(A)/f,X=x[0]*z*O,Z=x[1]*z*O,P=a.getTileCoordForCoordAndZ(ce(b),A),x=a.getTileCoordExtent(P),C=zn(this.tempTransform,[v*(x[0]-b[0])/f,v*(b[3]-x[3])/f]),W=v*h.getGutterForProjection(e),Y=m[A];for(q in Y){var L=Y[q],I=L.tileCoord,N=P[1]-I[1],K=Math.round(C[0]-(N-1)*X),I=P[2]-I[2],Q=Math.round(C[1]-(I-1)*Z),N=Math.round(C[0]-N*X),I=Math.round(C[1]-I*Z),K=K-N,Q=Q-I,$=c===A,J=$&&1!==L.getAlpha(Pn(this),t.time);this.drawTileImage(L,t,N,I,K,Q,W,$,k),V&&!J?this.renderedTiles.unshift(L):this.renderedTiles.push(L),this.updateUsedTiles(t.usedTiles,h,L)}}return this.renderedRevision=D,this.renderedResolution=f,this.extentChanged=!this.renderedExtent_||!ne(this.renderedExtent_,b),this.renderedExtent_=b,this.renderedPixelRatio=s,this.renderedProjection=e,this.manageTilePyramid(t,h,a,s,e,l,c,u.getPreload()),this.scheduleExpireCache(t,h),this.thirdMap_&&(1===this.layercount_?this.thirdMap_.A&&this.thirdMap_.A(k,T):this.thirdMap_.P&&this.thirdMap_.P(k,T)),this.container}},{key:"drawTileImage",value:function(t,i,n,e,r,o,s,u,h){var a,c,f=this.getTileImage(t);f&&(a=Pn(this),c=u?t.getAlpha(a,i.time):1,h.push({image:f,x:n,y:e,w:r,h:o,frameState:i}),1!==c?i.animate=!0:u&&t.endTransition(a))}},{key:"getTileImage",value:function(t){return t.getImage()}},{key:"scheduleExpireCache",value:function(t,i){i.canExpireCache()&&(i=function(t,i,n){var e=Pn(t);e in n.usedTiles&&t.expireCache(n.viewState.projection,n.usedTiles[e])}.bind(null,i),t.postRenderFunctions.push(i))}},{key:"updateUsedTiles",value:function(t,i,n){i=Pn(i);i in t||(t[i]={}),t[i][n.getKey()]=!0}},{key:"manageTilePyramid",value:function(t,i,n,e,r,o,s,u,h){for(var a,c,f,l,v,y=Pn(i),d=(y in t.wantedTiles||(t.wantedTiles[y]={}),t.wantedTiles[y]),b=t.tileQueue,p=0,m=n.getMinZoom();m<=s;++m)for(c=n.getTileRangeForExtentAndZ(o,m,c),f=n.getResolution(m),l=c.minX;l<=c.maxX;++l)for(v=c.minY;v<=c.maxY;++v)s-m<=u?(++p,(a=i.getTile(m,l,v,e,r)).getState()==Ko&&(d[a.getKey()]=!0,b.isKeyQueued(a.getKey())||b.enqueue([a,y,n.getTileCoordCenter(a.tileCoord),f])),void 0!==h&&h(a)):i.useTile(m,l,v,r);i.updateCacheSize(p,r)}}])&&tc(t.prototype,i),n&&tc(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function sc(t){return(sc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uc(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==sc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==sc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===sc(t)?t:String(t)}(e.key),e)}}function hc(t,i){return(hc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function ac(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=cc(n),i=(t=e?(t=cc(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===sc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function cc(t){return(cc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var fc=function(){var t=r,i=xa;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&hc(t,i);var n,e=ac(r);function r(t){var i;if(this instanceof r)return(i=e.call(this,t)).layercount_=t.layercount,i.thirdMap_=t.thirdMap,i;throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"createRenderer",value:function(){return new oc(this)}}])&&uc(t.prototype,i),n&&uc(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}(),lc="XY",vc="XYZ",yc="XYM",dc="XYZM";function bc(t,i,n,e,r,o){for(var s=o||[],u=0,h=i;h<n;h+=e){var a=t[h],c=t[h+1];s[u++]=r[0]*a+r[2]*c+r[4],s[u++]=r[1]*a+r[3]*c+r[5]}return o&&s.length!=u&&(s.length=u),s}function pc(t){return(pc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mc(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==pc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==pc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===pc(t)?t:String(t)}(e.key),e)}}function wc(t,i){return(wc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function gc(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=jc(n),i=(t=e?(t=jc(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===pc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function jc(t){return(jc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Mc=qn(),Sc=function(){var t=u,i=mr;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&wc(t,i);var n,s=gc(u);function u(){var t,i,n,e,r,o;if(this instanceof u)return(t=s.call(this)).extent_=Jn(),t.extentRevision_=-1,t.simplifiedGeometryMaxMinSquaredTolerance=0,t.simplifiedGeometryRevision=0,t.simplifyTransformedInternal=(o=!(i=function(t,i,n){var e;return(n?((e=this.clone()).applyTransform(n),e):this).getSimplifiedGeometry(i)}),function(){var t=Array.prototype.slice.call(arguments);return o&&this===r&&Tn(t,e)||(o=!0,r=this,e=t,n=i.apply(this,arguments)),n}),t;throw new TypeError("Cannot call a class as a function")}return t=u,(i=[{key:"simplifyTransformed",value:function(t,i){return this.simplifyTransformedInternal(this.getRevision(),t,i)}},{key:"clone",value:function(){return l()}},{key:"closestPointXY",value:function(t,i,n,e){return l()}},{key:"containsXY",value:function(t,i){var n=this.getClosestPoint([t,i]);return n[0]===t&&n[1]===i}},{key:"getClosestPoint",value:function(t,i){i=i||[NaN,NaN];return this.closestPointXY(t[0],t[1],i,1/0),i}},{key:"intersectsCoordinate",value:function(t){return this.containsXY(t[0],t[1])}},{key:"computeExtent",value:function(t){return l()}},{key:"getExtent",value:function(t){var i;return this.extentRevision_!=this.getRevision()&&(i=this.computeExtent(this.extent_),(isNaN(i[0])||isNaN(i[1]))&&ie(i),this.extentRevision_=this.getRevision()),i=this.extent_,(t=t)?(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t):i}},{key:"rotate",value:function(t,i){l()}},{key:"scale",value:function(t,i,n){l()}},{key:"simplify",value:function(t){return this.getSimplifiedGeometry(t*t)}},{key:"getSimplifiedGeometry",value:function(t){return l()}},{key:"getType",value:function(){return l()}},{key:"applyTransform",value:function(t){l()}},{key:"intersectsExtent",value:function(t){return l()}},{key:"translate",value:function(t,i){l()}},{key:"transform",value:function(t,o){var s=Ys(t),t=s.getUnits()==cs.TILE_PIXELS?function(t,i,n){var e=s.getExtent(),r=s.getWorldExtent(),e=he(r)/he(e);return Xn(Mc,r[0],r[3],e,-e,0,0,0),bc(t,0,t.length,n,Mc,i),tu(s,o)(t,i,n)}:tu(s,o);return this.applyTransform(t),this}}])&&mc(t.prototype,i),n&&mc(t,n),Object.defineProperty(t,"prototype",{writable:!1}),u}();function Oc(t){return(Oc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ec(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Oc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Oc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Oc(t)?t:String(t)}(e.key),e)}}function kc(t,i){return(kc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function Tc(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Rc(n),i=(t=e?(t=Rc(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===Oc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Rc(t){return(Rc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ac(t){var i;return t==lc?i=2:t==vc||t==yc?i=3:t==dc&&(i=4),i}var xc=function(){var t=r,i=Sc;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&kc(t,i);var n,e=Tc(r);function r(){var t;if(this instanceof r)return(t=e.call(this)).layout=lc,t.stride=2,t.flatCoordinates=null,t;throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"computeExtent",value:function(t){return i=this.flatCoordinates,n=0,e=this.flatCoordinates.length,r=this.stride,ee(ie(t),i,n,e,r);var i,n,e,r}},{key:"getCoordinates",value:function(){return l()}},{key:"getFirstCoordinate",value:function(){return this.flatCoordinates.slice(0,this.stride)}},{key:"getFlatCoordinates",value:function(){return this.flatCoordinates}},{key:"getLastCoordinate",value:function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}},{key:"getLayout",value:function(){return this.layout}},{key:"getSimplifiedGeometry",value:function(t){var i;return this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance?this:(i=this.getSimplifiedGeometryInternal(t)).getFlatCoordinates().length<this.flatCoordinates.length?i:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}},{key:"getSimplifiedGeometryInternal",value:function(t){return this}},{key:"getStride",value:function(){return this.stride}},{key:"setFlatCoordinates",value:function(t,i){this.stride=Ac(t),this.layout=t,this.flatCoordinates=i}},{key:"setCoordinates",value:function(t,i){l()}},{key:"setLayout",value:function(t,i,n){var e;if(t)e=Ac(t);else{for(var r=0;r<n;++r){if(0===i.length)return this.layout=lc,void(this.stride=2);i=i[0]}t=function(t){var i;2==t?i=lc:3==t?i=vc:4==t&&(i=dc);return i}(e=i.length)}this.layout=t,this.stride=e}},{key:"applyTransform",value:function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}},{key:"rotate",value:function(t,i){var n=this.getFlatCoordinates();if(n){for(var e=this.getStride(),r=n,o=0,s=n.length,u=e,e=t,t=i,i=n,h=i||[],a=Math.cos(e),c=Math.sin(e),f=t[0],l=t[1],v=0,y=o;y<s;y+=u){var d=r[y]-f,b=r[y+1]-l;h[v++]=f+d*a-b*c,h[v++]=l+d*c+b*a;for(var p=y+2;p<y+u;++p)h[v++]=r[p]}i&&h.length!=v&&(h.length=v),this.changed()}}},{key:"scale",value:function(t,i,n){var e=i;void 0===i&&(e=t);i=(i=n)||se(this.getExtent()),n=this.getFlatCoordinates();if(n){for(var r=this.getStride(),o=n,s=0,u=n.length,h=r,a=t,c=e,r=i,t=n,f=t||[],l=r[0],v=r[1],y=0,d=s;d<u;d+=h){var b=o[d]-l,p=o[d+1]-v;f[y++]=l+a*b,f[y++]=v+c*p;for(var m=d+2;m<d+h;++m)f[y++]=o[m]}t&&f.length!=y&&(f.length=y),this.changed()}}},{key:"translate",value:function(t,i){var n=this.getFlatCoordinates();if(n){for(var e=this.getStride(),r=n,o=0,s=n.length,u=e,h=t,a=i,e=n,c=e||[],f=0,l=o;l<s;l+=u){c[f++]=r[l]+h,c[f++]=r[l+1]+a;for(var v=l+2;v<l+u;++v)c[f++]=r[v]}e&&c.length!=f&&(c.length=f),this.changed()}}}])&&Ec(t.prototype,i),n&&Ec(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function Pc(t,i,n,e,r,o,s){var u,h,a,c=t[i],f=t[i+1],l=t[n]-c,v=t[n+1]-f;if(0==l&&0==v)u=i;else{var y=((r-c)*l+(o-f)*v)/(l*l+v*v);if(1<y)u=n;else{if(0<y){for(var d=0;d<e;++d)s[d]=(h=t[i+d],a=t[n+d],h+y*(a-h));return void(s.length=e)}u=i}}for(var b=0;b<e;++b)s[b]=t[u+b];s.length=e}function Cc(t,i,n,e,r){var o=t[i],s=t[i+1];for(i+=e;i<n;i+=e){var u=t[i],h=t[i+1],a=me(o,s,u,h);r<a&&(r=a),o=u,s=h}return r}function Lc(t,i,n,e,r){for(var o=0,s=n.length;o<s;++o){var u=n[o];r=Cc(t,i,u,e,r),i=u}return r}function Ic(t,i,n,e,r,o,s,u,h,a,c){var f,l;if(i!=n)if(0===r){if((l=me(s,u,t[i],t[i+1]))<a){for(f=0;f<e;++f)h[f]=t[i+f];return h.length=e,l}}else{for(var v=c||[NaN,NaN],y=i+e;y<n;)if(Pc(t,y-e,y,e,s,u,v),(l=me(s,u,v[0],v[1]))<a){for(a=l,f=0;f<e;++f)h[f]=v[f];y+=h.length=e}else y+=e*Math.max((Math.sqrt(l)-Math.sqrt(a))/r|0,1);if(o&&(Pc(t,n-e,i,e,s,u,v),(l=me(s,u,v[0],v[1]))<a)){for(a=l,f=0;f<e;++f)h[f]=v[f];h.length=e}}return a}function Nc(t,i,n,e,r,o,s,u,h,a,c){for(var f=c||[NaN,NaN],l=0,v=n.length;l<v;++l){var y=n[l];a=Ic(t,i,y,e,r,o,s,u,h,a,f),i=y}return a}function Bc(t,i,n,e){for(var r=0,o=n.length;r<o;++r)for(var s=n[r],u=0;u<e;++u)t[i++]=s[u];return i}function Dc(t,i,n,e,r){for(var o=r||[],s=0,u=0,h=n.length;u<h;++u){var a=Bc(t,i,n[u],e);i=o[s++]=a}return o.length=s,o}function Fc(t,i,n,e,r,o,s){var u=(n-i)/e;if(u<3)for(;i<n;i+=e)o[s++]=t[i],o[s++]=t[i+1];else{for(var h,a,c,f,l,v,y=new Array(u),d=(y[0]=1,y[u-1]=1,[i,n-e]),b=0;0<d.length;){for(var p=d.pop(),m=d.pop(),w=0,g=t[m],j=t[m+1],M=t[p],S=t[p+1],O=m+e;O<p;O+=e){var E=t[O],k=t[O+1],T=(E=E,k=k,v=l=f=void 0,v=(c=S)-(a=j),0==(l=(T=M)-(h=g))&&0==v||(1<(f=((E-h)*l+(k-a)*v)/(l*l+v*v))?(h=T,a=c):0<f&&(h+=l*f,a+=v*f)),me(E,k,h,a));w<T&&(b=O,w=T)}r<w&&(y[(b-i)/e]=1,m+e<b&&d.push(m,b),b+e<p)&&d.push(b,p)}for(var R=0;R<u;++R)y[R]&&(o[s++]=t[i+R*e],o[s++]=t[i+R*e+1])}return s}function _c(t,i){return i*Math.round(t/i)}function Hc(t,i,n,e,r,o,s,u){for(var h=0,a=n.length;h<a;++h){var c=n[h];s=function(t,i,n,e,r,o,s){if(i!=n){var u,h=_c(t[i],r),a=_c(t[i+1],r);i+=e,o[s++]=h,o[s++]=a;do{if(u=_c(t[i],r),y=_c(t[i+1],r),(i+=e)==n)return o[s++]=u,o[s++]=y,s}while(u==h&&y==a);for(;i<n;){var c,f,l,v,y,d=_c(t[i],r),b=_c(t[i+1],r);i+=e,d==u&&b==y||(u=((c=u-h)*(v=b-a)==(f=y-a)*(l=d-h)&&(c<0&&l<c||c==l||0<c&&c<l)&&(f<0&&v<f||f==v||0<f&&f<v)||(h=o[s++]=u,a=o[s++]=y),d),y=b)}o[s++]=u,o[s++]=y}return s}(t,i,c,e,r,o,s),u.push(s),i=c}return s}function Uc(t,i,n,e,r){for(var o=void 0!==r?r:[],s=0,u=i;u<n;u+=e)o[s++]=t.slice(u,u+e);return o.length=s,o}function Gc(t,i,n,e,r){for(var o=void 0!==r?r:[],s=0,u=0,h=n.length;u<h;++u){var a=n[u];o[s++]=Uc(t,i,a,e,o[s]),i=a}return o.length=s,o}function Vc(t,i,n,e){for(var r=0,o=t[n-e],s=t[n-e+1];i<n;i+=e){var u=t[i],h=t[i+1];r+=s*u-o*h,o=u,s=h}return r/2}function qc(t,i,n,e){for(var r=0,o=0,s=n.length;o<s;++o){var u=n[o];r+=Vc(t,i,u,e),i=u}return r}function zc(t){return(zc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xc(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==zc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==zc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===zc(t)?t:String(t)}(e.key),e)}}function Zc(t,i){return(Zc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function Wc(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Yc(n),i=(t=e?(t=Yc(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===zc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Yc(t){return(Yc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Kc=function(){var t=r,i=xc;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&Zc(t,i);var n,e=Wc(r);function r(t,i){var n;if(this instanceof r)return(n=e.call(this)).maxDelta_=-1,n.maxDeltaRevision_=-1,void 0===i||Array.isArray(t[0])?n.setCoordinates(t,i):n.setFlatCoordinates(i,t),n;throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"clone",value:function(){return new r(this.flatCoordinates.slice(),this.layout)}},{key:"closestPointXY",value:function(t,i,n,e){return e<Yn(this.getExtent(),t,i)?e:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Cc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ic(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,i,n,e))}},{key:"getArea",value:function(){return Vc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getCoordinates",value:function(){return Uc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getSimplifiedGeometryInternal",value:function(t){var i=[];return i.length=Fc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new r(i,lc)}},{key:"getType",value:function(){return Gs}},{key:"intersectsExtent",value:function(t){return!1}},{key:"setCoordinates",value:function(t,i){this.setLayout(i,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Bc(this.flatCoordinates,0,t,this.stride),this.changed()}}])&&Xc(t.prototype,i),n&&Xc(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function Qc(t){return(Qc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $c(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Qc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Qc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Qc(t)?t:String(t)}(e.key),e)}}function Jc(t,i){return(Jc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function tf(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=nf(n),i=(t=e?(t=nf(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===Qc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function nf(t){return(nf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ef=function(){var t=r,i=xc;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&Jc(t,i);var n,e=tf(r);function r(t,i){var n;if(this instanceof r)return(n=e.call(this)).setCoordinates(t,i),n;throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"clone",value:function(){var t=new r(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,i,n,e){var r=this.flatCoordinates,t=me(t,i,r[0],r[1]);if(t<e){for(var o=this.stride,s=0;s<o;++s)n[s]=r[s];return n.length=o,t}return e}},{key:"getCoordinates",value:function(){return this.flatCoordinates?this.flatCoordinates.slice():[]}},{key:"computeExtent",value:function(t){return i=this.flatCoordinates,n=i[0],i=i[1],te(n,i,n,i,t);var i,n}},{key:"getType",value:function(){return Us}},{key:"intersectsExtent",value:function(t){return Qn(t,this.flatCoordinates[0],this.flatCoordinates[1])}},{key:"setCoordinates",value:function(t,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,i,n){for(var e=0,r=n.length;e<r;++e)t[i++]=n[e];return i}(this.flatCoordinates,0,t,this.stride),this.changed()}}])&&$c(t.prototype,i),n&&$c(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function rf(i,n,e,r,t){var o;return!((o=function(t){return!of(i,n,e,r,t[0],t[1])})(re(t=t))||o(oe(t))||o(fe(t))||o(ce(t))||!1)}function of(t,i,n,e,r,o){for(var s=0,u=t[n-e],h=t[n-e+1];i<n;i+=e){var a=t[i],c=t[i+1];h<=o?o<c&&0<(a-u)*(o-h)-(r-u)*(c-h)&&s++:c<=o&&(a-u)*(o-h)-(r-u)*(c-h)<0&&s--,u=a,h=c}return 0!==s}function sf(t,i,n,e,r,o){if(0===n.length)return!1;if(!of(t,i,n[0],e,r,o))return!1;for(var s=1,u=n.length;s<u;++s)if(of(t,n[s-1],n[s],e,r,o))return!1;return!0}function uf(t,i,n,e,r,o,s){for(var u,h,a,c=r[o+1],f=[],l=0,v=n.length;l<v;++l)for(var y=n[l],d=t[y-e],b=t[y-e+1],p=i;p<y;p+=e)g=t[p],a=t[p+1],(c<=b&&a<=c||b<=c&&c<=a)&&f.push(h=(c-b)/(a-b)*(g-d)+d),d=g,b=a;var m=NaN,w=-1/0;for(f.sort(On),d=f[0],p=1,u=f.length;p<u;++p){var g=f[p],j=Math.abs(g-d);w<j&&sf(t,i,n,e,h=(d+g)/2,c)&&(m=h,w=j),d=g}return isNaN(m)&&(m=r[o]),s?(s.push(m,c,w),s):[m,c,w]}function hf(t,i,n,e,v){var r,o,s=ee(Jn(),t,i,n,e);if(ve(v,s)){if(o=s,(r=v)[0]<=o[0]&&o[2]<=r[2]&&r[1]<=o[1]&&o[3]<=r[3])return 1;if(s[0]>=v[0]&&s[2]<=v[2])return 1;if(s[1]>=v[1]&&s[3]<=v[3])return 1;var u,h=t,a=i,c=n,f=e,l=function(t,i){return i=i,c=!1,f=$n(n=v,t=t),l=$n(n,i),f===d.INTERSECTING||l===d.INTERSECTING?c=!0:(e=n[0],r=n[1],o=n[2],n=n[3],s=t[0],t=t[1],u=i[0],t=((i=i[1])-t)/(u-s),(c=(c=(c=l&d.ABOVE&&!(f&d.ABOVE)?e<=(h=u-(i-n)/t)&&h<=o:c)||!(l&d.RIGHT)||f&d.RIGHT?c:r<=(a=i-(u-o)*t)&&a<=n)||!(l&d.BELOW)||f&d.BELOW?c:e<=(h=u-(i-r)/t)&&h<=o)||!(l&d.LEFT)||f&d.LEFT||(c=r<=(a=i-(u-e)*t)&&a<=n)),c;var n,e,r,o,s,u,h,a,c,f,l};for(a+=f;a<c;a+=f)if(u=l(h.slice(a-f,a),h.slice(a,a+f)))return u}}function af(t,i,n,e,r){if(o=t,i=i,s=n[0],!(hf(o,i,s,u=e,h=r)||of(o,i,s,u,h[0],h[1])||of(o,i,s,u,h[0],h[3])||of(o,i,s,u,h[2],h[1]))&&!of(o,i,s,u,h[2],h[3]))return!1;var o,s,u,h;if(1!==n.length)for(var a=1,c=n.length;a<c;++a)if(rf(t,n[a-1],n[a],e,r)&&!hf(t,n[a-1],n[a],e,r))return!1;return!0}function cf(t,i,n,e){for(var r=0,o=t[n-e],s=t[n-e+1];i<n;i+=e){var u=t[i],h=t[i+1];r+=(u-o)*(h+s),o=u,s=h}return 0===r?void 0:0<r}function ff(t,i,n,e,r){for(var o=void 0!==r&&r,s=0,u=n.length;s<u;++s){var h=n[s],a=cf(t,i,h,e);if(0===s){if(o&&a||!o&&!a)return}else if(o&&!a||!o&&a)return;i=h}return 1}function lf(t,i,n,e,r){for(var o=void 0!==r&&r,s=0,u=n.length;s<u;++s){var h=n[s],a=cf(t,i,h,e);if(0===s?o&&a||!o&&!a:o&&!a||!o&&a){d=y=v=l=f=c=void 0;for(var c=t,f=i,l=h,v=e;f<l-v;){for(var y=0;y<v;++y){var d=c[f+y];c[f+y]=c[l-v+y],c[l-v+y]=d}f+=v,l-=v}}i=h}return i}function vf(t){return(vf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yf(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==vf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==vf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===vf(t)?t:String(t)}(e.key),e)}}function df(t,i){return(df=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function bf(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=pf(n),i=(t=e?(t=pf(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===vf(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function pf(t){return(pf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var mf=function(){var t=o,i=xc;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&df(t,i);var n,r=bf(o);function o(t,i,n){var e;if(this instanceof o)return(e=r.call(this)).ends_=[],e.flatInteriorPointRevision_=-1,e.flatInteriorPoint_=null,e.maxDelta_=-1,e.maxDeltaRevision_=-1,e.orientedRevision_=-1,e.orientedFlatCoordinates_=null,void 0!==i&&n?(e.setFlatCoordinates(i,t),e.ends_=n):e.setCoordinates(t,i),e;throw new TypeError("Cannot call a class as a function")}return t=o,(i=[{key:"appendLinearRing",value:function(t){this.flatCoordinates?kn(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}},{key:"clone",value:function(){var t=new o(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,i,n,e){return e<Yn(this.getExtent(),t,i)?e:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Lc(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Nc(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,i,n,e))}},{key:"containsXY",value:function(t,i){return sf(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,i)}},{key:"getArea",value:function(){return qc(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}},{key:"getCoordinates",value:function(t){var i;return void 0!==t?lf(i=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):i=this.flatCoordinates,Gc(i,0,this.ends_,this.stride)}},{key:"getEnds",value:function(){return this.ends_}},{key:"getFlatInteriorPoint",value:function(){var t;return this.flatInteriorPointRevision_!=this.getRevision()&&(t=se(this.getExtent()),this.flatInteriorPoint_=uf(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()),this.flatInteriorPoint_}},{key:"getInteriorPoint",value:function(){return new ef(this.getFlatInteriorPoint(),yc)}},{key:"getLinearRingCount",value:function(){return this.ends_.length}},{key:"getLinearRing",value:function(t){return t<0||this.ends_.length<=t?null:new Kc(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}},{key:"getLinearRings",value:function(){for(var t=this.layout,i=this.flatCoordinates,n=this.ends_,e=[],r=0,o=0,s=n.length;o<s;++o){var u=n[o],h=new Kc(i.slice(r,u),t);e.push(h),r=u}return e}},{key:"getOrientedFlatCoordinates",value:function(){var t;return this.orientedRevision_!=this.getRevision()&&(ff(t=this.flatCoordinates,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=lf(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()),this.orientedFlatCoordinates_}},{key:"getSimplifiedGeometryInternal",value:function(t){var i=[],n=[];return i.length=Hc(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),i,0,n),new o(i,lc,n)}},{key:"getType",value:function(){return Vs}},{key:"intersectsExtent",value:function(t){return af(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}},{key:"setCoordinates",value:function(t,i){this.setLayout(i,t,2),this.flatCoordinates||(this.flatCoordinates=[]);i=Dc(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}}])&&yf(t.prototype,i),n&&yf(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}();function wf(t){return(wf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gf(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==wf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==wf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===wf(t)?t:String(t)}(e.key),e)}}n=function(){function i(t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");t=t||{},this.C=3500,this.L=void 0!==t.offset?t.offset:1,this.I=void 0===t.visible||t.visible,this.N=void 0!==t.mode?t.mode:a.AMAP_VECTOR,this.B=t.replaceColor,this.D=t.replaceOpacity,void 0===this.D&&(this.D=1),this.F=new Map,this.F.set(""+a.AMAP_SATELLITE,20),this.F.set(""+a.AMAP_VECTOR,20),this.F.set(""+a.BAIDU_VECTOR,20),this.F.set(""+a.BAIDU_SATELLITE,20),this.F.set(""+a.TD_VECTOR,20),this.F.set(""+a.TD_SATELLITE,20),this._=!1,this.H=null,this.U=t.offlineUrl,void 0!==this.U&&(this._=!0),this.G=t.imageType,void 0===this.G&&(this.G="png"),this.V=.4*this.C,this.q=.9*this.C,this.X=null,this.Z=new yt,this.Z.background=new y(13426943),this.Z.fog=new jt(13426943,this.V,this.q),this.W=new gn,this.Z.add(this.W),this.Y=new bn,this.K=null,this.$=this.L,this.J=null,this.tt=new Ri(new j(0,1,0),0),this.it=!1,this.nt=this.nt.bind(this),this.et=this.et.bind(this),this.rt=[],this.ot=!1,this.st=null}var t,n,e;return t=i,(n=[{key:"visible",get:function(){return this.I},set:function(t){this.I=t,this.Z.visible=this.I,this.K.enableUpdateRender()}},{key:"addTo",value:function(t){this.K=t,this.K.getRenderManager().setTileLayScene(this.Z),this.$=this.K.getFloor(this.K.getVisibleLevels()[0]).height-this.L,this.ut(),t.enableUpdateRender()}},{key:"remove",value:function(){this.dispose(),this.K.off("resize",this.nt),this.K.off("viewChanged",this.nt),this.K.off("viewModeChanged",this.et),this.K.off("visibleLevelsLoaded",this.nt),this.K.off("zoom",this.nt),this.K=null,this.it=!1}},{key:"dispose",value:function(){this.J&&this.J.dispose(),this.J=null;for(var t=0;t<this.rt.length;t++)this.rt[t].parent&&(this.rt[t].parent.remove(this.rt[t]),this.rt[t].geometry.dispose(),this.rt[t].material.map.dispose(),this.rt[t].material.dispose());this.W.parent&&this.W.parent.remove(this.W),this.rt.length=0,this.K.getRenderManager().setTileLayScene(void 0),this.K.enableUpdateRender()}}])&&gf(t.prototype,n),e&&gf(t,e),Object.defineProperty(t,"prototype",{writable:!1}),i}(),Object.assign(n.prototype,{ut:function(){this.it||(this.X=this.K.getContainer(),this.J=this.ht(),this.ct(),this.K.camera.far=1e3*wn.CAMERA_FAR,this.K.camera.updateProjectionMatrix(),this.K.on("resize",this.nt),this.K.on("viewChanged",this.nt),this.K.on("viewModeChanged",this.et),this.K.on("visibleLevelsLoaded",this.nt),this.K.on("zoom",this.nt),this.it=!0)},ft:function(){if(0!==this.rt.length)if(this.lt())for(var t=this.vt(),i=0;i<this.rt.length;i++){var n,e=this.rt[i];e.oldTexture||(e.oldTexture=e.material.map.clone(),e.material.map.dispose(),(n=new Oi(t)).minFilter=Wt,e.material.map=n)}else for(var r=0;r<this.rt.length;r++){var o=this.rt[r];o.oldTexture&&(o.material.map.dispose(),o.material.map=o.oldTexture.clone(),o.oldTexture=null)}},nt:function(t){var i;"viewChanged"===t.type?(i=this.K.getCenter(),this.H.x===i.x&&this.H.y===i.y||this.ct(t)):"visibleLevelsLoaded"===t.type?this.yt():"zoom"===t.type&&(this.ct(),this.ft())},dt:function(t){var i=4;this.N===a.AMAP_SATELLITE||this.N===a.AMAP_VECTOR?i=4:this.N===a.BAIDU_VECTOR||this.N===a.BAIDU_SATELLITE?i=5:this.N!==a.TD_VECTOR&&this.N!==a.TD_SATELLITE||(i=3),t!==i||this.ot||(t=this.K.getZoomRange(),this.ot=!0,t[0]=this.K.getZoom(),this.K.setZoomRange(t))},vt:function(){var t;return null===this.st&&(this.st=document.createElement("canvas"),this.st.width=256,this.st.height=256,(t=this.st.getContext("2d")).fillStyle=this.B,t.globalAlpha=this.D,t.fillRect(0,0,256,256)),this.st},lt:function(){var t=this.F.get(""+this.N),i=this.K.getZoom();return!!(t&&this.B&&t<=i)},P:function(t,i){if(0!==this.rt.length&&!this.lt()){var r=this;this.dt(i);for(var n,e,o,s=0;s<t.length;s++){var u,h=function(t){for(var i=null,n=0;n<r.rt.length;n++){var e=r.rt[n].imageinfo;if(t.x===e.x&&t.y===e.y&&t.w===e.w&&t.h===e.h&&!r.rt[n].isCovered){i=r.rt[n];break}}return i}(t[s]);null!==h&&(u=h.imageinfo.image,n=t[s].image,o=e=void 0,(e=document.createElement("canvas")).width=256,e.height=256,(o=e.getContext("2d")).drawImage(u,0,0,256,256),o.drawImage(n,0,0,256,256),(u=new Oi(e)).minFilter=Wt,h.material.map.dispose(),h.material.map=u,h.isCovered=!0)}}},A:function(t,i){var n;this.K&&(this.dt(i),this.bt(t),i=1,"OrthographicCamera"===(t=this.K.camera).type?(i=1/t.zoom,this.Z.fog.near=1e4*this.V,this.Z.fog.far=1e4*this.q):(i=(n=this.Y.ray.distanceToPlane(this.tt))*Math.tan(t.fov*wn.DEG2RAD/2)*2*1.4/(this.C/2),n=n*Math.tan(t.fov*wn.DEG2RAD/2)*2*1.5/(this.C/2),this.Z.fog.near=this.V*n,this.Z.fog.far=this.q*n),this.W.scale.set(i,i,i),this.K.getRenderManager().render())},bt:function(t,i){for(var n=0;n<this.rt.length;n++)this.rt[n].visible=!1;var e=this.lt();if(0===this.rt.length)for(var r=0;r<t.length;r++){var o=new wi(256,256),s=new Oi(S(t[r].image)),u=null,o=((u=new ji(e?{map:new Oi(this.vt()),depthWrite:!1,transparent:!0}:{map:s,depthWrite:!1,transparent:!0})).polygonOffset=!0,u.polygonOffsetFactor=1,u.polygonOffsetUnits=4,new vn(o,u));o.material.map.minFilter=Wt,o.material.needsUpdate=!0,o.src=t[r].image.src,o.imageinfo=t[r],o.scale.set(t[r].w/256,t[r].h/256,1),o.position.x=t[r].x+t[r].w/2-this.C/2,o.position.z=t[r].y+t[r].h/2-this.C/2,o.rotation.x=-Math.PI/2,o.oldTexture=e?s:null,this.W.add(o),this.rt.push(o)}else{for(var h=[],a=[],c=0;c<t.length;c++){var f,l=function(t,i){for(var n=null,e=0;e<t.length;e++)if(t[e].src===i){n=e;break}return n}(this.rt,t[c].image.src);null!==l&&((f=this.rt[l]).scale.set(t[c].w/256,t[c].h/256,1),f.imageinfo=t[c],f.position.x=t[c].x+t[c].w/2-this.C/2,f.position.z=t[c].y+t[c].h/2-this.C/2,f.visible=!0,h.push(f),this.rt.splice(l,1),a.push(c))}t=M(a,t);for(var v=a.length=0;v<t.length&&0!==this.rt.length;v++){var y,d=this.rt.splice(0,1)[0],b=new Oi(S(t[v].image));b.minFilter=Wt,d.material.map.dispose(),e?((y=new Oi(this.vt())).minFilter=Wt,d.material.map=y):d.material.map=b,d.scale.set(t[v].w/256,t[v].h/256,1),d.position.x=t[v].x+t[v].w/2-this.C/2,d.position.z=t[v].y+t[v].h/2-this.C/2,d.src=t[v].image.src,d.imageinfo=t[v],d.visible=!0,d.oldTexture=e?b:null,h.push(d),a.push(v)}t=M(a,t);for(var p=0;p<t.length;p++){var m=new wi(256,256),w=new Oi(S(t[p].image)),g=null,m=((g=new ji(e?{map:new Oi(this.vt()),depthWrite:!1,transparent:!0}:{map:w,depthWrite:!1,transparent:!0})).polygonOffset=!0,g.polygonOffsetFactor=1,g.polygonOffsetUnits=4,new vn(m,g));m.material.map.minFilter=Wt,m.material.needsUpdate=!0,m.src=t[p].image.src,m.scale.set(t[p].w/256,t[p].h/256,1),m.position.x=t[p].x+t[p].w/2-this.C/2,m.position.z=t[p].y+t[p].h/2-this.C/2,m.rotation.x=-Math.PI/2,m.imageinfo=t[p],m.oldTexture=e?w:null,this.W.add(m),h.push(m)}if(0<this.rt.length){for(var j=0;j<this.rt.length;j++)this.rt[j].parent&&(this.rt[j].parent.remove(this.rt[j]),this.rt[j].geometry.dispose(),this.rt[j].material.map.dispose(),this.rt[j].material.dispose());this.rt.length=0}this.rt=h}function M(t,i){for(var n=[],e=0;e<i.length;e++)!function(t,i){for(var n=!0,e=0;e<t.length;e++)if(t[e]===i){n=!1;break}return n}(t,e)||n.push(i[e]);return n}function S(t){var i=document.createElement("canvas");return i.width=256,i.height=256,i.getContext("2d").drawImage(t,0,0,256,256),i}this.W.position.y=this.$},ht:function(){var t,e=this,i=Ys("EPSG:3857");if(this.N===a.AMAP_SATELLITE||this.N===a.AMAP_VECTOR){var n={url:this.wt(),crossOrigin:"anonymous",maxZoom:18,thirdMap:this};this.N===a.AMAP_SATELLITE&&(n.maxZoom=18),n=new da(n)}else if(this.N===a.BAIDU_VECTOR||this.N===a.BAIDU_SATELLITE){for(var r=[],o=0;o<19;o++)r[o]=Math.pow(2,18-o);var s=new Ih({origin:[0,0],resolutions:r}),n=new aa({projection:i,crossOrigin:"anonymous",tileGrid:s,tileUrlFunction:function(t){var i,n;return t?(i=t[0],n=t[1],t=-t[2]-1,e.gt(n=n<0?"M"+-n:n,t=t<0?"M"+-t:t,i)):""}})}else this.N===a.OSM?n=new ja:(n=new da({url:this.jt()[0],crossOrigin:"anonymous",tileSize:[512,512],maxZoom:18}),t=new da({url:this.jt()[1],crossOrigin:"anonymous",tileSize:[512,512],maxZoom:18}));s=new Uu({size:[this.C,this.C],view:new Eu({projection:i}),layers:[new fc({layercount:1,source:n,thirdMap:this}),new fc({layercount:2,source:t,thirdMap:this})]});return s.setTarget(this.X),s},wt:function(){var t=this._?this.U+"/{z}/{x}/{y}."+this.G:this.N===a.AMAP_SATELLITE?"http://wprd0{1-4}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&style=6&x={x}&y={y}&z={z}":"https://wprd0{1-4}.is.autonavi.com/appmaptile?lang=zh_cn&size=2&style=7&x={x}&y={y}&z={z}";return t},gt:function(t,i,n){t=this.N===a.BAIDU_SATELLITE?"https://gss0.bdstatic.com/5bwHcj7lABFY8t_jkk_Z1zRvfdw6buu/it/u=x="+t+";y="+i+";z="+n+";v=009;type=sate&fm=46&udt=20210415&scaler=2":"https://maponline"+parseInt(4*Math.random())+".bdimg.com/tile/?qt=vtile&x="+t+"&y="+i+"&z="+n+"&styles=pl&scaler=2&udt=20210415&from=jsapi2_0&scaler=2";return t},jt:function(){var t;return this.N===a.TD_SATELLITE?((t=[]).push("http://t{0-7}.tianditu.gov.cn/img_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&Layer=img&STYLE=default&TILEMATRIXSET=w&FORMAT=png&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=9a8b557e9db74e442bd9544001392255"),t.push("https://t{0-7}.tianditu.gov.cn/cia_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=cia&STYLE=default&TILEMATRIXSET=w&FORMAT=png&TILECOL={x}&TILEROW={y}&TILEMATRIX={z}&tk=9a8b557e9db74e442bd9544001392255")):((t=[]).push("http://t{0-7}.tianditu.gov.cn/vec_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&Layer=vec&STYLE=default&TILEMATRIXSET=w&FORMAT=png&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=9a8b557e9db74e442bd9544001392255"),t.push("https://t{0-7}.tianditu.gov.cn/cva_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=cva&STYLE=default&TILEMATRIXSET=w&FORMAT=png&TILECOL={x}&TILEROW={y}&TILEMATRIX={z}&tk=9a8b557e9db74e442bd9544001392255")),t},Mt:function(){this.St.setSize(this.K.getContainer().clientWidth,this.K.getContainer().clientHeight)},et:function(){var t=this.K.camera;t.far===wn.CAMERA_FAR&&(t.far=1e3*wn.CAMERA_FAR,t.updateProjectionMatrix()),"OrthographicCamera"===t.type?(this.Z.fog.near=1e4*this.V,this.Z.fog.far=1e4*this.q):(t=this.Y.ray.distanceToPlane(this.tt)*Math.tan(t.fov*wn.DEG2RAD/2)*2*1.5/(this.C/2),this.Z.fog.near=this.V*t,this.Z.fog.far=this.q*t)},ct:function(t){var i,n,e;this.Ot&&t&&t.target&&t.target.target&&t.target.target.x===this.Ot.x&&t.target.target.z===this.Ot.z||(t&&t.target&&t.target.target&&(this.Ot={x:t.target.target.x,y:t.target.target.y,z:t.target.target.z}),t=new j(0,0,.5),e=this.K.camera,this.Y.setFromCamera(t,e),t=new j,this.Y.ray.intersectPlane(this.tt,t),n=1,n="OrthographicCamera"===e.type?1/e.zoom:this.Y.ray.distanceToPlane(this.tt)*Math.tan(e.fov*wn.DEG2RAD/2)*2*1.4/(this.C/2),e=t.x+this.K.x,i=-t.z+this.K.y,n=this.C/2*n,this.W.position.x=t.x,this.W.position.z=t.z,e=(t=[e-n,i-n,e+n,i+n])[0],i=t[1],n=t[2],t=t[3],n=new mf(t=[e,i,e,t,n,t,n,i,e,i],lc,[t.length]),this.J.getView().fit(n),e=this.K.getCenter(),this.H={x:e.x,y:e.y})},yt:function(){this.$=this.K.getFloor(this.K.getVisibleLevels()[0]).height-this.L,this.W.position.y=this.$}}),i=n;function jf(t){try{i=new URL(t,"http://fakehost.com/")}catch(t){return null}var t=i.pathname.split("/").pop(),i=t.lastIndexOf(".");return-1===i||i===t.length-1?null:t.substring(i+1)}function Mf(t){return(Mf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sf(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Mf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Mf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Mf(t)?t:String(t)}(e.key),e)}}var Of=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.maxSize=800,this.minSize=600,this.unloadPercent=.05,this.itemSet=new Map,this.itemList=[],this.usedSet=new Set,this.callbacks=new Map,this.unloadPriorityCallback=null;var i=this.itemSet;this.defaultPriorityCallback=function(t){return i.get(t)}}var i,n,e;return i=t,(n=[{key:"isFull",value:function(){return this.itemSet.size>=this.maxSize}},{key:"add",value:function(t,i){var n,e,r,o=this.itemSet;return!o.has(t)&&!this.isFull()&&(n=this.usedSet,e=this.itemList,r=this.callbacks,e.push(t),n.add(t),o.set(t,Date.now()),r.set(t,i),!0)}},{key:"remove",value:function(t){var i,n=this.usedSet,e=this.itemSet,r=this.itemList,o=this.callbacks;return!!e.has(t)&&(o.get(t)(t),i=r.indexOf(t),r.splice(i,1),n.delete(t),e.delete(t),o.delete(t),!0)}},{key:"markUsed",value:function(t){var i=this.itemSet,n=this.usedSet;i.has(t)&&!n.has(t)&&(i.set(t,Date.now()),n.add(t))}},{key:"markAllUnused",value:function(){this.usedSet.clear()}},{key:"unloadUnusedContent",value:function(){var t=this.unloadPercent,i=this.minSize,n=this.itemList,e=this.itemSet,r=this.usedSet,o=this.callbacks,s=n.length-r.size,u=n.length-i,h=this.unloadPriorityCallback||this.defaultPriorityCallback;if(0<u&&0<s){n.sort(function(t,i){var n=r.has(t),e=r.has(i);return n&&e?0:n||e?n?1:-1:h(i)-h(t)});for(var u=Math.min(u,s),i=Math.max(i*t,u*t),u=Math.min(i,s),u=Math.ceil(u),a=n.splice(0,u),c=0,f=a.length;c<f;c++){var l=a[c];o.get(l)(l),e.delete(l),o.delete(l)}}}},{key:"scheduleUnload",value:function(){var t=this,i=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.scheduled||(this.scheduled=!0,Promise.resolve().then(function(){t.scheduled=!1,t.unloadUnusedContent(),i&&t.markAllUnused()}))}}])&&Sf(i.prototype,n),e&&Sf(i,e),Object.defineProperty(i,"prototype",{writable:!1}),t}();function Ef(t){return(Ef="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kf(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Ef(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Ef(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Ef(t)?t:String(t)}(e.key),e)}}var Tf=function(){function i(){var t=this;if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.maxJobs=6,this.items=[],this.callbacks=new Map,this.currJobs=0,this.scheduled=!1,this.autoUpdate=!0,this.priorityCallback=function(){throw new Error("PriorityQueue: PriorityCallback function not defined.")},this.schedulingCallback=function(t){requestAnimationFrame(t)},this.Et=function(){t.tryRunJobs(),t.scheduled=!1}}var t,n,e;return t=i,(n=[{key:"sort",value:function(){var t=this.priorityCallback;this.items.sort(t)}},{key:"add",value:function(r,o){var s=this;return new Promise(function(t,i){var n=s.items,e=s.callbacks;n.push(r),e.set(r,function(){return o.apply(void 0,arguments).then(t).catch(i)}),s.autoUpdate&&s.scheduleJobRun()})}},{key:"remove",value:function(t){var i=this.items,n=this.callbacks,e=i.indexOf(t);-1!==e&&(i.splice(e,1),n.delete(t))}},{key:"tryRunJobs",value:function(){for(var t=this,i=(this.sort(),this.items),n=this.callbacks,e=this.maxJobs,r=this.currJobs;r<e&&0<i.length;){r++;var o=i.pop(),s=n.get(o);n.delete(o),s(o).then(function(){t.currJobs--,t.autoUpdate&&t.scheduleJobRun()}).catch(function(){t.currJobs--,t.autoUpdate&&t.scheduleJobRun()})}this.currJobs=r}},{key:"scheduleJobRun",value:function(){this.scheduled||(this.schedulingCallback(this.Et),this.scheduled=!0)}}])&&kf(t.prototype,n),e&&kf(t,e),Object.defineProperty(t,"prototype",{writable:!1}),i}(),Rf=3,Af=4,xf=6378137;function Pf(t){return t===Rf||t===Af}function Cf(t,i){return t.kt===i&&t.Tt}function Lf(t,i){t.kt!==i&&(t.kt=i,t.Tt=!1,t.Rt=!1,t.At=!1,t.xt=!1,t.Pt=!1,t.Ct=1/0,t.Lt=1/0,t.It=!1,t.Nt=!1)}function If(t,i,n,e,r){var o=1<arguments.length&&void 0!==i?i:null,s=2<arguments.length&&void 0!==n?n:null,i=3<arguments.length&&void 0!==e?e:null,u=4<arguments.length&&void 0!==r?r:0;if(!o||!o(t,i,u))for(var h=t.children,a=0,c=h.length;a<c;a++)If(h[a],o,s,t,u+1);s&&s(t,i,u)}function Nf(t,i){var n=i.stats,e=i.frameCount,r=i.errorTarget,o=i.maxDepth,s=i.loadSiblings,u=i.lruCache,h=i.stopAtEmptyTiles;if(Lf(t,e),!1===i.tileInView(t))return!1;if(t.Tt=!0,u.markUsed(t),t.Rt=!0,n.inFrustum++,(h||!t.Bt)&&!t.Dt){if(i.calculateError(t),t.Ct<=r)return!0;if(0<i.maxDepth&&t.Ft+1>=o)return!0}for(var a=!1,c=t.children,f=0,l=c.length;f<l;f++)var v=Nf(c[f],i),a=a||v;if(a&&s)for(var y=0,d=c.length;y<d;y++)!function t(i,n,e){if(Lf(i,n),i.Tt=!0,e.markUsed(i),i.Bt)for(var r=i.children,o=0,s=r.length;o<s;o++)t(r[o],n,e)}(c[y],e,u);return!0}function Bf(t,i){var n=i.stats,e=i.frameCount;if(Cf(t,e)){var r=t.parent,r=r?r._t:-1,o=(t._t=r,i.lruCache);if(t.At)t._t++,t.Ht===Rf?(t.Rt&&(t.xt=!0,n.visible++),t.Pt=!0,n.active++):o.isFull()||t.Bt&&!t.Dt||i.requestTileContents(t);else{var r=(i.errorTarget+1)*i.errorThreshold,r=t.Ct<=r,s=r||"ADD"===t.refine,u=!t.Bt,h=u||t.Dt,a=Pf(t.Ht)&&h,c=t.It,f=t.children,l=t.Nt;if(s&&u&&t._t++,s&&!a&&!o.isFull()&&h&&i.requestTileContents(t),(r&&!l&&!c&&a||"ADD"===t.refine&&a)&&(t.Rt&&(t.xt=!0,n.visible++),t.Pt=!0,n.active++),"ADD"!==t.refine&&r&&!l&&a)for(var v=0,y=f.length;v<y;v++){var d=f[v];Cf(d,e)&&!o.isFull()&&(d._t=t._t+1,function t(i,n,e){if(!i.Bt||i.Dt&&!Pf(i.Ht))e.requestTileContents(i);else for(var r=i.children,o=0,s=r.length;o<s;o++){var u=r[o];u._t=n,t(u,n,e)}}(d,d._t,i))}else for(var b=0,p=f.length;b<p;b++){var m=f[b];Cf(m,e)&&Bf(m,i)}}}}function Df(t){return(Df="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ff(t,i,n){(i=function(t){t=function(t,i){if("object"!==Df(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Df(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Df(t)?t:String(t)}(i))in t?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n}function _f(s,t){var u=1<arguments.length&&void 0!==t?t:{};return new Promise(function(i,n){var t=u.method||"GET",e=u.responseType||"json",r=u.xhr||new XMLHttpRequest,o=(r.addEventListener("timeout",function(){n({errorType:"timeout_error",xhr:r})}),r.addEventListener("abort",function(){n({errorType:"abort",xhr:r})}),r.addEventListener("error",function(t){n({errorType:"onerror",xhr:r,error:t})}),{arraybuffer:"arrayBuffer",json:"json"});r.addEventListener("load",function(){var t;200===r.status||0===r.status||201===r.status?(Ff(t={},o[e],function(){return r.response}),Ff(t,"ok",!0),i(t)):n({errorType:"loadError",xhr:r})}),"POST"===t?(r.open("POST",s,!0),r.responseType=e,r.setRequestHeader("Accept","application/json"),r.send(JSON.parse(u.data))):(r.open("GET",s,!0),r.responseType=e,r.send())})}function Hf(t){return(Hf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Uf(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Hf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Hf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Hf(t)?t:String(t)}(e.key),e)}}function Gf(t,i){return t.Ft!==i.Ft?t.Ft>i.Ft?-1:1:t.Rt!==i.Rt?t.Rt?1:-1:t.Tt!==i.Tt?t.Tt?1:-1:t.Ct!==i.Ct?t.Ct>i.Ct?1:-1:t.Lt!==i.Lt?t.Lt>i.Lt?-1:1:0}function Vf(t){return 1/(t._t+1)}var qf=function(){function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.tileSets={},this.rootURL=t,this.fetchOptions={},this.preprocessURL=null;var t=new Of,i=(t.unloadPriorityCallback=Vf,new Tf),n=(i.maxJobs=4,i.priorityCallback=Gf,new Tf);n.maxJobs=1,n.priorityCallback=Gf,this.lruCache=t,this.downloadQueue=i,this.parseQueue=n,this.stats={parsing:0,downloading:0,failed:0,inFrustum:0,used:0,active:0,visible:0},this.frameCount=0,this.errorTarget=6,this.errorThreshold=1/0,this.loadSiblings=!0,this.displayActiveTiles=!1,this.maxDepth=1/0,this.stopAtEmptyTiles=!0}var t,i,n;return t=e,(i=[{key:"rootTileSet",get:function(){var t=this.tileSets[this.rootURL];return!t||t instanceof Promise?null:t}},{key:"root",get:function(){var t=this.rootTileSet;return t?t.root:null}},{key:"traverse",value:function(t,i){var n=this.tileSets[this.rootURL];n&&n.root&&If(n.root,t,i)}},{key:"update",value:function(){var t=this.stats,i=this.lruCache,n=this.tileSets,e=n[this.rootURL];this.rootURL in n?e&&e.root&&(n=e.root,t.inFrustum=0,t.used=0,t.active=0,t.visible=0,this.frameCount++,Nf(n,this),function t(i,n){var e=n.stats,r=n.frameCount;if(Cf(i,r)){e.used++;for(var o=i.children,s=!1,u=0,h=o.length;u<h;u++)var a=o[u],s=s||Cf(a,r);if(s){for(var c=!1,f=!0,l=0,v=o.length;l<v;l++){var y=o[l];t(y,n),c=c||y.Ut||y.It,Cf(y,r)&&(y=y.Nt||!y.Bt&&Pf(y.Ht)||y.Dt&&y.Ht===Af,f=f&&y)}i.It=c,i.Nt=f}else i.At=!0}}(n,this),Bf(n,this),function t(i,n){var e=Cf(i,n.frameCount);if(e||i.Gt)for(var r=!1,o=!1,s=(e&&(r=i.Pt,o=n.displayActiveTiles&&i.Pt||i.xt),i.Bt||i.Ht!==Rf||(i.Vt!==r&&n.setTileActive(i,r),i.Ut!==o&&n.setTileVisible(i,o)),i.Vt=r,i.Ut=o,i.Gt=e,i.children),u=0,h=s.length;u<h;u++)t(s[u],n)}(n,this),i.scheduleUnload()):this.loadRootTileSet(this.rootURL)}},{key:"parseTile",value:function(t,i,n){return null}},{key:"disposeTile",value:function(t){}},{key:"preprocessNode",value:function(t,i,n){t.content&&(!("uri"in t.content)&&"url"in t.content&&(t.content.uri=t.content.url,delete t.content.url),t.content.uri&&(t.content.uri=new URL(t.content.uri,n+"/").toString()),t.content.boundingVolume)&&!("box"in t.content.boundingVolume||"sphere"in t.content.boundingVolume||"region"in t.content.boundingVolume)&&delete t.content.boundingVolume,t.parent=i,t.children=t.children||[],t.content&&t.content.uri?(n=jf(t.content.uri),n=Boolean(n&&"json"===n.toLowerCase()),t.Dt=n,t.Bt=n):(t.Dt=!1,t.Bt=!0),t.Lt=1/0,t.Ct=1/0,t.Rt=!1,t.At=!1,t.Gt=!1,t.Tt=!1,t.Ut=!1,t.xt=!1,t.It=!1,t.Nt=!1,t.Vt=!1,t.Pt=!1,t.Ht=0,t.qt=0,t.zt=null,t._t=-1,null===i?(t.Ft=0,t.refine=t.refine||"REPLACE"):(t.Ft=i.Ft+1,t.refine=t.refine||i.refine)}},{key:"setTileActive",value:function(t,i){}},{key:"setTileVisible",value:function(t,i){}},{key:"calculateError",value:function(t){return 0}},{key:"tileInView",value:function(t){return!0}},{key:"resetFailedTiles",value:function(){var t=this.stats;0!==t.failed&&(this.traverse(function(t){t.Ht===Af&&(t.Ht=0)}),t.failed=0)}},{key:"fetchTileSet",value:function(e,t){var r=this,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return _f(e,t).then(function(t){if(t.ok)return t.json();throw new Error('TilesRenderer: Failed to load tileset "'.concat(e,'" with status ').concat(t.status," : ").concat(t.statusText))}).then(function(t){var i=t.asset.version,n=(console.assert("1.0"===i||"0.0"===i,'asset.version is expected to be a string of "1.0" or "0.0"'),e.replace(/\/[^\/]*\/?$/,"")),n=new URL(n,window.location.href).toString();return If(t.root,function(t,i){return r.preprocessNode(t,i,n)},null,o,o?o.Ft:0),t})}},{key:"loadRootTileSet",value:function(i){var t,n=this.tileSets;return i in n?n[i]instanceof Error?Promise.reject(n[i]):Promise.resolve(n[i]):((t=this.fetchTileSet(this.preprocessURL?this.preprocessURL(i):i,this.fetchOptions).then(function(t){n[i]=t})).catch(function(t){console.error(t),n[i]=t}),n[i]=t)}},{key:"requestTileContents",value:function(i){var e,n,r,o,s,u,h,t,a=this;0===i.Ht&&(e=this.stats,n=this.lruCache,r=this.downloadQueue,o=this.parseQueue,s=i.Dt,n.add(i,function(t){1===t.Ht?(t.zt.abort(),t.zt=null):s?t.children.length=0:a.disposeTile(t),1===t.Ht?e.downloading--:2===t.Ht&&e.parsing--,t.Ht=0,t.qt++,o.remove(t),r.remove(t)}),i.qt++,u=i.qt,h=new XMLHttpRequest,e.downloading++,i.zt={abort:h.abort.bind(h)},i.Ht=1,t=function(t){i.qt===u&&("AbortError"!==t.name?(o.remove(i),r.remove(i),2===i.Ht?e.parsing--:1===i.Ht&&e.downloading--,e.failed++,console.error('TilesRenderer : Failed to load tile at url "'.concat(i.content.uri,'".')),console.error(t),i.Ht=Af):n.remove(i))},(s?r.add(i,function(t){var i;return t.qt!==u?Promise.resolve():(i=a.preprocessURL?a.preprocessURL(t.content.uri):t.content.uri,a.fetchTileSet(i,Object.assign({xhr:h,responseType:"json"},a.fetchOptions),t))}).then(function(t){i.qt===u&&(e.downloading--,i.zt=null,i.Ht=Rf,i.children.push(t.root))}):r.add(i,function(t){return t.qt!==u?Promise.resolve():_f(a.preprocessURL?a.preprocessURL(t.content.uri):t.content.uri,Object.assign({xhr:h,responseType:"arraybuffer"},a.fetchOptions))}).then(function(t){if(i.qt===u){if(t.ok)return t.arrayBuffer();throw new Error("Failed to load model with error code ".concat(t.status))}}).then(function(n){if(i.qt===u)return e.downloading--,e.parsing++,i.zt=null,i.Ht=2,o.add(i,function(t){var i;return t.qt!==u?Promise.resolve():(i=jf(t.content.uri),a.parseTile(n,t,i))})}).then(function(){i.qt===u&&(e.parsing--,i.Ht=Rf,i.Ut&&a.setTileVisible(i,!0),i.Vt)&&a.setTileActive(i,!0)})).catch(t))}},{key:"dispose",value:function(){var i=this.lruCache;this.traverse(function(t){i.remove(t)}),this.stats={parsing:0,downloading:0,failed:0,inFrustum:0,used:0,active:0,visible:0},this.frameCount=0}}])&&Uf(t.prototype,i),n&&Uf(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function zf(t){return(zf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xf(){return(Xf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,n){var e=function(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=Yf(t)););return t}(t,i);if(e)return(e=Object.getOwnPropertyDescriptor(e,i)).get?e.get.call(arguments.length<3?t:n):e.value}).apply(this,arguments)}function Zf(t,i){return(Zf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function Wf(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Yf(n),i=(t=e?(t=Yf(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===zf(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Yf(t){return(Yf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Kf(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function Qf(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==zf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==zf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===zf(t)?t:String(t)}(e.key),e)}}function $f(t,i,n){i&&Qf(t.prototype,i),n&&Qf(t,n),Object.defineProperty(t,"prototype",{writable:!1})}var Jf=function(){function r(t,i,n,e){Kf(this,r),this.buffer=t,this.binOffset=i+n,this.binLength=e;e=null;e=0!==n?(t=new Uint8Array(t,i,n),JSON.parse((i=t,(new TextDecoder).decode(i)))):{},this.header=e}return $f(r,[{key:"getKeys",value:function(){return Object.keys(this.header)}},{key:"getData",value:function(t,i){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,r=this.header;if(!(t in r))return null;r=r[t];if(r instanceof Object){if(Array.isArray(r))return r;var o,s,u=this.buffer,h=this.binOffset,a=this.binLength,c=r.byteOffset||0,f=r.type||e,n=r.componentType||n;if("type"in r&&e&&r.type!==e)throw new Error("FeatureTable: Specified type does not match expected type.");switch(f){case"SCALAR":o=1;break;case"VEC2":o=2;break;case"VEC3":o=3;break;case"VEC4":o=4;break;default:throw new Error('FeatureTable : Feature type not provided for "'.concat(t,'".'))}var l=h+c,v=i*o;switch(n){case"BYTE":s=new Int8Array(u,l,v);break;case"UNSIGNED_BYTE":s=new Uint8Array(u,l,v);break;case"SHORT":s=new Int16Array(u,l,v);break;case"UNSIGNED_SHORT":s=new Uint16Array(u,l,v);break;case"INT":s=new Int32Array(u,l,v);break;case"UNSIGNED_INT":s=new Uint32Array(u,l,v);break;case"FLOAT":s=new Float32Array(u,l,v);break;case"DOUBLE":s=new Float64Array(u,l,v);break;default:throw new Error('FeatureTable : Feature component type not provided for "'.concat(t,'".'))}if(h+a<l+v*s.BYTES_PER_ELEMENT)throw new Error("FeatureTable: Feature data read outside binary body length.");return s}return r}}]),r}(),tl=function(){var t=s,i=Jf;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&Zf(t,i);var o=Wf(s);function s(t,i,n,e,r){return Kf(this,s),(t=o.call(this,t,n,e,r)).batchSize=i,t}return $f(s,[{key:"getData",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return Xf(Yf(s.prototype),"getData",this).call(this,t,this.batchSize,i,n)}}]),s}();function il(t){return(il="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nl(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==il(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==il(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===il(t)?t:String(t)}(e.key),e)}}var el=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.fetchOptions={},this.workingPath=""}var i,n,e;return i=t,(n=[{key:"load",value:function(i){var n=this;return fetch(i,this.fetchOptions).then(function(t){if(t.ok)return t.arrayBuffer();throw new Error('Failed to load file "'.concat(i,'" with status ').concat(t.status," : ").concat(t.statusText))}).then(function(t){return""===n.workingPath&&(n.workingPath=n.workingPathForURL(i)),n.parse(t)})}},{key:"resolveExternalURL",value:function(t){return/^[^\\/]/.test(t)?this.workingPath+"/"+t:t}},{key:"workingPathForURL",value:function(t){t=t.split(/[\\/]/g);return t.pop(),t.join("/")+"/"}},{key:"parse",value:function(t){throw new Error("LoaderBase: Parse not implemented.")}}])&&nl(i.prototype,n),e&&nl(i,e),Object.defineProperty(i,"prototype",{writable:!1}),t}();function rl(t){var i=t instanceof DataView?t:new DataView(t);if("{"===String.fromCharCode(i.getUint8(0)))return null;for(var n="",e=0;e<4;e++)n+=String.fromCharCode(i.getUint8(e));return n}function ol(t){return(ol="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sl(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==ol(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==ol(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===ol(t)?t:String(t)}(e.key),e)}}function ul(t,i){return(ul=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function hl(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=al(n),i=(t=e?(t=al(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===ol(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function al(t){return(al=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var cl=function(){var t=r,i=el;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&ul(t,i);var n,e=hl(r);function r(){var t=this,i=r;if(t instanceof i)return e.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"parse",value:function(t){var i=new DataView(t),n=rl(i),n=(console.assert("b3dm"===n),i.getUint32(4,!0)),e=(console.assert(1===n),i.getUint32(8,!0)),r=(console.assert(e===t.byteLength),i.getUint32(12,!0)),o=i.getUint32(16,!0),s=i.getUint32(20,!0),i=i.getUint32(24,!0),u=t.slice(28,28+r+o),u=new Jf(u,0,r,o),r=28+r+o,o=t.slice(r,r+s+i),o=new tl(o,u.getData("BATCH_LENGTH"),0,s,i),r=r+s+i;return{version:n,featureTable:u,batchTable:o,glbBytes:new Uint8Array(t,r,e-r)}}}])&&sl(t.prototype,i),n&&sl(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function fl(t,i,n){var e=this,r=!1,o=0,s=0,u=void 0,h=[];this.onStart=void 0,this.onLoad=t,this.onProgress=i,this.onError=n,this.itemStart=function(t){s++,!1===r&&void 0!==e.onStart&&e.onStart(t,o,s),r=!0},this.itemEnd=function(t){o++,void 0!==e.onProgress&&e.onProgress(t,o,s),o===s&&(r=!1,void 0!==e.onLoad)&&e.onLoad()},this.itemError=function(t){void 0!==e.onError&&e.onError(t)},this.resolveURL=function(t){return u?u(t):t},this.setURLModifier=function(t){return u=t,this},this.addHandler=function(t,i){return h.push(t,i),this},this.removeHandler=function(t){t=h.indexOf(t);return-1!==t&&h.splice(t,2),this},this.getHandler=function(t){for(var i=0,n=h.length;i<n;i+=2){var e=h[i],r=h[i+1];if(e.global&&(e.lastIndex=0),e.test(t))return r}return null},this.isLoaded=function(){return o===s}}var ll=new fl;function vl(t,i){u.call(this),this.type="Light",this.color=new y(t),this.intensity=void 0!==i?i:1,this.receiveShadow=void 0}vl.prototype=Object.assign(Object.create(u.prototype),{constructor:vl,isLight:!0,copy:function(t){return u.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this}});var yl=new ci,dl=new j;function bl(t,i,n,e,r,o){this.planes=[void 0!==t?t:new Ri,void 0!==i?i:new Ri,void 0!==n?n:new Ri,void 0!==e?e:new Ri,void 0!==r?r:new Ri,void 0!==o?o:new Ri]}function pl(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new I(512,512),this.map=null,this.mapPass=null,this.matrix=new p,this.Xt=new bl,this.Zt=new I(1,1),this.Wt=1,this.Yt=[new Dt(0,0,1,1)]}function ml(){u.call(this),this.type="Camera",this.matrixWorldInverse=new p,this.projectionMatrix=new p,this.projectionMatrixInverse=new p}function wl(t,i,n,e,r,o){ml.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==t?t:-1,this.right=void 0!==i?i:1,this.top=void 0!==n?n:1,this.bottom=void 0!==e?e:-1,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function gl(){pl.call(this,new wl(-5,5,5,-5,.5,500))}function jl(t,i){vl.call(this,t,i),this.type="DirectionalLight",this.position.copy(u.DefaultUp),this.updateMatrix(),this.target=new u,this.shadow=new gl}Object.assign(bl.prototype,{set:function(t,i,n,e,r,o){var s=this.planes;return s[0].copy(t),s[1].copy(i),s[2].copy(n),s[3].copy(e),s[4].copy(r),s[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var i=this.planes,n=0;n<6;n++)i[n].copy(t.planes[n]);return this},setFromProjectionMatrix:function(t){var i=this.planes,t=t.elements,n=t[0],e=t[1],r=t[2],o=t[3],s=t[4],u=t[5],h=t[6],a=t[7],c=t[8],f=t[9],l=t[10],v=t[11],y=t[12],d=t[13],b=t[14],t=t[15];return i[0].setComponents(o-n,a-s,v-c,t-y).normalize(),i[1].setComponents(o+n,a+s,v+c,t+y).normalize(),i[2].setComponents(o+e,a+u,v+f,t+d).normalize(),i[3].setComponents(o-e,a-u,v-f,t-d).normalize(),i[4].setComponents(o-r,a-h,v-l,t-b).normalize(),i[5].setComponents(o+r,a+h,v+l,t+b).normalize(),this},intersectsObject:function(t){var i=t.geometry;return null===i.boundingSphere&&i.computeBoundingSphere(),yl.copy(i.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(yl)},intersectsSprite:function(t){return yl.center.set(0,0,0),yl.radius=.7071067811865476,yl.applyMatrix4(t.matrixWorld),this.intersectsSphere(yl)},intersectsSphere:function(t){for(var i=this.planes,n=t.center,e=-t.radius,r=0;r<6;r++)if(i[r].distanceToPoint(n)<e)return!1;return!0},intersectsBox:function(t){for(var i=this.planes,n=0;n<6;n++){var e=i[n];if(dl.x=(0<e.normal.x?t.max:t.min).x,dl.y=(0<e.normal.y?t.max:t.min).y,dl.z=(0<e.normal.z?t.max:t.min).z,e.distanceToPoint(dl)<0)return!1}return!0},containsPoint:function(t){for(var i=this.planes,n=0;n<6;n++)if(i[n].distanceToPoint(t)<0)return!1;return!0}}),Object.assign(pl.prototype,{Kt:new p,Qt:new j,$t:new j,getViewportCount:function(){return this.Wt},getFrustum:function(){return this.Xt},updateMatrices:function(t){var i=this.camera,n=this.matrix,e=this.Kt,r=this.$t,o=this.Qt;o.setFromMatrixPosition(t.matrixWorld),i.position.copy(o),r.setFromMatrixPosition(t.target.matrixWorld),i.lookAt(r),i.updateMatrixWorld(),e.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this.Xt.setFromProjectionMatrix(e),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(i.projectionMatrix),n.multiply(i.matrixWorldInverse)},getViewport:function(t){return this.Yt[t]},getFrameExtents:function(){return this.Zt},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)}}),ml.prototype=Object.assign(Object.create(u.prototype),{constructor:ml,isCamera:!0,copy:function(t,i){return u.prototype.copy.call(this,t,i),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new j),this.updateMatrixWorld(!0);var i=this.matrixWorld.elements;return t.set(-i[8],-i[9],-i[10]).normalize()},updateMatrixWorld:function(t){u.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,i){u.prototype.updateWorldMatrix.call(this,t,i),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),wl.prototype=Object.assign(Object.create(ml.prototype),{constructor:wl,isOrthographicCamera:!0,copy:function(t,i){return ml.prototype.copy.call(this,t,i),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,i,n,e,r,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=e,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t,i=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),e=(this.right+this.left)/2,r=(this.top+this.bottom)/2,o=e-i,e=e+i,i=r+n,r=r-n;null!==this.view&&this.view.enabled&&(n=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom,e=(o+=n*this.view.offsetX)+n*this.view.width,r=(i-=t*this.view.offsetY)-t*this.view.height),this.projectionMatrix.makeOrthographic(o,e,i,r,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)}}),gl.prototype=Object.assign(Object.create(pl.prototype),{constructor:gl,isDirectionalLightShadow:!0,updateMatrices:function(t){pl.prototype.updateMatrices.call(this,t)}}),jl.prototype=Object.assign(Object.create(vl.prototype),{constructor:jl,isDirectionalLight:!0,copy:function(t){return vl.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}});var Ml={enabled:!1,files:{},add:function(t,i){!1!==this.enabled&&(this.files[t]=i)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function Sl(t){o.call(this,t)}function Ol(t){o.call(this,t)}function El(t){f.call(this),this.type="ShadowMaterial",this.color=new y(0),this.transparent=!0,this.setValues(t)}function kl(t){f.call(this),this.type="SpriteMaterial",this.color=new y(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}function Tl(t){var i,n={};for(i in t)for(var e in n[i]={},t[i]){var r=t[i][e];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?n[i][e]=r.clone():Array.isArray(r)?n[i][e]=r.slice():n[i][e]=r}return n}Sl.prototype=Object.assign(Object.create(o.prototype),{constructor:Sl,load:function(i,t,n,e){void 0!==this.path&&(i=this.path+i),i=this.manager.resolveURL(i);var r,o=this,s=Ml.get(i);return void 0!==s?(o.manager.itemStart(i),setTimeout(function(){t&&t(s),o.manager.itemEnd(i)},0),s):((r=document.createElementNS("http://www.w3.org/1999/xhtml","img")).addEventListener("load",u,!1),r.addEventListener("error",h,!1),"data:"!==i.substr(0,5)&&void 0!==this.crossOrigin&&(r.crossOrigin=this.crossOrigin),o.manager.itemStart(i),r.src=i,r);function u(){r.removeEventListener("load",u,!1),r.removeEventListener("error",h,!1),Ml.add(i,this),t&&t(this),o.manager.itemEnd(i)}function h(t){r.removeEventListener("load",u,!1),r.removeEventListener("error",h,!1),e&&e(t),o.manager.itemError(i),o.manager.itemEnd(i)}}}),Ol.prototype=Object.assign(Object.create(o.prototype),{constructor:Ol,load:function(i,n,t,e){var r=new Si,o=new Sl(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(i,function(t){r.image=t;t=0<i.search(/\.jpe?g($|\?)/i)||0===i.search(/^data\:image\/jpeg/);r.format=t?1022:1023,r.needsUpdate=!0,void 0!==n&&n(r)},t,e),r}}),((El.prototype=Object.create(f.prototype)).constructor=El).prototype.isShadowMaterial=!0,El.prototype.copy=function(t){return f.prototype.copy.call(this,t),this.color.copy(t.color),this},((kl.prototype=Object.create(f.prototype)).constructor=kl).prototype.isSpriteMaterial=!0,kl.prototype.copy=function(t){return f.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};var Rl="\nvoid main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",Al="\nvoid main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}\n";function xl(t){f.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=Rl,this.fragmentShader=Al,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function Pl(t){xl.call(this,t),this.type="RawShaderMaterial"}function Cl(t){f.call(this),this.type="PointsMaterial",this.color=new y(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}function Ll(t){f.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new y(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new y(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$t,this.normalScale=new I(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(t)}function Il(t){Ll.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new I(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transparency=0,this.setValues(t)}function Nl(t){f.call(this),this.type="MeshPhongMaterial",this.color=new y(16777215),this.specular=new y(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new y(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$t,this.normalScale=new I(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Xt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Bl(t){f.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new y(16777215),this.specular=new y(1118481),this.shininess=30,this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new y(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$t,this.normalScale=new I(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Dl(t){f.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$t,this.normalScale=new I(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Fl(t){f.call(this),this.type="MeshLambertMaterial",this.color=new y(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new y(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Xt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function _l(t){f.call(this),this.type="MeshDepthMaterial",this.depthPacking=Qt,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function Hl(t){f.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new j,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}function Ul(t){f.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new y(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$t,this.normalScale=new I(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Gl(t){f.call(this),this.type="LineBasicMaterial",this.color=new y(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}function Vl(t){Gl.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}function ql(t){o.call(this,t),this.textures={}}((xl.prototype=Object.create(f.prototype)).constructor=xl).prototype.isShaderMaterial=!0,xl.prototype.copy=function(t){return f.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Tl(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},((Pl.prototype=Object.create(xl.prototype)).constructor=Pl).prototype.isRawShaderMaterial=!0,((Cl.prototype=Object.create(f.prototype)).constructor=Cl).prototype.isPointsMaterial=!0,Cl.prototype.copy=function(t){return f.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this},((Ll.prototype=Object.create(f.prototype)).constructor=Ll).prototype.isMeshStandardMaterial=!0,Ll.prototype.copy=function(t){return f.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},((Il.prototype=Object.create(Ll.prototype)).constructor=Il).prototype.isMeshPhysicalMaterial=!0,Il.prototype.copy=function(t){return Ll.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,t.sheen?this.sheen=(this.sheen||new y).copy(t.sheen):this.sheen=null,this.transparency=t.transparency,this},((Nl.prototype=Object.create(f.prototype)).constructor=Nl).prototype.isMeshPhongMaterial=!0,Nl.prototype.copy=function(t){return f.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((Bl.prototype=Object.create(f.prototype)).constructor=Bl).prototype.isMeshToonMaterial=!0,Bl.prototype.copy=function(t){return f.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((Dl.prototype=Object.create(f.prototype)).constructor=Dl).prototype.isMeshNormalMaterial=!0,Dl.prototype.copy=function(t){return f.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((Fl.prototype=Object.create(f.prototype)).constructor=Fl).prototype.isMeshLambertMaterial=!0,Fl.prototype.copy=function(t){return f.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((_l.prototype=Object.create(f.prototype)).constructor=_l).prototype.isMeshDepthMaterial=!0,_l.prototype.copy=function(t){return f.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},((Hl.prototype=Object.create(f.prototype)).constructor=Hl).prototype.isMeshDistanceMaterial=!0,Hl.prototype.copy=function(t){return f.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},((Ul.prototype=Object.create(f.prototype)).constructor=Ul).prototype.isMeshMatcapMaterial=!0,Ul.prototype.copy=function(t){return f.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((Gl.prototype=Object.create(f.prototype)).constructor=Gl).prototype.isLineBasicMaterial=!0,Gl.prototype.copy=function(t){return f.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},((Vl.prototype=Object.create(Gl.prototype)).constructor=Vl).prototype.isLineDashedMaterial=!0,Vl.prototype.copy=function(t){return Gl.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this},ql.prototype=Object.assign(Object.create(o.prototype),{constructor:ql,load:function(t,i,n,e){var r=this,o=new Kl(r.manager);o.setPath(r.path),o.load(t,function(t){i(r.parse(JSON.parse(t)))},n,e)},parse:function(t){var i=this.textures;function n(t){return void 0===i[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),i[t]}var e,r=new h[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.sheen&&(r.sheen=(new y).setHex(t.sheen)),void 0!==t.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearcoat&&(r.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(r.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.combine&&(r.combine=t.combine),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(r.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(r.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(r.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(r.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(r.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(r.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(r.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(r.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),1!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.polygonOffset&&(r.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(r.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(r.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(r.skinning=t.skinning),void 0!==t.morphTargets&&(r.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(r.morphNormals=t.morphNormals),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.vertexTangents&&(r.vertexTangents=t.vertexTangents),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.toneMapped&&(r.toneMapped=t.toneMapped),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.vertexColors&&("number"==typeof t.vertexColors?r.vertexColors=0<t.vertexColors:r.vertexColors=t.vertexColors),void 0!==t.uniforms)for(var o in t.uniforms){var s=t.uniforms[o];switch(r.uniforms[o]={},s.type){case"t":r.uniforms[o].value=n(s.value);break;case"c":r.uniforms[o].value=(new y).setHex(s.value);break;case"v2":r.uniforms[o].value=(new I).fromArray(s.value);break;case"v3":r.uniforms[o].value=(new j).fromArray(s.value);break;case"v4":r.uniforms[o].value=(new Dt).fromArray(s.value);break;case"m3":r.uniforms[o].value=(new tt).fromArray(s.value);case"m4":r.uniforms[o].value=(new p).fromArray(s.value);break;default:r.uniforms[o].value=s.value}}if(void 0!==t.defines&&(r.defines=t.defines),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(var u in t.extensions)r.extensions[u]=t.extensions[u];return void 0!==t.shading&&(r.flatShading=1===t.shading),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=n(t.map)),void 0!==t.matcap&&(r.matcap=n(t.matcap)),void 0!==t.alphaMap&&(r.alphaMap=n(t.alphaMap)),void 0!==t.bumpMap&&(r.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=n(t.normalMap)),void 0!==t.normalMapType&&(r.normalMapType=t.normalMapType),void 0!==t.normalScale&&(e=t.normalScale,!1===Array.isArray(e)&&(e=[e,e]),r.normalScale=(new I).fromArray(e)),void 0!==t.displacementMap&&(r.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=n(t.specularMap)),void 0!==t.envMap&&(r.envMap=n(t.envMap)),void 0!==t.envMapIntensity&&(r.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(r.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(r.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=n(t.gradientMap)),void 0!==t.clearcoatMap&&(r.clearcoatMap=n(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(r.clearcoatNormalMap=n(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(r.clearcoatNormalScale=(new I).fromArray(t.clearcoatNormalScale)),r},setTextures:function(t){return this.textures=t,this}});var zl,Xl,Zl,Wl;function o(t){this.manager=void 0!==t?t:ll,this.crossOrigin="anonymous",this.path="",this.resourcePath=""}Object.assign(o.prototype,{load:function(){},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this}}),Object.assign(o.prototype,{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(t,i,n){for(var e=[],r=0;r<t.length;++r)e[r]=this.createMaterial(t[r],i,n);return e},createMaterial:(zl={NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5},Xl=new y,Zl=new Ol,Wl=new ql,function(t,s,u){var h={};function i(t,i,n,e,r){var t=s+t,o=(new fl).getHandler(t),o=(null!==o?o:(Zl.setCrossOrigin(u),Zl)).load(t),t=(void 0!==i&&(o.repeat.fromArray(i),1!==i[0]&&(o.wrapS=1e3),1!==i[1])&&(o.wrapT=1e3),void 0!==n&&o.offset.fromArray(n),void 0!==e&&("repeat"===e[0]&&(o.wrapS=1e3),"mirror"===e[0]&&(o.wrapS=1002),"repeat"===e[1]&&(o.wrapT=1e3),"mirror"===e[1])&&(o.wrapT=1002),void 0!==r&&(o.anisotropy=r),g.generateUUID());return h[t]=o,t}var n,e={uuid:g.generateUUID(),type:"MeshLambertMaterial"};for(n in t){var r=t[n];switch(n){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":e.name=r;break;case"blending":e.blending=zl[r];break;case"colorAmbient":case"mapAmbient":break;case"colorDiffuse":e.color=Xl.fromArray(r).getHex();break;case"colorSpecular":e.specular=Xl.fromArray(r).getHex();break;case"colorEmissive":e.emissive=Xl.fromArray(r).getHex();break;case"specularCoef":e.shininess=r;break;case"shading":"basic"===r.toLowerCase()&&(e.type="MeshBasicMaterial"),"phong"===r.toLowerCase()&&(e.type="MeshPhongMaterial"),"standard"===r.toLowerCase()&&(e.type="MeshStandardMaterial");break;case"mapDiffuse":e.map=i(r,t.mapDiffuseRepeat,t.mapDiffuseOffset,t.mapDiffuseWrap,t.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":e.emissiveMap=i(r,t.mapEmissiveRepeat,t.mapEmissiveOffset,t.mapEmissiveWrap,t.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":e.lightMap=i(r,t.mapLightRepeat,t.mapLightOffset,t.mapLightWrap,t.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":e.aoMap=i(r,t.mapAORepeat,t.mapAOOffset,t.mapAOWrap,t.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":e.bumpMap=i(r,t.mapBumpRepeat,t.mapBumpOffset,t.mapBumpWrap,t.mapBumpAnisotropy);break;case"mapBumpScale":e.bumpScale=r;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":e.normalMap=i(r,t.mapNormalRepeat,t.mapNormalOffset,t.mapNormalWrap,t.mapNormalAnisotropy);break;case"mapNormalFactor":e.normalScale=r;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":e.specularMap=i(r,t.mapSpecularRepeat,t.mapSpecularOffset,t.mapSpecularWrap,t.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":e.metalnessMap=i(r,t.mapMetalnessRepeat,t.mapMetalnessOffset,t.mapMetalnessWrap,t.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":e.roughnessMap=i(r,t.mapRoughnessRepeat,t.mapRoughnessOffset,t.mapRoughnessWrap,t.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":e.alphaMap=i(r,t.mapAlphaRepeat,t.mapAlphaOffset,t.mapAlphaWrap,t.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":e.side=1;break;case"doubleSided":e.side=2;break;case"transparency":e.opacity=r;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":e[n]=r;break;case"vertexColors":!0===r&&(e.vertexColors=2),"face"===r&&(e.vertexColors=1)}}return"MeshBasicMaterial"===e.type&&delete e.emissive,"MeshPhongMaterial"!==e.type&&delete e.specular,e.opacity<1&&(e.transparent=!0),Wl.setTextures(h),Wl.parse(e)})});var Yl={};function Kl(t){o.call(this,t)}Kl.prototype=Object.assign(Object.create(o.prototype),{constructor:Kl,load:function(s,t,i,n){void 0===s&&(s=""),void 0!==this.path&&(s=this.path+s),s=this.manager.resolveURL(s);var u=this,e=Ml.get(s);if(void 0!==e)return u.manager.itemStart(s),setTimeout(function(){t&&t(e),u.manager.itemEnd(s)},0),e;if(void 0===Yl[s]){var r=s.match(/^data:(.*?)(;base64)?,(.*)$/);if(r){var o=r[1],h=!!r[2],a=r[3],a=decodeURIComponent(a);h&&(a=atob(a));try{var c=(this.responseType||"").toLowerCase();switch(c){case"arraybuffer":case"blob":for(var f=new Uint8Array(a.length),l=0;l<a.length;l++)f[l]=a.charCodeAt(l);v="blob"===c?new Blob([f.buffer],{type:o}):f.buffer;break;case"document":var v=(new DOMParser).parseFromString(a,o);break;case"json":v=JSON.parse(a);break;default:v=a}setTimeout(function(){t&&t(v),u.manager.itemEnd(s)},0)}catch(t){setTimeout(function(){n&&n(t),u.manager.itemError(s),u.manager.itemEnd(s)},0)}}else{Yl[s]=[],Yl[s].push({onLoad:t,onProgress:i,onError:n});var y,d=new XMLHttpRequest;for(y in d.open("GET",s,!0),d.addEventListener("load",function(t){var i=this.response,n=Yl[s];if(delete Yl[s],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Ml.add(s,i);for(var e=0,r=n.length;e<r;e++)(o=n[e]).onLoad&&o.onLoad(i)}else{for(var o,e=0,r=n.length;e<r;e++)(o=n[e]).onError&&o.onError(t);u.manager.itemError(s)}u.manager.itemEnd(s)},!1),d.addEventListener("progress",function(t){for(var i=Yl[s],n=0,e=i.length;n<e;n++){var r=i[n];r.onProgress&&r.onProgress(t)}},!1),d.addEventListener("error",function(t){var i=Yl[s];delete Yl[s];for(var n=0,e=i.length;n<e;n++){var r=i[n];r.onError&&r.onError(t)}u.manager.itemError(s),u.manager.itemEnd(s)},!1),d.addEventListener("abort",function(t){var i=Yl[s];delete Yl[s];for(var n=0,e=i.length;n<e;n++){var r=i[n];r.onError&&r.onError(t)}u.manager.itemError(s),u.manager.itemEnd(s)},!1),void 0!==this.responseType&&(d.responseType=this.responseType),void 0!==this.withCredentials&&(d.withCredentials=this.withCredentials),d.overrideMimeType&&d.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)d.setRequestHeader(y,this.requestHeader[y]);d.send(null)}return u.manager.itemStart(s),d}Yl[s].push({onLoad:t,onProgress:i,onError:n})},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});var Ql=function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var i="",n=0,e=t.length;n<e;n++)i+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(i))}catch(t){return i}},$l=function(t){var i=t.lastIndexOf("/");return-1===i?"./":t.substr(0,i+1)};function Jl(t,i,n,e){ml.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==e?e:2e3,this.focus=10,this.aspect=void 0!==i?i:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function t0(){pl.call(this,new Jl(90,1,.5,500)),this.Zt=new I(4,2),this.Wt=6,this.Yt=[new Dt(2,1,1,1),new Dt(0,1,1,1),new Dt(3,1,1,1),new Dt(1,1,1,1),new Dt(3,0,1,1),new Dt(1,0,1,1)],this.Jt=[new j(1,0,0),new j(-1,0,0),new j(0,0,1),new j(0,0,-1),new j(0,1,0),new j(0,-1,0)],this.ti=[new j(0,1,0),new j(0,1,0),new j(0,1,0),new j(0,1,0),new j(0,0,1),new j(0,0,-1)]}function i0(t,i,n,e){vl.call(this,t,i),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==e?e:1,this.shadow=new t0}function n0(){pl.call(this,new Jl(50,1,.5,500))}function e0(t,i,n,e,r,o){vl.call(this,t,i),this.type="SpotLight",this.position.copy(u.DefaultUp),this.updateMatrix(),this.target=new u,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==e?e:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==o?o:1,this.shadow=new n0}function s(t,i,n,e){this.parameterPositions=t,this.ii=0,this.resultBuffer=void 0!==e?e:new i.constructor(n),this.sampleValues=i,this.valueSize=n}function r0(t,i){this.array=t,this.stride=i,this.count=void 0!==t?t.length/i:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}Jl.prototype=Object.assign(Object.create(ml.prototype),{constructor:Jl,isPerspectiveCamera:!0,copy:function(t,i){return ml.prototype.copy.call(this,t,i),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){t=.5*this.getFilmHeight()/t;this.fov=2*g.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*g.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*g.RAD2DEG*Math.atan(Math.tan(.5*g.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,i,n,e,r,o){this.aspect=t/i,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=e,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t,i=this.near,n=i*Math.tan(.5*g.DEG2RAD*this.fov)/this.zoom,e=2*n,r=this.aspect*e,o=-.5*r,s=this.view,u=(null!==this.view&&this.view.enabled&&(u=s.fullWidth,t=s.fullHeight,o+=s.offsetX*r/u,n-=s.offsetY*e/t,r*=s.width/u,e*=s.height/t),this.filmOffset);0!==u&&(o+=i*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+r,n,n-e,i,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)}}),t0.prototype=Object.assign(Object.create(pl.prototype),{constructor:t0,isPointLightShadow:!0,updateMatrices:function(t,i){void 0===i&&(i=0);var n=this.camera,e=this.matrix,r=this.Qt,o=this.$t,s=this.Kt;r.setFromMatrixPosition(t.matrixWorld),n.position.copy(r),o.copy(n.position),o.add(this.Jt[i]),n.up.copy(this.ti[i]),n.lookAt(o),n.updateMatrixWorld(),e.makeTranslation(-r.x,-r.y,-r.z),s.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this.Xt.setFromProjectionMatrix(s)}}),i0.prototype=Object.assign(Object.create(vl.prototype),{constructor:i0,isPointLight:!0,copy:function(t){return vl.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),n0.prototype=Object.assign(Object.create(pl.prototype),{constructor:n0,isSpotLightShadow:!0,updateMatrices:function(t){var i=this.camera,n=2*g.RAD2DEG*t.angle,e=this.mapSize.width/this.mapSize.height,r=t.distance||i.far;n===i.fov&&e===i.aspect&&r===i.far||(i.fov=n,i.aspect=e,i.far=r,i.updateProjectionMatrix()),pl.prototype.updateMatrices.call(this,t)}}),e0.prototype=Object.assign(Object.create(vl.prototype),{constructor:e0,isSpotLight:!0,copy:function(t){return vl.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Object.assign(s.prototype,{evaluate:function(t){var i,n=this.parameterPositions,e=this.ii,r=n[e],o=n[e-1];t:{i:{n:{e:if(!(t<r)){for(var s=e+2;;){if(void 0===r){if(t<o)break e;return e=n.length,this.ii=e,this.afterEnd_(e-1,t,o)}if(e===s)break;if(o=r,t<(r=n[++e]))break i}i=n.length;break n}if(o<=t)break t;var u=n[1];t<u&&(e=2,o=u);for(s=e-2;;){if(void 0===o)return this.ii=0,this.beforeStart_(0,t,r);if(e===s)break;if(r=o,(o=n[--e-1])<=t)break i}i=e,e=0}for(;e<i;){var h=e+i>>>1;t<n[h]?i=h:e=1+h}if(r=n[e],void 0===(o=n[e-1]))return this.ii=0,this.beforeStart_(0,t,r);if(void 0===r)return e=n.length,this.ii=e,this.afterEnd_(e-1,o,t)}this.ii=e,this.intervalChanged_(e,o,r)}return this.interpolate_(e,o,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var i=this.resultBuffer,n=this.sampleValues,e=this.valueSize,r=t*e,o=0;o!==e;++o)i[o]=n[r+o];return i},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(s.prototype,{beforeStart_:s.prototype.copySampleValue_,afterEnd_:s.prototype.copySampleValue_}),Object.defineProperty(r0.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(r0.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,i,n){t*=this.stride,n*=i.stride;for(var e=0,r=this.stride;e<r;e++)this.array[t+e]=i.array[n+e];return this},set:function(t,i){return this.array.set(t,i=void 0===i?0:i),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}});var o0=new j;function s0(t,i,n,e){this.data=t,this.itemSize=i,this.offset=n,this.normalized=!0===e}function u0(t,i){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),vn.call(this,t,i),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new p,this.bindMatrixInverse=new p}Object.defineProperties(s0.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(s0.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(var i=0,n=this.data.count;i<n;i++)o0.x=this.getX(i),o0.y=this.getY(i),o0.z=this.getZ(i),o0.applyMatrix4(t),this.setXYZ(i,o0.x,o0.y,o0.z);return this},setX:function(t,i){return this.data.array[t*this.data.stride+this.offset]=i,this},setY:function(t,i){return this.data.array[t*this.data.stride+this.offset+1]=i,this},setZ:function(t,i){return this.data.array[t*this.data.stride+this.offset+2]=i,this},setW:function(t,i){return this.data.array[t*this.data.stride+this.offset+3]=i,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,i,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=i,this.data.array[t+1]=n,this},setXYZ:function(t,i,n,e){return t=t*this.data.stride+this.offset,this.data.array[t+0]=i,this.data.array[t+1]=n,this.data.array[t+2]=e,this},setXYZW:function(t,i,n,e,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=i,this.data.array[t+1]=n,this.data.array[t+2]=e,this.data.array[t+3]=r,this}}),u0.prototype=Object.assign(Object.create(vn.prototype),{constructor:u0,isSkinnedMesh:!0,bind:function(t,i){this.skeleton=t,void 0===i&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),i=this.matrixWorld),this.bindMatrix.copy(i),this.bindMatrixInverse.getInverse(i)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new Dt,i=this.geometry.attributes.skinWeight,n=0,e=i.count;n<e;n++){t.x=i.getX(n),t.y=i.getY(n),t.z=i.getZ(n),t.w=i.getW(n);var r=1/t.manhattanLength();r!=1/0?t.multiplyScalar(r):t.set(1,0,0,0),i.setXYZW(n,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){vn.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var h0=new j,a0=new j,c0=new p,f0=new Bi,l0=new ci;function v0(t,i,n){1===n&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),u.call(this),this.type="Line",this.geometry=void 0!==t?t:new mi,this.material=void 0!==i?i:new Gl}v0.prototype=Object.assign(Object.create(u.prototype),{constructor:v0,isLine:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var i=t.attributes.position,n=[0],e=1,r=i.count;e<r;e++)h0.fromBufferAttribute(i,e-1),a0.fromBufferAttribute(i,e),n[e]=n[e-1],n[e]+=h0.distanceTo(a0);t.setAttribute("lineDistance",new S(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){var o=t.vertices;(n=t.lineDistances)[0]=0;for(e=1,r=o.length;e<r;e++)n[e]=n[e-1],n[e]+=o[e-1].distanceTo(o[e])}return this},raycast:function(t,i){var n=this.geometry,e=this.matrixWorld,r=t.params.Line.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),l0.copy(n.boundingSphere),l0.applyMatrix4(e),l0.radius+=r,!1!==t.ray.intersectsSphere(l0)){c0.getInverse(e),f0.copy(t.ray).applyMatrix4(c0);var e=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=e*e,s=new j,u=new j,h=new j,a=new j,c=this&&this.isLineSegments?2:1;if(n.isBufferGeometry){var r=n.index,f=n.attributes.position.array;if(null!==r)for(var l=r.array,v=0,y=l.length-1;v<y;v+=c){var d=l[v],b=l[v+1];s.fromArray(f,3*d),u.fromArray(f,3*b),o<f0.distanceSqToSegment(s,u,a,h)||(a.applyMatrix4(this.matrixWorld),(p=t.ray.origin.distanceTo(a))<t.near)||p>t.far||i.push({distance:p,point:h.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}else for(v=0,y=f.length/3-1;v<y;v+=c)s.fromArray(f,3*v),u.fromArray(f,3*v+3),o<f0.distanceSqToSegment(s,u,a,h)||(a.applyMatrix4(this.matrixWorld),(p=t.ray.origin.distanceTo(a))<t.near)||p>t.far||i.push({distance:p,point:h.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}else if(n.isGeometry)for(var p,m=n.vertices,w=m.length,v=0;v<w-1;v+=c)o<f0.distanceSqToSegment(m[v],m[v+1],a,h)||(a.applyMatrix4(this.matrixWorld),(p=t.ray.origin.distanceTo(a))<t.near)||p>t.far||i.push({distance:p,point:h.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var y0=new j,d0=new j;function b0(t,i){v0.call(this,t,i),this.type="LineSegments"}function p0(t,i){v0.call(this,t,i),this.type="LineLoop"}b0.prototype=Object.assign(Object.create(v0.prototype),{constructor:b0,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var i=t.attributes.position,n=[],e=0,r=i.count;e<r;e+=2)y0.fromBufferAttribute(i,e),d0.fromBufferAttribute(i,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+y0.distanceTo(d0);t.setAttribute("lineDistance",new S(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry)for(var o=t.vertices,n=t.lineDistances,e=0,r=o.length;e<r;e+=2)y0.copy(o[e]),d0.copy(o[e+1]),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+y0.distanceTo(d0);return this}}),p0.prototype=Object.assign(Object.create(v0.prototype),{constructor:p0,isLineLoop:!0});var m0=new p,w0=new Bi,g0=new ci,j0=new j;function M0(t,i){u.call(this),this.type="Points",this.geometry=void 0!==t?t:new mi,this.material=void 0!==i?i:new Cl,this.updateMorphTargets()}function S0(t,i,n,e,r,o,s){var u=w0.distanceSqToPoint(t);u<n&&(n=new j,w0.closestPointToPoint(t,n),n.applyMatrix4(e),(t=r.ray.origin.distanceTo(n))<r.near||t>r.far||o.push({distance:t,distanceToRay:Math.sqrt(u),point:n,index:i,face:null,object:s}))}function O0(t,i,n,e){s.call(this,t,i,n,e),this.ni=-0,this.ei=-0,this.ri=-0,this.oi=-0}function E0(t,i,n,e){s.call(this,t,i,n,e)}function k0(t,i,n,e){s.call(this,t,i,n,e)}M0.prototype=Object.assign(Object.create(u.prototype),{constructor:M0,isPoints:!0,raycast:function(t,i){var n=this.geometry,e=this.matrixWorld,r=t.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),g0.copy(n.boundingSphere),g0.applyMatrix4(e),g0.radius+=r,!1!==t.ray.intersectsSphere(g0)){m0.getInverse(e),w0.copy(t.ray).applyMatrix4(m0);var r=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=r*r;if(n.isBufferGeometry){var r=n.index,s=n.attributes.position.array;if(null!==r)for(var u=r.array,h=0,a=u.length;h<a;h++){var c=u[h];j0.fromArray(s,3*c),S0(j0,c,o,e,t,i,this)}else for(var h=0,f=s.length/3;h<f;h++)j0.fromArray(s,3*h),S0(j0,h,o,e,t,i,this)}else for(var l=n.vertices,h=0,f=l.length;h<f;h++)S0(l[h],h,o,e,t,i,this)}},updateMorphTargets:function(){var t,i,n,e=this.geometry;if(e.isBufferGeometry){var r=e.morphAttributes,o=Object.keys(r);if(0<o.length){var s=r[o[0]];if(void 0!==s)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,i=s.length;t<i;t++)n=s[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{r=e.morphTargets;void 0!==r&&0<r.length&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),O0.prototype=Object.assign(Object.create(s.prototype),{constructor:O0,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,i,n){var e=this.parameterPositions,r=t-2,o=t+1,s=e[r],u=e[o];if(void 0===s)switch(this.getSettings_().endingStart){case 2401:r=t,s=2*i-n;break;case 2402:s=i+e[r=e.length-2]-e[r+1];break;default:r=t,s=n}if(void 0===u)switch(this.getSettings_().endingEnd){case 2401:o=t,u=2*n-i;break;case 2402:u=n+e[o=1]-e[0];break;default:o=t-1,u=i}var h=.5*(n-i),a=this.valueSize;this.ni=h/(i-s),this.ri=h/(u-n),this.ei=r*a,this.oi=o*a},interpolate_:function(t,i,n,e){for(var r=this.resultBuffer,o=this.sampleValues,s=this.valueSize,u=t*s,h=u-s,a=this.ei,c=this.oi,t=this.ni,f=this.ri,n=(n-i)/(e-i),e=n*n,i=e*n,l=-t*i+2*t*e-t*n,v=(1+t)*i+(-1.5-2*t)*e+(-.5+t)*n+1,y=(-1-f)*i+(1.5+f)*e+.5*n,d=f*i-f*e,b=0;b!==s;++b)r[b]=l*o[a+b]+v*o[h+b]+y*o[u+b]+d*o[c+b];return r}}),E0.prototype=Object.assign(Object.create(s.prototype),{constructor:E0,interpolate_:function(t,i,n,e){for(var r=this.resultBuffer,o=this.sampleValues,s=this.valueSize,u=t*s,h=u-s,a=(n-i)/(e-i),c=1-a,f=0;f!==s;++f)r[f]=o[h+f]*c+o[u+f]*a;return r}}),k0.prototype=Object.assign(Object.create(s.prototype),{constructor:k0,interpolate_:function(t){return this.copySampleValue_(t-1)}});var m={arraySlice:function(t,i,n){return m.isTypedArray(t)?new t.constructor(t.subarray(i,void 0!==n?n:t.length)):t.slice(i,n)},convertArray:function(t,i,n){return!t||!n&&t.constructor===i?t:"number"==typeof i.BYTES_PER_ELEMENT?new i(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(n){for(var t=n.length,i=new Array(t),e=0;e!==t;++e)i[e]=e;return i.sort(function(t,i){return n[t]-n[i]}),i},sortedArray:function(t,i,n){for(var e=t.length,r=new t.constructor(e),o=0,s=0;s!==e;++o)for(var u=n[o]*i,h=0;h!==i;++h)r[s++]=t[u+h];return r},flattenJSON:function(t,i,n,e){for(var r=1,o=t[0];void 0!==o&&void 0===o[e];)o=t[r++];if(void 0!==o){var s=o[e];if(void 0!==s)if(Array.isArray(s))for(;void 0!==(s=o[e])&&(i.push(o.time),n.push.apply(n,s)),void 0!==(o=t[r++]););else if(void 0!==s.toArray)for(;void 0!==(s=o[e])&&(i.push(o.time),s.toArray(n,n.length)),void 0!==(o=t[r++]););else for(;void 0!==(s=o[e])&&(i.push(o.time),n.push(s)),void 0!==(o=t[r++]););}},subclip:function(t,i,n,e,r){r=r||30;for(var o=t.clone(),s=(o.name=i,[]),u=0;u<o.tracks.length;++u){for(var h=o.tracks[u],a=h.getValueSize(),c=[],f=[],l=0;l<h.times.length;++l){var v=h.times[l]*r;if(!(v<n||e<=v)){c.push(h.times[l]);for(var y=0;y<a;++y)f.push(h.values[l*a+y])}}0!==c.length&&(h.times=m.convertArray(c,h.times.constructor),h.values=m.convertArray(f,h.values.constructor),s.push(h))}o.tracks=s;for(var d=1/0,u=0;u<o.tracks.length;++u)d>o.tracks[u].times[0]&&(d=o.tracks[u].times[0]);for(u=0;u<o.tracks.length;++u)o.tracks[u].shift(-1*d);return o.resetDuration(),o}};function T0(t,i,n,e){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===i||0===i.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=m.convertArray(i,this.TimeBufferType),this.values=m.convertArray(n,this.ValueBufferType),this.setInterpolation(e||this.DefaultInterpolation)}function R0(t,i,n,e){T0.call(this,t,i,n,e)}function A0(t,i,n,e){s.call(this,t,i,n,e)}function x0(t,i,n,e){T0.call(this,t,i,n,e)}function P0(t,i,n,e){T0.call(this,t,i,n,e)}function C0(t,i,n){T0.call(this,t,i,n)}function L0(t,i,n,e){T0.call(this,t,i,n,e)}function I0(t,i,n,e){T0.call(this,t,i,n,e)}function N0(t,i,n){this.name=t,this.tracks=n,this.duration=void 0!==i?i:-1,this.uuid=g.generateUUID(),this.duration<0&&this.resetDuration()}function B0(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var i,n,e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return R0;case"vector":case"vector2":case"vector3":case"vector4":return P0;case"color":return L0;case"quaternion":return x0;case"bool":case"boolean":return C0;case"string":return I0}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);return void 0===t.times&&(m.flattenJSON(t.keys,i=[],n=[],"value"),t.times=i,t.values=n),void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}function D0(){u.call(this),this.type="Bone"}Object.assign(T0.prototype,{constructor:T0,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Kt,InterpolantFactoryMethodDiscrete:function(t){return new k0(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new E0(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new O0(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var i;switch(t){case Yt:i=this.InterpolantFactoryMethodDiscrete;break;case Kt:i=this.InterpolantFactoryMethodLinear;break;case 2302:i=this.InterpolantFactoryMethodSmooth}if(void 0===i){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrack:",n)}else this.createInterpolant=i;return this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Yt;case this.InterpolantFactoryMethodLinear:return Kt;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var i=this.times,n=0,e=i.length;n!==e;++n)i[n]+=t;return this},scale:function(t){if(1!==t)for(var i=this.times,n=0,e=i.length;n!==e;++n)i[n]*=t;return this},trim:function(t,i){for(var n,e=this.times,r=e.length,o=0,s=r-1;o!==r&&e[o]<t;)++o;for(;-1!==s&&e[s]>i;)--s;return++s,0===o&&s===r||(s<=o&&(o=(s=Math.max(s,1))-1),n=this.getValueSize(),this.times=m.arraySlice(e,o,s),this.values=m.arraySlice(this.values,o*n,s*n)),this},validate:function(){for(var t=!0,i=this.getValueSize(),n=(i-Math.floor(i)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1),this.times),e=this.values,r=n.length,o=(0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1),null),s=0;s!==r;s++){var u=n[s];if("number"==typeof u&&isNaN(u)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,u),t=!1;break}if(null!==o&&u<o){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,u,o),t=!1;break}o=u}if(void 0!==e&&m.isTypedArray(e))for(var s=0,h=e.length;s!==h;++s){var a=e[s];if(isNaN(a)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,s,a),t=!1;break}}return t},optimize:function(){for(var t=m.arraySlice(this.times),i=m.arraySlice(this.values),n=this.getValueSize(),e=2302===this.getInterpolation(),r=1,o=t.length-1,s=1;s<o;++s){var u=!1,h=t[s];if(h!==t[s+1]&&(1!==s||h!==h[0]))if(e)u=!0;else for(var a=s*n,c=a-n,f=a+n,l=0;l!==n;++l){var v=i[a+l];if(v!==i[c+l]||v!==i[f+l]){u=!0;break}}if(u){if(s!==r){t[r]=t[s];for(var y=s*n,d=r*n,l=0;l!==n;++l)i[d+l]=i[y+l]}++r}}if(0<o){t[r]=t[o];for(y=o*n,d=r*n,l=0;l!==n;++l)i[d+l]=i[y+l];++r}return r!==t.length?(this.times=m.arraySlice(t,0,r),this.values=m.arraySlice(i,0,r*n)):(this.times=t,this.values=i),this},clone:function(){var t=m.arraySlice(this.times,0),i=m.arraySlice(this.values,0),t=new this.constructor(this.name,t,i);return t.createInterpolant=this.createInterpolant,t}}),R0.prototype=Object.assign(Object.create(T0.prototype),{constructor:R0,ValueTypeName:"number"}),A0.prototype=Object.assign(Object.create(s.prototype),{constructor:A0,interpolate_:function(t,i,n,e){for(var r=this.resultBuffer,o=this.sampleValues,s=this.valueSize,u=t*s,h=(n-i)/(e-i),a=u+s;u!==a;u+=4)_.slerpFlat(r,0,o,u-s,o,u,h);return r}}),x0.prototype=Object.assign(Object.create(T0.prototype),{constructor:x0,ValueTypeName:"quaternion",DefaultInterpolation:Kt,InterpolantFactoryMethodLinear:function(t){return new A0(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),P0.prototype=Object.assign(Object.create(T0.prototype),{constructor:P0,ValueTypeName:"vector"}),C0.prototype=Object.assign(Object.create(T0.prototype),{constructor:C0,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Yt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),L0.prototype=Object.assign(Object.create(T0.prototype),{constructor:L0,ValueTypeName:"color"}),I0.prototype=Object.assign(Object.create(T0.prototype),{constructor:I0,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Yt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Object.assign(N0,{parse:function(t){for(var i=[],n=t.tracks,e=1/(t.fps||1),r=0,o=n.length;r!==o;++r)i.push(B0(n[r]).scale(e));return new N0(t.name,t.duration,i)},CreateFromMorphTargetSequence:function(t,i,n,e){for(var r=i.length,o=[],s=0;s<r;s++){var u=[],h=((a=[]).push((s+r-1)%r,s,(s+1)%r),u.push(0,1,0),m.getKeyframeOrder(a)),a=m.sortedArray(a,1,h),u=m.sortedArray(u,1,h);e||0!==a[0]||(a.push(r),u.push(u[0])),o.push(new R0(".morphTargetInfluences["+i[s].name+"]",a,u).scale(1/n))}return new N0(t,-1,o)},findByName:function(t,i){var n=t;Array.isArray(t)||(n=t.geometry&&t.geometry.animations||t.animations);for(var e=0;e<n.length;e++)if(n[e].name===i)return n[e];return null},CreateClipsFromMorphTargetSequences:function(t,i,n){for(var e={},r=/^([\w-]*?)([\d]+)$/,o=0,s=t.length;o<s;o++){var u=t[o],h=u.name.match(r);h&&1<h.length&&((h=e[a=h[1]])||(e[a]=h=[]),h.push(u))}var a,c=[];for(a in e)c.push(N0.CreateFromMorphTargetSequence(a,e[a],i,n));return c},parseAnimation:function(t,i){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(t,i,n,e,r){var o;0!==n.length&&(m.flattenJSON(n,n=[],o=[],e),0!==n.length)&&r.push(new t(i,n,o))},e=[],r=t.name||"default",o=t.length||-1,s=t.fps||30,u=t.hierarchy||[],h=0;h<u.length;h++){var a=u[h].keys;if(a&&0!==a.length)if(a[0].morphTargets){for(var c,f={},l=0;l<a.length;l++)if(a[l].morphTargets)for(var v=0;v<a[l].morphTargets.length;v++)f[a[l].morphTargets[v]]=-1;for(c in f){for(var y=[],d=[],v=0;v!==a[l].morphTargets.length;++v){var b=a[l];y.push(b.time),d.push(b.morphTarget===c?1:0)}e.push(new R0(".morphTargetInfluence["+c+"]",y,d))}o=f.length*(s||1)}else{var p=".bones["+i[h].name+"]";n(P0,p+".position",a,"pos",e),n(x0,p+".quaternion",a,"rot",e),n(P0,p+".scale",a,"scl",e)}}return 0===e.length?null:new N0(r,o,e)}}),Object.assign(N0.prototype,{resetDuration:function(){for(var t=0,i=0,n=this.tracks.length;i!==n;++i)var e=this.tracks[i],t=Math.max(t,e.times[e.times.length-1]);return this.duration=t,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,i=0;i<this.tracks.length;i++)t=t&&this.tracks[i].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],i=0;i<this.tracks.length;i++)t.push(this.tracks[i].clone());return new N0(this.name,this.duration,t)}}),D0.prototype=Object.assign(Object.create(u.prototype),{constructor:D0,isBone:!0});var n="\\[\\]\\.:\\/",F0=new RegExp("["+n+"]","g"),_0="[^"+n+"]",n="[^"+n.replace("\\.","")+"]",H0=/((?:WC+[\/:])*)/.source.replace("WC",_0),n=/(WCOD+)?/.source.replace("WCOD",n),U0=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",_0),_0=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",_0),G0=new RegExp("^"+H0+n+U0+_0+"$"),V0=["material","materials","bones"];function q0(t,i,n){n=n||z0.parseTrackName(i);this.si=t,this.ui=t.subscribe_(i,n)}function z0(t,i,n){this.path=i,this.parsedPath=n||z0.parseTrackName(i),this.node=z0.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}Object.assign(q0.prototype,{getValue:function(t,i){this.bind();var n=this.si.nCachedObjects_,n=this.ui[n];void 0!==n&&n.getValue(t,i)},setValue:function(t,i){for(var n=this.ui,e=this.si.nCachedObjects_,r=n.length;e!==r;++e)n[e].setValue(t,i)},bind:function(){for(var t=this.ui,i=this.si.nCachedObjects_,n=t.length;i!==n;++i)t[i].bind()},unbind:function(){for(var t=this.ui,i=this.si.nCachedObjects_,n=t.length;i!==n;++i)t[i].unbind()}}),Object.assign(z0,{Composite:q0,create:function(t,i,n){return new(t&&t.isAnimationObjectGroup?z0.Composite:z0)(t,i,n)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(F0,"")},parseTrackName:function(t){var i=G0.exec(t);if(!i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var n,i={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},e=i.nodeName&&i.nodeName.lastIndexOf(".");if(void 0!==e&&-1!==e&&(n=i.nodeName.substring(e+1),-1!==V0.indexOf(n))&&(i.nodeName=i.nodeName.substring(0,e),i.objectName=n),null===i.propertyName||0===i.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return i},findNode:function(t,r){if(!r||""===r||"."===r||-1===r||r===t.name||r===t.uuid)return t;if(t.skeleton){var i=t.skeleton.getBoneByName(r);if(void 0!==i)return i}if(t.children){i=function t(i){for(var n=0;n<i.length;n++){var e=i[n];if(e.name===r||e.uuid===r)return e;e=t(e.children);if(e)return e}return null}(t.children);if(i)return i}return null}}),Object.assign(z0.prototype,{hi:function(){},ai:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,i){t[i]=this.node[this.propertyName]},function(t,i){for(var n=this.resolvedProperty,e=0,r=n.length;e!==r;++e)t[i++]=n[e]},function(t,i){t[i]=this.resolvedProperty[this.propertyIndex]},function(t,i){this.resolvedProperty.toArray(t,i)}],SetterByBindingTypeAndVersioning:[[function(t,i){this.targetObject[this.propertyName]=t[i]},function(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0},function(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,i){for(var n=this.resolvedProperty,e=0,r=n.length;e!==r;++e)n[e]=t[i++]},function(t,i){for(var n=this.resolvedProperty,e=0,r=n.length;e!==r;++e)n[e]=t[i++];this.targetObject.needsUpdate=!0},function(t,i){for(var n=this.resolvedProperty,e=0,r=n.length;e!==r;++e)n[e]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,i){this.resolvedProperty[this.propertyIndex]=t[i]},function(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0},function(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,i){this.resolvedProperty.fromArray(t,i)},function(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0},function(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,i){this.bind(),this.getValue(t,i)},setValue:function(t,i){this.bind(),this.setValue(t,i)},bind:function(){var t=this.node,i=this.parsedPath,n=i.objectName,e=i.propertyName,r=i.propertyIndex;if(t||(t=z0.findNode(this.rootNode,i.nodeName)||this.rootNode,this.node=t),this.getValue=this.hi,this.setValue=this.ai,t){if(n){var o=i.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);for(var t=t.skeleton.bones,s=0;s<t.length;s++)if(t[s].name===o){o=s;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==o){if(void 0===t[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}var u=t[e];if(void 0===u)i=i.nodeName,console.error("THREE.PropertyBinding: Trying to update property for track: "+i+"."+e+" but it wasn't found.",t);else{var i=this.Versioning.None,h=(void 0!==(this.targetObject=t).needsUpdate?i=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(i=this.Versioning.MatrixWorldNeedsUpdate),this.BindingType.Direct);if(void 0!==r){if("morphTargetInfluences"===e){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(s=0;s<this.node.geometry.morphAttributes.position.length;s++)if(t.geometry.morphAttributes.position[s].name===r){r=s;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(s=0;s<this.node.geometry.morphTargets.length;s++)if(t.geometry.morphTargets[s].name===r){r=s;break}}}h=this.BindingType.ArrayElement,this.resolvedProperty=u,this.propertyIndex=r}else void 0!==u.fromArray&&void 0!==u.toArray?(h=this.BindingType.HasFromToArray,this.resolvedProperty=u):Array.isArray(u)?(h=this.BindingType.EntireArray,this.resolvedProperty=u):this.propertyName=e;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][i]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this.ci,this.setValue=this.fi}}),Object.assign(z0.prototype,{ci:z0.prototype.getValue,fi:z0.prototype.setValue});var w,X0,Z0,W0,Y0,K0,Q0,$0,J0,tv,iv,nv,ev,rv,ov,sv,uv,hv,av,cv,fv,lv,vv=new p,yv=new p;function dv(t,i){if(this.bones=(t=t||[]).slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===i)this.calculateInverses();else if(this.bones.length===i.length)this.boneInverses=i.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,e=this.bones.length;n<e;n++)this.boneInverses.push(new p)}}function bv(t){return(bv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pv(t){o.call(this,t),this.dracoLoader=null,this.ddsLoader=null}function mv(){var n={};return{get:function(t){return n[t]},add:function(t,i){n[t]=i},remove:function(t){delete n[t]},removeAll:function(){n={}}}}function wv(t){if(!t)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=w.MSFT_TEXTURE_DDS,this.ddsLoader=t}function gv(t){this.name=w.KHR_LIGHTS_PUNCTUAL;t=t.extensions&&t.extensions[w.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function jv(){this.name=w.KHR_MATERIALS_UNLIT}function Mv(){this.name=w.KHR_MATERIALS_CLEARCOAT}function Sv(t){this.name=w.KHR_BINARY_GLTF,this.content=null,this.body=null;var i=new DataView(t,0,Z0);if(this.header={magic:Ql(new Uint8Array(t.slice(0,4))),version:i.getUint32(4,!0),length:i.getUint32(8,!0)},this.header.magic!==X0)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var n=new DataView(t,Z0),e=0;e<n.byteLength;){var r,o=n.getUint32(e,!0),s=(e+=4,n.getUint32(e,!0));e+=4,s===W0.JSON?(r=new Uint8Array(t,Z0+e,o),this.content=Ql(r)):s===W0.BIN&&(this.body=t.slice(r=Z0+e,r+o)),e+=o}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function Ov(t,i){if(!i)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=w.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=i,this.dracoLoader.preload()}function Ev(){this.name=w.KHR_TEXTURE_TRANSFORM}function kv(t){Ll.call(this),this.isGLTFSpecularGlossinessMaterial=!0;["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n");var n=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),e=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),r=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),o=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),s={specular:{value:(new y).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this.li=s,this.onBeforeCompile=function(t){for(var i in s)t.uniforms[i]=s[i];t.fragmentShader=t.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;"),t.fragmentShader=t.fragmentShader.replace("uniform float metalness;","uniform float glossiness;"),t.fragmentShader=t.fragmentShader.replace("#include <metalnessmap_pars_fragment>",n),t.fragmentShader=t.fragmentShader.replace("#include <roughnessmap_fragment>",e),t.fragmentShader=t.fragmentShader.replace("#include <metalnessmap_fragment>",r),t.fragmentShader=t.fragmentShader.replace("#include <lights_physical_fragment>",o)},Object.defineProperties(this,{specular:{get:function(){return s.specular.value},set:function(t){s.specular.value=t}},specularMap:{get:function(){return s.specularMap.value},set:function(t){s.specularMap.value=t}},glossiness:{get:function(){return s.glossiness.value},set:function(t){s.glossiness.value=t}},glossinessMap:{get:function(){return s.glossinessMap.value},set:function(t){(s.glossinessMap.value=t)?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_ROUGHNESSMAP=""):(delete this.defines.USE_ROUGHNESSMAP,delete this.defines.USE_GLOSSINESSMAP)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(t)}function Tv(){return{name:w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return kv},extendParams:function(t,i,n){var e,i=i.extensions[this.name],r=(t.color=new y(1,1,1),t.opacity=1,[]);return Array.isArray(i.diffuseFactor)&&(e=i.diffuseFactor,t.color.fromArray(e),t.opacity=e[3]),void 0!==i.diffuseTexture&&r.push(n.assignTexture(t,"map",i.diffuseTexture)),t.emissive=new y(0,0,0),t.glossiness=void 0!==i.glossinessFactor?i.glossinessFactor:1,t.specular=new y(1,1,1),Array.isArray(i.specularFactor)&&t.specular.fromArray(i.specularFactor),void 0!==i.specularGlossinessTexture&&(e=i.specularGlossinessTexture,r.push(n.assignTexture(t,"glossinessMap",e)),r.push(n.assignTexture(t,"specularMap",e))),Promise.all(r)},createMaterial:function(t){var i=new kv(t);return i.fog=!0,i.color=t.color,i.map=void 0===t.map?null:t.map,i.lightMap=null,i.lightMapIntensity=1,i.aoMap=void 0===t.aoMap?null:t.aoMap,i.aoMapIntensity=1,i.emissive=t.emissive,i.emissiveIntensity=1,i.emissiveMap=void 0===t.emissiveMap?null:t.emissiveMap,i.bumpMap=void 0===t.bumpMap?null:t.bumpMap,i.bumpScale=1,i.normalMap=void 0===t.normalMap?null:t.normalMap,i.normalMapType=$t,t.normalScale&&(i.normalScale=t.normalScale),i.displacementMap=null,i.displacementScale=1,i.displacementBias=0,i.specularMap=void 0===t.specularMap?null:t.specularMap,i.specular=t.specular,i.glossinessMap=void 0===t.glossinessMap?null:t.glossinessMap,i.glossiness=t.glossiness,i.alphaMap=null,i.envMap=void 0===t.envMap?null:t.envMap,i.envMapIntensity=1,i.refractionRatio=.98,i}}}function Rv(){this.name=w.KHR_MESH_QUANTIZATION}function Av(t,i,n,e){s.call(this,t,i,n,e)}function xv(t,i){return"string"!=typeof t||""===t?"":(/^https?:\/\//i.test(i)&&/^\//.test(t)&&(i=i.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:i+t)}function Pv(t,i,n){for(var e in n.extensions)void 0===t[e]&&(i.userData.gltfExtensions=i.userData.gltfExtensions||{},i.userData.gltfExtensions[e]=n.extensions[e])}function Cv(t,i){void 0!==i.extras&&("object"===bv(i.extras)?Object.assign(t.userData,i.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+i.extras))}function Lv(t){for(var i="",n=Object.keys(t).sort(),e=0,r=n.length;e<r;e++)i+=n[e]+":"+t[n[e]]+";";return i}function O(t,i,n){this.json=t||{},this.extensions=i||{},this.options=n||{},this.cache=new mv,this.primitiveCache={},this.textureLoader=new Ol(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new Kl(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function Iv(f,l,v){var t,i=l.attributes,n=[];for(t in i){var e=sv[t]||t.toLowerCase();e in f.attributes||n.push(function(t,i){return v.getDependency("accessor",t).then(function(t){f.setAttribute(i,t)})}(i[t],e))}void 0===l.indices||f.index||(r=v.getDependency("accessor",l.indices).then(function(t){f.setIndex(t)}),n.push(r)),Cv(f,l);var r=f,o=l,s=v,u=o.attributes,h=new Nt;if(void 0!==u.POSITION){var a=(w=s.json.accessors[u.POSITION]).min,c=w.max;if(void 0===a||void 0===c)console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");else{h.set(new j(a[0],a[1],a[2]),new j(c[0],c[1],c[2]));var y=o.targets;if(void 0!==y){for(var d=new j,b=new j,p=0,m=y.length;p<m;p++){var w,g=y[p];void 0!==g.POSITION&&(a=(w=s.json.accessors[g.POSITION]).min,c=w.max,void 0!==a&&void 0!==c?(b.setX(Math.max(Math.abs(a[0]),Math.abs(c[0]))),b.setY(Math.max(Math.abs(a[1]),Math.abs(c[1]))),b.setZ(Math.max(Math.abs(a[2]),Math.abs(c[2]))),d.max(b)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION."))}h.expandByVector(d)}r.boundingBox=h;u=new ci;h.getCenter(u.center),u.radius=h.min.distanceTo(h.max)/2,r.boundingSphere=u}}return Promise.all(n).then(function(){if(void 0===l.targets)return f;for(var n=f,t=l.targets,i=v,e=!1,r=!1,o=0,s=t.length;o<s&&(void 0!==(c=t[o]).POSITION&&(e=!0),void 0!==c.NORMAL&&(r=!0),!e||!r);o++);if(!e&&!r)return Promise.resolve(n);for(var u=[],h=[],o=0,s=t.length;o<s;o++){var a,c=t[o];e&&(a=void 0!==c.POSITION?i.getDependency("accessor",c.POSITION):n.attributes.position,u.push(a)),r&&(a=void 0!==c.NORMAL?i.getDependency("accessor",c.NORMAL):n.attributes.normal,h.push(a))}return Promise.all([Promise.all(u),Promise.all(h)]).then(function(t){var i=t[0],t=t[1];return e&&(n.morphAttributes.position=i),r&&(n.morphAttributes.normal=t),n.morphTargetsRelative=!0,n})})}function Nv(t,i){var n=t.getIndex();if(null===n){var e=[],r=t.getAttribute("position");if(void 0===r)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(var o=0;o<r.count;o++)e.push(o);t.setIndex(e),n=t.getIndex()}var s=n.count-2,u=[];if(2===i)for(o=1;o<=s;o++)u.push(n.getX(0)),u.push(n.getX(o)),u.push(n.getX(o+1));else for(o=0;o<s;o++)o%2==0?(u.push(n.getX(o)),u.push(n.getX(o+1)),u.push(n.getX(o+2))):(u.push(n.getX(o+2)),u.push(n.getX(o+1)),u.push(n.getX(o)));u.length/3!=s&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");i=t.clone();return i.setIndex(u),i}Object.assign(dv.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,i=this.bones.length;t<i;t++){var n=new p;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){for(var t,i=0,n=this.bones.length;i<n;i++)(t=this.bones[i])&&t.matrixWorld.getInverse(this.boneInverses[i]);for(i=0,n=this.bones.length;i<n;i++)(t=this.bones[i])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){for(var t=this.bones,i=this.boneInverses,n=this.boneMatrices,e=this.boneTexture,r=0,o=t.length;r<o;r++){var s=t[r]?t[r].matrixWorld:yv;vv.multiplyMatrices(s,i[r]),vv.toArray(n,16*r)}void 0!==e&&(e.needsUpdate=!0)},clone:function(){return new dv(this.bones,this.boneInverses)},getBoneByName:function(t){for(var i=0,n=this.bones.length;i<n;i++){var e=this.bones[i];if(e.name===t)return e}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),pv.prototype=Object.assign(Object.create(o.prototype),{constructor:pv,load:function(n,e,t,i){function r(t){i?i(t):console.error(t),o.manager.itemError(n),o.manager.itemEnd(n)}var o=this,s=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:$l(n),u=(o.manager.itemStart(n),new Kl(o.manager));u.setPath(this.path),u.setResponseType("arraybuffer"),"use-credentials"===o.crossOrigin&&u.setWithCredentials(!0),u.load(n,function(i){try{o.parse(i,s,function(t){e(t,i),o.manager.itemEnd(n)},r)}catch(t){r(t)}},t,r)},setDRACOLoader:function(t){return this.dracoLoader=t,this},setDDSLoader:function(t){return this.ddsLoader=t,this},parse:function(t,i,n,e){var r,o={};if("string"==typeof t)r=t;else if(Ql(new Uint8Array(t,0,4))===X0){try{o[w.KHR_BINARY_GLTF]=new Sv(t)}catch(t){return void(e&&e(t))}r=o[w.KHR_BINARY_GLTF].content}else r=Ql(new Uint8Array(t));var s=JSON.parse(r);if(void 0===s.asset||s.asset.version[0]<2)e&&e(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{if(s.extensionsUsed)for(var u=0;u<s.extensionsUsed.length;++u){var h=s.extensionsUsed[u],a=s.extensionsRequired||[];switch(h){case w.KHR_LIGHTS_PUNCTUAL:o[h]=new gv(s);break;case w.KHR_MATERIALS_CLEARCOAT:o[h]=new Mv;break;case w.KHR_MATERIALS_UNLIT:o[h]=new jv;break;case w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:o[h]=new Tv;break;case w.KHR_DRACO_MESH_COMPRESSION:o[h]=new Ov(s,this.dracoLoader);break;case w.MSFT_TEXTURE_DDS:o[h]=new wv(this.ddsLoader);break;case w.KHR_TEXTURE_TRANSFORM:o[h]=new Ev;break;case w.KHR_MESH_QUANTIZATION:o[h]=new Rv;break;default:0<=a.indexOf(h)&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}new O(s,o,{path:i||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager}).parse(n,e)}}}),w={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"},gv.prototype.loadLight=function(t){var i,n=this.lightDefs[t],e=new y(16777215),r=(void 0!==n.color&&e.fromArray(n.color),void 0!==n.range?n.range:0);switch(n.type){case"directional":(i=new jl(e)).target.position.set(0,0,-1),i.add(i.target);break;case"point":(i=new i0(e)).distance=r;break;case"spot":(i=new e0(e)).distance=r,n.spot=n.spot||{},n.spot.innerConeAngle=void 0!==n.spot.innerConeAngle?n.spot.innerConeAngle:0,n.spot.outerConeAngle=void 0!==n.spot.outerConeAngle?n.spot.outerConeAngle:Math.PI/4,i.angle=n.spot.outerConeAngle,i.penumbra=1-n.spot.innerConeAngle/n.spot.outerConeAngle,i.target.position.set(0,0,-1),i.add(i.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+n.type+'".')}return i.position.set(0,0,0),i.decay=2,void 0!==n.intensity&&(i.intensity=n.intensity),i.name=n.name||"light_"+t,Promise.resolve(i)},jv.prototype.getMaterialType=function(){return ji},jv.prototype.extendParams=function(t,i,n){var e,r=[],i=(t.color=new y(1,1,1),t.opacity=1,i.pbrMetallicRoughness);return i&&(Array.isArray(i.baseColorFactor)&&(e=i.baseColorFactor,t.color.fromArray(e),t.opacity=e[3]),void 0!==i.baseColorTexture)&&r.push(n.assignTexture(t,"map",i.baseColorTexture)),Promise.all(r)},Mv.prototype.getMaterialType=function(){return Il},Mv.prototype.extendParams=function(t,i,n){var e=[],i=i.extensions[this.name];return void 0!==i.clearcoatFactor&&(t.clearcoat=i.clearcoatFactor),void 0!==i.clearcoatTexture&&e.push(n.assignTexture(t,"clearcoatMap",i.clearcoatTexture)),void 0!==i.clearcoatRoughnessFactor&&(t.clearcoatRoughness=i.clearcoatRoughnessFactor),void 0!==i.clearcoatRoughnessTexture&&e.push(n.assignTexture(t,"clearcoatRoughnessMap",i.clearcoatRoughnessTexture)),void 0!==i.clearcoatNormalTexture&&(e.push(n.assignTexture(t,"clearcoatNormalMap",i.clearcoatNormalTexture)),void 0!==i.clearcoatNormalTexture.scale)&&(n=i.clearcoatNormalTexture.scale,t.clearcoatNormalScale=new I(n,n)),Promise.all(e)},X0="glTF",Z0=12,W0={JSON:1313821514,BIN:5130562},Ov.prototype.decodePrimitive=function(t,i){var n,e=this.json,r=this.dracoLoader,o=t.extensions[this.name].bufferView,s=t.extensions[this.name].attributes,u={},h={},a={};for(n in s){var c=sv[n]||n.toLowerCase();u[c]=s[n]}for(n in t.attributes){var f,l,c=sv[n]||n.toLowerCase();void 0!==s[n]&&(f=e.accessors[t.attributes[n]],l=nv[f.componentType],a[c]=l,h[c]=!0===f.normalized)}return i.getDependency("bufferView",o).then(function(t){return new Promise(function(e){r.decodeDracoFile(t,function(t){for(var i in t.attributes){var n=t.attributes[i],i=h[i];void 0!==i&&(n.normalized=i)}e(t)},u,a)})})},Ev.prototype.extendTexture=function(t,i){return t=t.clone(),void 0!==i.offset&&t.offset.fromArray(i.offset),void 0!==i.rotation&&(t.rotation=i.rotation),void 0!==i.scale&&t.repeat.fromArray(i.scale),void 0!==i.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.needsUpdate=!0,t},((kv.prototype=Object.create(Ll.prototype)).constructor=kv).prototype.copy=function(t){return Ll.prototype.copy.call(this,t),this.specularMap=t.specularMap,this.specular.copy(t.specular),this.glossinessMap=t.glossinessMap,this.glossiness=t.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},((Av.prototype=Object.create(s.prototype)).constructor=Av).prototype.beforeStart_=Av.prototype.copySampleValue_=function(t){for(var i=this.resultBuffer,n=this.sampleValues,e=this.valueSize,r=t*e*3+e,o=0;o!==e;o++)i[o]=n[r+o];return i},Av.prototype.afterEnd_=Av.prototype.copySampleValue_,Av.prototype.interpolate_=function(t,i,n,e){for(var r=this.resultBuffer,o=this.sampleValues,s=this.valueSize,u=2*s,h=3*s,a=e-i,e=(n-i)/a,n=e*e,i=n*e,c=t*h,f=c-h,l=-2*i+3*n,v=i-n,y=1-l,d=v-n+e,b=0;b!==s;b++){var p=o[f+b+s],m=o[f+b+u]*a,w=o[c+b+s],g=o[c+b]*a;r[b]=y*p+d*m+l*w+v*g}return r},Y0=0,K0=1,Q0=2,$0=3,J0=4,tv=5,iv=6,nv={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},ev={9728:1003,9729:Wt,9984:1004,9985:1007,9986:1005,9987:1008},rv={33071:Zt,33648:1002,10497:1e3},ov={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},sv={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},uv={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},hv={CUBICSPLINE:void 0,LINEAR:Kt,STEP:Yt},av="OPAQUE",cv="MASK",fv="BLEND",lv={"image/png":1023,"image/jpeg":1022},O.prototype.parse=function(i,t){var n=this,e=this.json,r=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(t){t={scene:t[0][e.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:e.asset,parser:n,userData:{}};Pv(r,t,e),Cv(t,e),i(t)}).catch(t)},O.prototype.markDefs=function(){for(var t=this.json.nodes||[],i=this.json.skins||[],n=this.json.meshes||[],e={},r={},o=0,s=i.length;o<s;o++)for(var u=i[o].joints,h=0,a=u.length;h<a;h++)t[u[h]].isBone=!0;for(var c=0,f=t.length;c<f;c++){var l=t[c];void 0!==l.mesh&&(void 0===e[l.mesh]&&(e[l.mesh]=r[l.mesh]=0),e[l.mesh]++,void 0!==l.skin)&&(n[l.mesh].isSkinnedMesh=!0)}this.json.meshReferences=e,this.json.meshUses=r},O.prototype.getDependency=function(t,i){var n=t+":"+i,e=this.cache.get(n);if(!e){switch(t){case"scene":e=this.loadScene(i);break;case"node":e=this.loadNode(i);break;case"mesh":e=this.loadMesh(i);break;case"accessor":e=this.loadAccessor(i);break;case"bufferView":e=this.loadBufferView(i);break;case"buffer":e=this.loadBuffer(i);break;case"material":e=this.loadMaterial(i);break;case"texture":e=this.loadTexture(i);break;case"skin":e=this.loadSkin(i);break;case"animation":e=this.loadAnimation(i);break;case"camera":e=this.loadCamera(i);break;case"light":e=this.extensions[w.KHR_LIGHTS_PUNCTUAL].loadLight(i);break;default:throw new Error("Unknown type: "+t)}this.cache.add(n,e)}return e},O.prototype.getDependencies=function(n){var e,t,i=this.cache.get(n);return i||(t=(e=this).json[n+("mesh"===n?"es":"s")]||[],i=Promise.all(t.map(function(t,i){return e.getDependency(n,i)})),this.cache.add(n,i)),i},O.prototype.loadBuffer=function(t){var n,e=this.json.buffers[t],r=this.fileLoader;if(e.type&&"arraybuffer"!==e.type)throw new Error("THREE.GLTFLoader: "+e.type+" buffer type is not supported.");return void 0===e.uri&&0===t?Promise.resolve(this.extensions[w.KHR_BINARY_GLTF].body):(n=this.options,new Promise(function(t,i){r.load(xv(e.uri,n.path),t,void 0,function(){i(new Error('THREE.GLTFLoader: Failed to load buffer "'+e.uri+'".'))})}))},O.prototype.loadBufferView=function(t){var e=this.json.bufferViews[t];return this.getDependency("buffer",e.buffer).then(function(t){var i=e.byteLength||0,n=e.byteOffset||0;return t.slice(n,n+i)})},O.prototype.loadAccessor=function(t){var p=this,m=this.json,w=this.json.accessors[t];return void 0===w.bufferView&&void 0===w.sparse?Promise.resolve(null):(t=[],void 0!==w.bufferView?t.push(this.getDependency("bufferView",w.bufferView)):t.push(null),void 0!==w.sparse&&(t.push(this.getDependency("bufferView",w.sparse.indices.bufferView)),t.push(this.getDependency("bufferView",w.sparse.values.bufferView))),Promise.all(t).then(function(t){var i=t[0],n=ov[w.type],e=nv[w.componentType],r=e.BYTES_PER_ELEMENT,o=w.byteOffset||0,s=void 0!==w.bufferView?m.bufferViews[w.bufferView].byteStride:void 0,u=!0===w.normalized,h=s&&s!==r*n?(a=Math.floor(o/s),c="InterleavedBuffer:"+w.bufferView+":"+w.componentType+":"+a+":"+w.count,(f=p.cache.get(c))||(f=new r0(new e(i,a*s,w.count*s/r),s/r),p.cache.add(c,f)),new s0(f,n,o%s/r,u)):new M(null===i?new e(w.count*n):new e(i,o,w.count*n),n,u);if(void 0!==w.sparse){var a=nv[w.sparse.indices.componentType],c=w.sparse.indices.byteOffset||0,f=w.sparse.values.byteOffset||0,l=new a(t[1],c,w.sparse.count*ov.SCALAR),v=new e(t[2],f,w.sparse.count*n);null!==i&&(h=new M(h.array.slice(),h.itemSize,h.normalized));for(var y=0,d=l.length;y<d;y++){var b=l[y];if(h.setX(b,v[y*n]),2<=n&&h.setY(b,v[y*n+1]),3<=n&&h.setZ(b,v[y*n+2]),4<=n&&h.setW(b,v[y*n+3]),5<=n)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return h}))},O.prototype.loadTexture=function(t){var i=this,n=this.json,r=this.options,o=this.textureLoader,e=self.URL||self.webkitURL,s=n.textures[t],u=s.extensions||{},h=u[w.MSFT_TEXTURE_DDS]?n.images[u[w.MSFT_TEXTURE_DDS].source]:n.images[s.source],a=h.uri,c=!1;return void 0!==h.bufferView&&(a=i.getDependency("bufferView",h.bufferView).then(function(t){c=!0;t=new Blob([t],{type:h.mimeType});return a=e.createObjectURL(t)})),Promise.resolve(a).then(function(n){var e=(e=r.manager.getHandler(n))||(u[w.MSFT_TEXTURE_DDS]?i.extensions[w.MSFT_TEXTURE_DDS].ddsLoader:o);return new Promise(function(t,i){e.load(xv(n,r.path),t,void 0,i)})}).then(function(t){!0===c&&e.revokeObjectURL(a),t.flipY=!1,s.name&&(t.name=s.name),h.mimeType in lv&&(t.format=lv[h.mimeType]);var i=(n.samplers||{})[s.sampler]||{};return t.magFilter=ev[i.magFilter]||Wt,t.minFilter=ev[i.minFilter]||1008,t.wrapS=rv[i.wrapS]||1e3,t.wrapT=rv[i.wrapT]||1e3,t})},O.prototype.assignTexture=function(n,e,r){var o=this;return this.getDependency("texture",r.index).then(function(t){if(!t.isCompressedTexture)switch(e){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":t.format=1022}var i;void 0===r.texCoord||0==r.texCoord||"aoMap"===e&&1==r.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+r.texCoord+" for texture "+e+" not yet supported."),o.extensions[w.KHR_TEXTURE_TRANSFORM]&&(i=void 0!==r.extensions?r.extensions[w.KHR_TEXTURE_TRANSFORM]:void 0)&&(t=o.extensions[w.KHR_TEXTURE_TRANSFORM].extendTexture(t,i)),n[e]=t})},O.prototype.assignFinalMaterial=function(t){var i,n,e=t.geometry,r=t.material,o=void 0!==e.attributes.tangent,s=void 0!==e.attributes.color,u=void 0===e.attributes.normal,h=!0===t.isSkinnedMesh,a=0<Object.keys(e.morphAttributes).length,c=a&&void 0!==e.morphAttributes.normal;t.isPoints?(i="PointsMaterial:"+r.uuid,(n=this.cache.get(i))||(n=new Cl,f.prototype.copy.call(n,r),n.color.copy(r.color),n.map=r.map,n.sizeAttenuation=!1,this.cache.add(i,n)),r=n):t.isLine&&(i="LineBasicMaterial:"+r.uuid,(n=this.cache.get(i))||(n=new Gl,f.prototype.copy.call(n,r),n.color.copy(r.color),this.cache.add(i,n)),r=n),(o||s||u||h||a)&&(i="ClonedMaterial:"+r.uuid+":",r.isGLTFSpecularGlossinessMaterial&&(i+="specular-glossiness:"),h&&(i+="skinning:"),o&&(i+="vertex-tangents:"),s&&(i+="vertex-colors:"),u&&(i+="flat-shading:"),a&&(i+="morph-targets:"),c&&(i+="morph-normals:"),(n=this.cache.get(i))||(n=r.clone(),h&&(n.skinning=!0),o&&(n.vertexTangents=!0),s&&(n.vertexColors=!0),u&&(n.flatShading=!0),a&&(n.morphTargets=!0),c&&(n.morphNormals=!0),this.cache.add(i,n)),r=n),r.aoMap&&void 0===e.attributes.uv2&&void 0!==e.attributes.uv&&e.setAttribute("uv2",new M(e.attributes.uv.array,2)),r.normalScale&&!o&&(r.normalScale.y=-r.normalScale.y),r.clearcoatNormalScale&&!o&&(r.clearcoatNormalScale.y=-r.clearcoatNormalScale.y),t.material=r},O.prototype.loadMaterial=function(t){var i,n,e=this.json,r=this.extensions,o=e.materials[t],s={},e=o.extensions||{},t=[],u=(e[w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]?(n=r[w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS],i=n.getMaterialType(),t.push(n.extendParams(s,o,this))):e[w.KHR_MATERIALS_UNLIT]?(n=r[w.KHR_MATERIALS_UNLIT],i=n.getMaterialType(),t.push(n.extendParams(s,o,this))):(i=Ll,n=o.pbrMetallicRoughness||{},s.color=new y(1,1,1),s.opacity=1,Array.isArray(n.baseColorFactor)&&(u=n.baseColorFactor,s.color.fromArray(u),s.opacity=u[3]),void 0!==n.baseColorTexture&&t.push(this.assignTexture(s,"map",n.baseColorTexture)),s.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,s.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(t.push(this.assignTexture(s,"metalnessMap",n.metallicRoughnessTexture)),t.push(this.assignTexture(s,"roughnessMap",n.metallicRoughnessTexture)))),!0===o.doubleSided&&(s.side=Ht),o.alphaMode||av);return u===fv?(s.transparent=!0,s.depthWrite=!1):(s.transparent=!1,u===cv&&(s.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&i!==ji&&(t.push(this.assignTexture(s,"normalMap",o.normalTexture)),s.normalScale=new I(1,1),void 0!==o.normalTexture.scale)&&s.normalScale.set(o.normalTexture.scale,o.normalTexture.scale),void 0!==o.occlusionTexture&&i!==ji&&(t.push(this.assignTexture(s,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength)&&(s.aoMapIntensity=o.occlusionTexture.strength),void 0!==o.emissiveFactor&&i!==ji&&(s.emissive=(new y).fromArray(o.emissiveFactor)),void 0!==o.emissiveTexture&&i!==ji&&t.push(this.assignTexture(s,"emissiveMap",o.emissiveTexture)),e[w.KHR_MATERIALS_CLEARCOAT]&&(n=r[w.KHR_MATERIALS_CLEARCOAT],i=n.getMaterialType(),t.push(n.extendParams(s,{extensions:e},this))),Promise.all(t).then(function(){var t=i===kv?r[w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new i(s);return o.name&&(t.name=o.name),t.map&&(t.map.encoding=3001),t.emissiveMap&&(t.emissiveMap.encoding=3001),Cv(t,o),o.extensions&&Pv(r,t,o),t})},O.prototype.loadGeometries=function(t){var n=this,e=this.extensions,i=this.primitiveCache;for(var r=[],o=0,s=t.length;o<s;o++){var u=t[o],h=(a=void 0,a=(a=(h=u).extensions&&h.extensions[w.KHR_DRACO_MESH_COMPRESSION])?"draco:"+a.bufferView+":"+a.indices+":"+Lv(a.attributes):h.indices+":"+Lv(h.attributes)+":"+h.mode),a=i[h];a?r.push(a.promise):(a=u.extensions&&u.extensions[w.KHR_DRACO_MESH_COMPRESSION]?function(i){return e[w.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(i,n).then(function(t){return Iv(t,i,n)})}(u):Iv(new mi,u,n),i[h]={primitive:u,promise:a},r.push(a))}return Promise.all(r)},O.prototype.loadMesh=function(b){for(var p=this,m=this.json.meshes[b],w=m.primitives,t=[],i=0,n=w.length;i<n;i++){var e=void 0===w[i].material?(void 0===(e=this.cache).DefaultMaterial&&(e.DefaultMaterial=new Ll({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Ft})),e.DefaultMaterial):this.getDependency("material",w[i].material);t.push(e)}return t.push(p.loadGeometries(w)),Promise.all(t).then(function(t){for(var i=t.slice(0,t.length-1),n=t[t.length-1],e=[],r=0,o=n.length;r<o;r++){var s,u=n[r],h=w[r],a=i[r];if(h.mode===J0||h.mode===tv||h.mode===iv||void 0===h.mode)!0!==(s=new(!0===m.isSkinnedMesh?u0:vn)(u,a)).isSkinnedMesh||s.geometry.attributes.skinWeight.normalized||s.normalizeSkinWeights(),h.mode===tv?s.geometry=Nv(s.geometry,1):h.mode===iv&&(s.geometry=Nv(s.geometry,2));else if(h.mode===K0)s=new b0(u,a);else if(h.mode===$0)s=new v0(u,a);else if(h.mode===Q0)s=new p0(u,a);else{if(h.mode!==Y0)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+h.mode);s=new M0(u,a)}if(0<Object.keys(s.geometry.morphAttributes).length){y=v=l=f=c=void 0;var c=s,f=m;if(c.updateMorphTargets(),void 0!==f.weights)for(var l=0,v=f.weights.length;l<v;l++)c.morphTargetInfluences[l]=f.weights[l];if(f.extras&&Array.isArray(f.extras.targetNames)){var y=f.extras.targetNames;if(c.morphTargetInfluences.length===y.length){c.morphTargetDictionary={};for(l=0,v=y.length;l<v;l++)c.morphTargetDictionary[y[l]]=l}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}s.name=m.name||"mesh_"+b,1<n.length&&(s.name+="_"+r),Cv(s,m),p.assignFinalMaterial(s),e.push(s)}if(1===e.length)return e[0];for(var d=new gn,r=0,o=e.length;r<o;r++)d.add(e[r]);return d})},O.prototype.loadCamera=function(t){var i,t=this.json.cameras[t],n=t[t.type];if(n)return"perspective"===t.type?i=new Jl(g.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===t.type&&(i=new wl(n.xmag/-2,n.xmag/2,n.ymag/2,n.ymag/-2,n.znear,n.zfar)),t.name&&(i.name=t.name),Cv(i,t),Promise.resolve(i);console.warn("THREE.GLTFLoader: Missing camera parameters.")},O.prototype.loadSkin=function(t){var t=this.json.skins[t],i={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(i):this.getDependency("accessor",t.inverseBindMatrices).then(function(t){return i.inverseBindMatrices=t,i})},O.prototype.loadAnimation=function(O){for(var E=this.json.animations[O],t=[],i=[],n=[],e=[],r=[],o=0,s=E.channels.length;o<s;o++){var u=E.channels[o],h=E.samplers[u.sampler],u=u.target,a=void 0!==u.node?u.node:u.id,c=void 0!==E.parameters?E.parameters[h.input]:h.input,f=void 0!==E.parameters?E.parameters[h.output]:h.output;t.push(this.getDependency("node",a)),i.push(this.getDependency("accessor",c)),n.push(this.getDependency("accessor",f)),e.push(h),r.push(u)}return Promise.all([Promise.all(t),Promise.all(i),Promise.all(n),Promise.all(e),Promise.all(r)]).then(function(t){for(var i=t[0],n=t[1],e=t[2],r=t[3],o=t[4],s=[],u=0,h=i.length;u<h;u++){var a,c=i[u],f=n[u],l=e[u],v=r[u],y=o[u];if(void 0!==c){switch(c.updateMatrix(),c.matrixAutoUpdate=!0,uv[y.path]){case uv.weights:a=R0;break;case uv.rotation:a=x0;break;default:a=P0}var d,b=c.name||c.uuid,p=void 0!==v.interpolation?hv[v.interpolation]:Kt,m=[],w=(uv[y.path]===uv.weights?c.traverse(function(t){!0===t.isMesh&&t.morphTargetInfluences&&m.push(t.name||t.uuid)}):m.push(b),l.array);if(l.normalized){if(w.constructor===Int8Array)d=1/127;else if(w.constructor===Uint8Array)d=1/255;else if(w.constructor==Int16Array)d=1/32767;else{if(w.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");d=1/65535}for(var g=new Float32Array(w.length),j=0,M=w.length;j<M;j++)g[j]=w[j]*d;w=g}for(j=0,M=m.length;j<M;j++){var S=new a(m[j]+"."+uv[y.path],f.array,w,p);"CUBICSPLINE"===v.interpolation&&(S.createInterpolant=function(t){return new Av(this.times,this.values,this.getValueSize()/3,t)},S.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),s.push(S)}}}return new N0(E.name||"animation_"+O,void 0,s)})},O.prototype.loadNode=function(t){var i=this.json,o=this.extensions,n=this,e=i.meshReferences,r=i.meshUses,s=i.nodes[t];return i=[],void 0!==s.mesh&&i.push(n.getDependency("mesh",s.mesh).then(function(t){var i,n;return 1<e[s.mesh]?(i=r[s.mesh]++,(n=t.clone()).name+="_instance_"+i):n=t,void 0!==s.weights&&n.traverse(function(t){if(t.isMesh)for(var i=0,n=s.weights.length;i<n;i++)t.morphTargetInfluences[i]=s.weights[i]}),n})),void 0!==s.camera&&i.push(n.getDependency("camera",s.camera)),s.extensions&&s.extensions[w.KHR_LIGHTS_PUNCTUAL]&&void 0!==s.extensions[w.KHR_LIGHTS_PUNCTUAL].light&&i.push(n.getDependency("light",s.extensions[w.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(i).then(function(t){var i,n=!0===s.isBone?new D0:1<t.length?new gn:1===t.length?t[0]:new u;if(n!==t[0])for(var e=0,r=t.length;e<r;e++)n.add(t[e]);return s.name&&(n.userData.name=s.name,n.name=z0.sanitizeNodeName(s.name)),Cv(n,s),s.extensions&&Pv(o,n,s),void 0!==s.matrix?((i=new p).fromArray(s.matrix),n.applyMatrix4(i)):(void 0!==s.translation&&n.position.fromArray(s.translation),void 0!==s.rotation&&n.quaternion.fromArray(s.rotation),void 0!==s.scale&&n.scale.fromArray(s.scale)),n})},O.prototype.loadScene=function(t){for(var i=this.json,n=this.extensions,t=this.json.scenes[t],e=new yt,r=(t.name&&(e.name=t.name),Cv(e,t),t.extensions&&Pv(n,e,t),t.nodes||[]),o=[],s=0,u=r.length;s<u;s++)o.push(function s(t,u,h,a){var c=h.nodes[t];return a.getDependency("node",t).then(function(t){var u;return void 0===c.skin?t:a.getDependency("skin",c.skin).then(function(t){for(var i=[],n=0,e=(u=t).joints.length;n<e;n++)i.push(a.getDependency("node",u.joints[n]));return Promise.all(i)}).then(function(s){return t.traverse(function(t){if(t.isMesh){for(var i=[],n=[],e=0,r=s.length;e<r;e++){var o=s[e];o?(i.push(o),o=new p,void 0!==u.inverseBindMatrices&&o.fromArray(u.inverseBindMatrices.array,16*e),n.push(o)):console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',u.joints[e])}t.bind(new dv(i,n),t.matrixWorld)}}),t})}).then(function(t){u.add(t);var i=[];if(c.children)for(var n=c.children,e=0,r=n.length;e<r;e++){var o=n[e];i.push(s(o,t,h,a))}return Promise.all(i)})}(r[s],e,i,this));return Promise.all(o).then(function(){return e})};var Bv=pv;function Dv(t){return(Dv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fv(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Dv(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Dv(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Dv(t)?t:String(t)}(e.key),e)}}function _v(){return(_v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,n){var e=function(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=Gv(t)););return t}(t,i);if(e)return(e=Object.getOwnPropertyDescriptor(e,i)).get?e.get.call(arguments.length<3?t:n):e.value}).apply(this,arguments)}function Hv(t,i){return(Hv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function Uv(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Gv(n),i=(t=e?(t=Gv(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===Dv(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Gv(t){return(Gv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Vv=function(){var t=o,i=cl;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&Hv(t,i);var n,e=Uv(o);function o(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:ll,i=this,n=o;if(i instanceof n)return(i=e.call(this)).manager=t,i.adjustmentTransform=new p,i;throw new TypeError("Cannot call a class as a function")}return t=o,(i=[{key:"parse",value:function(t){var e=this,u=_v(Gv(o.prototype),"parse",this).call(this,t),r=u.glbBytes.slice().buffer;return new Promise(function(o,t){var i=e.manager,n=e.fetchOptions,i=i.getHandler("path.gltf")||new Bv(i),n=("include"===n.credentials&&"cors"===n.mode&&i.setCrossOrigin("use-credentials"),"credentials"in n&&i.setWithCredentials("include"===n.credentials),n.headers&&i.setRequestHeader(n.headers),e.workingPath),s=(!/[\\/]$/.test(n)&&n.length&&(n+="/"),e.adjustmentTransform);i.parse(r,n,function(t){var i=u.batchTable,n=u.featureTable,e=t.scene,r=n.getData("RTC_CENTER");r&&(e.position.x+=r[0],e.position.y+=r[1],e.position.z+=r[2]),t.scene.updateMatrix(),t.scene.matrix.multiply(s),t.scene.matrix.decompose(t.scene.position,t.scene.quaternion,t.scene.scale),t.batchTable=i,t.featureTable=n,e.batchTable=i,e.featureTable=n,o(t)},t)})}}])&&Fv(t.prototype,i),n&&Fv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}();function qv(t){return(qv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zv(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==qv(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==qv(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===qv(t)?t:String(t)}(e.key),e)}}function Xv(t,i){return(Xv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function Zv(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Wv(n),i=(t=e?(t=Wv(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===qv(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Wv(t){return(Wv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Yv=new p,Kv=function(){var t=r,i=gn;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&Xv(t,i);var n,e=Zv(r);function r(t){var i;if(this instanceof r)return(i=e.call(this)).name="TilesRenderer.TilesGroup",i.tilesRenderer=t,i;throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"raycast",value:function(t,i){this.tilesRenderer.optimizeRaycast&&this.tilesRenderer.raycast(t,i)}},{key:"updateMatrixWorld",value:function(t){if(this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldNeedsUpdate||t){null===this.parent?Yv.copy(this.matrix):Yv.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1;for(var i=Yv.elements,n=this.matrixWorld.elements,e=!1,r=0;r<16;r++){var o=i[r],s=n[r];if(Math.abs(o-s)>Number.EPSILON){e=!0;break}}if(e){this.matrixWorld.copy(Yv);for(var u=this.children,h=0,a=u.length;h<a;h++)u[h].updateMatrixWorld()}}}}])&&zv(t.prototype,i),n&&zv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function Qv(t,i,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==i?i:0,this.theta=void 0!==n?n:0,this}function $v(t){return($v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jv(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==$v(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==$v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===$v(t)?t:String(t)}(e.key),e)}}function ty(t){var i=t.x,n=t.y,e=t.z;t.x=e,t.y=i,t.z=n}Object.assign(Qv.prototype,{set:function(t,i,n){return this.radius=t,this.phi=i,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,i,n){return this.radius=Math.sqrt(t*t+i*i+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(g.clamp(i/this.radius,-1,1))),this}});var iy=new Qv,ny=new j,ey=new j,ry=function(){function o(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,e=this,r=o;if(!(e instanceof r))throw new TypeError("Cannot call a class as a function");this.radius=new j(t,i,n)}var t,i,n;return t=o,(i=[{key:"getCartographicToPosition",value:function(t,i,n,e){var r=this.radius,t=(iy.set(1,-t+Math.PI/2,i),ny.setFromSpherical(iy).normalize(),ty(ny),ey.copy(ny),ey.x*=Math.pow(r.x,2),ey.y*=Math.pow(r.y,2),ey.z*=Math.pow(r.z,2),Math.sqrt(ny.dot(ey)));return ey.divideScalar(t),e.copy(ey).addScaledVector(ny,n)}},{key:"getCartographicToNormal",value:function(t,i,n){return iy.set(1,-t+Math.PI/2,i),n.setFromSpherical(iy).normalize(),ty(n),n}},{key:"getPositionToNormal",value:function(t,i){var n=this.radius;return i.copy(t),i.x/=Math.pow(n.x,2),i.y/=Math.pow(n.y,2),i.z/=Math.pow(n.z,2),i.normalize(),i}}])&&Jv(t.prototype,i),n&&Jv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}();function oy(t){return(oy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sy(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var e,r,o,s,u=[],h=!0,a=!1;try{if(o=(n=n.call(t)).next,0===i){if(Object(n)!==n)return;h=!1}else for(;!(h=(e=o.call(n)).done)&&(u.push(e.value),u.length!==i);h=!0);}catch(t){a=!0,r=t}finally{try{if(!h&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(a)throw r}}return u}}(t,i)||function(t,i){var n;if(t)return"string"==typeof t?uy(t,i):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?uy(t,i):void 0}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uy(t,i){(null==i||i>t.length)&&(i=t.length);for(var n=0,e=new Array(i);n<i;n++)e[n]=t[n];return e}function hy(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==oy(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==oy(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===oy(t)?t:String(t)}(e.key),e)}}function ay(t,i){return(ay=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function cy(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=fy(n),i=(t=e?(t=fy(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===oy(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function fy(t){return(fy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ly=Math.PI,vy=ly/2,yy=new j,dy=new j,by=new j,py=new p,my=0,wy=[];function gy(){my=0}var jy=function(){var t=l,i=ry;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&ay(t,i);var n,f=cy(l);function l(t,i,n){var e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:-vy,r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:vy,o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,s=6<arguments.length&&void 0!==arguments[6]?arguments[6]:2*ly,u=7<arguments.length&&void 0!==arguments[7]?arguments[7]:0,h=8<arguments.length&&void 0!==arguments[8]?arguments[8]:0,a=this,c=l;if(a instanceof c)return(a=f.call(this,t,i,n)).latStart=e,a.latEnd=r,a.lonStart=o,a.lonEnd=s,a.heightStart=u,a.heightEnd=h,a;throw new TypeError("Cannot call a class as a function")}return t=l,(i=[{key:"_getPoints",value:function(){for(var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],i=this.latStart,n=this.latEnd,e=this.lonStart,r=this.lonEnd,o=this.heightStart,s=this.heightEnd,u=g.mapLinear(.5,0,1,i,n),h=g.mapLinear(.5,0,1,e,r),a=Math.floor(e/vy)*vy,c=[[-ly/2,0],[ly/2,0],[0,a],[0,a+ly/2],[0,a+ly],[0,a+3*ly/2],[i,r],[n,r],[i,e],[n,e],[0,e],[0,r],[u,h],[i,h],[n,h],[u,e],[u,r]],f=[],l=c.length,v=0;v<=1;v++)for(var y=g.mapLinear(v,0,1,o,s),d=0,b=l;d<b;d++){var p,m=sy(c[d],2),w=m[0],m=m[1];i<=w&&w<=n&&e<=m&&m<=r&&(p=function(t){return 0<arguments.length&&void 0!==t&&t?(wy[my]||(wy[my]=new j),wy[++my-1]):new j}(t),f.push(p),this.getCartographicToPosition(w,m,y,p))}return f}},{key:"getBoundingBox",value:function(t,i){gy();for(var n=this.latStart,e=this.latEnd,r=this.lonStart,o=this.lonEnd,s=(e-n<ly/2?(n=g.mapLinear(.5,0,1,n,e),e=g.mapLinear(.5,0,1,r,o),this.getCartographicToNormal(n,e,by),dy.set(0,0,1),yy.crossVectors(dy,by),dy.crossVectors(yy,by)):(yy.set(1,0,0),dy.set(0,1,0),by.set(0,0,1)),i.makeBasis(yy,dy,by),py.copy(i).invert(),this._getPoints(!0)),u=0,h=s.length;u<h;u++)s[u].applyMatrix4(py);t.makeEmpty(),t.setFromPoints(s)}},{key:"getBoundingSphere",value:function(t,i){gy();var n=this._getPoints(!0);t.makeEmpty(),t.setFromPoints(n,i)}}])&&hy(t.prototype,i),n&&hy(t,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(),My=new ci,Sy=new p,Oy=new j,Ey=new j,ky=new Bi,Ty=[];function Ry(t,i){return t.distance-i.distance}function Ay(t,i,n){t.traverse(function(t){Object.getPrototypeOf(t).raycast.call(t,i,n)})}function xy(t){return(xy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Py(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,i){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var e,r,o,s,u=[],h=!0,a=!1;try{if(o=(n=n.call(t)).next,0===i){if(Object(n)!==n)return;h=!1}else for(;!(h=(e=o.call(n)).done)&&(u.push(e.value),u.length!==i);h=!0);}catch(t){a=!0,r=t}finally{try{if(!h&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(a)throw r}}return u}}(t,i)||function(t,i){var n;if(t)return"string"==typeof t?Cy(t,i):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cy(t,i):void 0}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cy(t,i){(null==i||i>t.length)&&(i=t.length);for(var n=0,e=new Array(i);n<i;n++)e[n]=t[n];return e}function Ly(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,_y(e.key),e)}}function Iy(){return(Iy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,n){var e=Hy(t,i);if(e)return(e=Object.getOwnPropertyDescriptor(e,i)).get?e.get.call(arguments.length<3?t:n):e.value}).apply(this,arguments)}function Ny(t,i){return(Ny=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function By(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=Uy(n),i=(t=e?(t=Uy(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===xy(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Dy(i)}}function Dy(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Fy(t,i,n,e){return(Fy="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(t,i,n,e){var r,t=Hy(t,i);if(t){if((r=Object.getOwnPropertyDescriptor(t,i)).set)return r.set.call(e,n),!0;if(!r.writable)return!1}if(r=Object.getOwnPropertyDescriptor(e,i)){if(!r.writable)return!1;r.value=n,Object.defineProperty(e,i,r)}else t=e,r=n,!((e=_y(e=i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r);return!0})(t,i,n,e)}function _y(t){t=function(t,i){if("object"!==xy(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==xy(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===xy(t)?t:String(t)}function Hy(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=Uy(t)););return t}function Uy(t){return(Uy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Gy=Symbol("INITIAL_FRUSTUM_CULLED"),Vy=new p,qy=new p,zy=new j,Xy=new j,Zy=new j,Wy=new j,Yy=new j(1,0,0),Ky=new j(0,1,0);function Qy(t,i){t.traverse(function(t){t.frustumCulled=t[Gy]&&i})}var $y=function(){var t=b,i=qf;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&Ny(t,i);var n,u=By(b);function b(){var i,t=this,n=b;if(!(t instanceof n))throw new TypeError("Cannot call a class as a function");for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];(i=u.call.apply(u,[this].concat(r))).group=new Kv(Dy(i)),i.cameras=[],i.cameraMap=new Map,i.cameraInfo=[],i.activeTiles=new Set,i.visibleTiles=new Set,i.vi=!0,i.optimizeRaycast=!0,i.onLoadTileSet=null,i.onLoadModel=null,i.onDisposeModel=null,i.onTileVisibilityChange=null;var t=new fl,s=(t.setURLModifier(function(t){return i.preprocessURL?i.preprocessURL(t):t}),i.manager=t,Dy(i));return i.yi=function(t,i){s.optimizeRaycast||Object.getPrototypeOf(this).raycast.call(this,t,i)},i}return t=b,(i=[{key:"autoDisableRendererCulling",get:function(){return this.vi},set:function(i){if(this.vi!==i){var t=Uy(b.prototype),n=i,e=!0;if(!Fy(t,"_autoDisableRendererCulling",n,this||t)&&e)throw new TypeError("failed to set property");this.forEachLoadedModel(function(t){Qy(t,!i)})}}},{key:"getBounds",value:function(t){var i,n;return!!this.root&&(i=(n=this.root.cached).box,n=n.boxTransform,!!i)&&(t.copy(i),t.applyMatrix4(n),!0)}},{key:"getOrientedBounds",value:function(t,i){var n,e;return!!this.root&&(n=(e=this.root.cached).box,e=e.boxTransform,!!n)&&(t.copy(n),i.copy(e),!0)}},{key:"getBoundingSphere",value:function(t){var i;return!!this.root&&!!(i=this.root.cached.sphere)&&(t.copy(i),!0)}},{key:"forEachLoadedModel",value:function(n){this.traverse(function(t){var i=t.cached.scene;i&&n(i,t)})}},{key:"raycast",value:function(t,i){var n;this.root&&(t.firstHitOnly?(n=function t(i,n,e,r){var o;if(e.has(i))return Ay(i.cached.scene,r,Ty),0<Ty.length?(1<Ty.length&&Ty.sort(Ry),o=Ty[0],Ty.length=0,o):null;for(var s=[],u=i.children,h=0,a=u.length;h<a;h++){var c=u[h],f=c.cached,l=n.matrixWorld;Sy.copy(l),(l=f.sphere)&&(My.copy(l),My.applyMatrix4(Sy),!r.ray.intersectsSphere(My))||(l=f.box,f=f.boxTransform,l&&(Sy.multiply(f).invert(),ky.copy(r.ray),ky.applyMatrix4(Sy),ky.intersectBox(l,Oy))&&(Ey.setFromMatrixScale(Sy),f=Ey.x,1e-6<Math.abs(Math.max(Ey.x-Ey.y,Ey.x-Ey.z))&&console.warn("ThreeTilesRenderer : Non uniform scale used for tile which may cause issues when raycasting."),s.push(l={distance:1/0,tile:null}),l.distance=Oy.distanceToSquared(ky.origin)*f*f,l.tile=c))}s.sort(Ry);for(var v=1/0,y=null,d=0,b=s.length;d<b;d++){var p=s[d];if(v<p.distance)break;var m=(p=p.tile).cached.scene,w=null;e.has(p)?(Ay(m,r,Ty),0<Ty.length&&(1<Ty.length&&Ty.sort(Ry),w=Ty[0])):w=t(p,n,e,r),w&&((m=w.distance*w.distance)<v&&(v=m,y=w),Ty.length=0)}return y}(this.root,this.group,this.activeTiles,t))&&i.push(n):function t(i,n,e,r,o){var s=i.cached,u=n.matrixWorld,u=(Sy.copy(u),s.sphere);if(!u||(My.copy(u),My.applyMatrix4(Sy),r.ray.intersectsSphere(My))){var u=s.box,h=s.boxTransform;if(!u||(Sy.multiply(h).invert(),ky.copy(r.ray).applyMatrix4(Sy),ky.intersectsBox(u)))if(h=s.scene,e.has(i))Ay(h,r,o);else for(var a=i.children,c=0,f=a.length;c<f;c++)t(a[c],n,e,r,o)}}(this.root,this.group,this.activeTiles,t,i))}},{key:"hasCamera",value:function(t){return this.cameraMap.has(t)}},{key:"setCamera",value:function(t){var i=this.cameras,n=this.cameraMap;return!n.has(t)&&(n.set(t,new I),i.push(t),!0)}},{key:"setResolution",value:function(t,i,n){var e=this.cameraMap;return!!e.has(t)&&(i instanceof I?e.get(t).copy(i):e.get(t).set(i,n),!0)}},{key:"setResolutionFromRenderer",value:function(t,i){var n=this.cameraMap;return!!n.has(t)&&(n=n.get(t),i.getSize(n),n.multiplyScalar(i.getPixelRatio()),!0)}},{key:"deleteCamera",value:function(t){var i,n=this.cameras,e=this.cameraMap;return!!e.has(t)&&(i=n.indexOf(t),n.splice(i,1),e.delete(t),!0)}},{key:"fetchTileSet",value:function(i){for(var n=this,t=arguments.length,e=new Array(1<t?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];var o=(o=Iy(Uy(b.prototype),"fetchTileSet",this)).call.apply(o,[this,i].concat(e));return o.then(function(t){n.onLoadTileSet&&Promise.resolve().then(function(){n.onLoadTileSet(t,i)}).catch(function(t){})}).catch(function(t){}),o}},{key:"update",value:function(){var t=this.group,i=this.cameras,n=this.cameraMap,e=this.cameraInfo;if(0===i.length)console.warn("TilesRenderer: no cameras defined. Cannot update 3d tiles.");else{for(;e.length>i.length;)e.pop();for(;e.length<i.length;)e.push({frustum:new bl,isOrthographic:!1,sseDenominator:-1,position:new j,invScale:-1,pixelSize:0});qy.copy(t.matrixWorld).invert(),zy.setFromMatrixScale(qy);var r=zy.x;1e-6<Math.abs(Math.max(zy.x-zy.y,zy.x-zy.z))&&console.warn("ThreeTilesRenderer : Non uniform scale used for tile which may cause issues when calculating screen space error.");for(var o=0,s=e.length;o<s;o++){var u,h,a=i[o],c=e[o],f=c.frustum,l=c.position,v=n.get(a),y=(0!==v.width&&0!==v.height||console.warn("TilesRenderer: resolution for camera error calculation is not set."),a.projectionMatrix.elements);c.isOrthographic=1===y[15],c.isOrthographic?(u=2/y[0],h=2/y[5],c.pixelSize=Math.max(h/v.height,u/v.width)):c.sseDenominator=2/y[5]/v.height,c.invScale=r,Vy.copy(t.matrixWorld),Vy.premultiply(a.matrixWorldInverse),Vy.premultiply(a.projectionMatrix),f.setFromProjectionMatrix(Vy),l.set(0,0,0),l.applyMatrix4(a.matrixWorld),l.applyMatrix4(qy)}Iy(Uy(b.prototype),"update",this).call(this)}}},{key:"preprocessNode",value:function(t,i,n){Iy(Uy(b.prototype),"preprocessNode",this).call(this,t,i,n);var e=new p;if(t.transform)for(var r=t.transform,o=0;o<16;o++)e.elements[o]=r[o];else e.identity();i&&e.premultiply(i.cached.transform);var s,u,h,a,c,f,n=(new p).copy(e).invert(),i=null,l=null,v=null,y=("box"in t.boundingVolume&&(y=t.boundingVolume.box,i=new Nt,l=new p,v=new p,Xy.set(y[3],y[4],y[5]),Zy.set(y[6],y[7],y[8]),Wy.set(y[9],y[10],y[11]),f=Xy.length(),s=Zy.length(),d=Wy.length(),Xy.normalize(),Zy.normalize(),Wy.normalize(),0===f&&Xy.crossVectors(Zy,Wy),0===s&&Zy.crossVectors(Xy,Wy),0===d&&Wy.crossVectors(Xy,Zy),l.set(Xy.x,Zy.x,Wy.x,y[0],Xy.y,Zy.y,Wy.y,y[1],Xy.z,Zy.z,Wy.z,y[2],0,0,0,1),l.premultiply(e),v.copy(l).invert(),i.min.set(-f,-s,-d),i.max.set(f,s,d)),null),d=("sphere"in t.boundingVolume?(f=t.boundingVolume.sphere,(y=new ci).center.set(f[0],f[1],f[2]),y.radius=f[3],y.applyMatrix4(e)):"box"in t.boundingVolume&&(s=t.boundingVolume.box,y=new ci,i.getBoundingSphere(y),y.center.set(s[0],s[1],s[2]),y.applyMatrix4(e)),null);"region"in t.boundingVolume&&(s=(f=Py(t.boundingVolume.region,6))[0],u=f[1],h=f[2],a=f[3],c=f[4],f=f[5],d=new jy(xf,xf,6356752.314245179,u,a,s,h,c,f),null===y&&(y=new ci,d.getBoundingSphere(y)),null===i)&&(i=new Nt,l=new p,v=new p,d.getBoundingBox(i,l),v.copy(l).invert()),t.cached={loadIndex:0,transform:e,transformInverse:n,active:!1,inFrustum:[],box:i,boxTransform:l,boxTransformInverse:v,sphere:y,region:d,scene:null,geometry:null,material:null}}},{key:"parseTile",value:function(t,i,n){var e=this;i.di=i.di||0,i.di++;var r=i.content.uri.split(/[\\\/]/g),r=(r.pop(),r.join("/")),o=this.fetchOptions,s=this.manager,u=i.di,h=this.rootTileSet.asset&&this.rootTileSet.asset.gltfUpAxis||"y",a=i.cached,c=a.transform;switch(h.toLowerCase()){case"x":Vy.makeRotationAxis(Ky,-Math.PI/2);break;case"y":Vy.makeRotationAxis(Yy,Math.PI/2);break;case"z":Vy.identity()}var f=rl(t)||n;return("b3dm"===f?((h=new Vv(s)).workingPath=r,h.fetchOptions=o,h.adjustmentTransform.copy(Vy),h.parse(t).then(function(t){return t.scene})):(console.warn('TilesRenderer: Content type "'.concat(f,'" not supported.')),Promise.resolve(null))).then(function(t){var r,o,s;i.di===u&&(t.updateMatrix(),"glb"!==f&&"gltf"!==f||t.matrix.multiply(Vy),t.matrix.premultiply(c),t.matrix.decompose(t.position,t.quaternion,t.scale),t.traverse(function(t){t[Gy]=t.frustumCulled}),Qy(t,!e.autoDisableRendererCulling),(a.scene=t).traverse(function(t){t.raycast=e.yi}),r=[],o=[],s=[],t.traverse(function(t){if(t.geometry&&o.push(t.geometry),t.material){var i,n=t.material;for(i in r.push(t.material),n){var e=n[i];e&&e.isTexture&&s.push(e)}}}),a.materials=r,a.geometry=o,a.textures=s,e.onLoadModel)&&e.onLoadModel(t,i)})}},{key:"disposeTile",value:function(t){var i=t.cached;if(i.scene){for(var n=i.materials,e=i.geometry,r=i.textures,o=i.scene.parent,s=0,u=e.length;s<u;s++)e[s].dispose();for(var h=0,a=n.length;h<a;h++)n[h].dispose();for(var c=0,f=r.length;c<f;c++)r[c].dispose();o&&o.remove(i.scene),this.onDisposeModel&&this.onDisposeModel(i.scene,t),i.scene=null,i.materials=null,i.textures=null,i.geometry=null}this.activeTiles.delete(t),this.visibleTiles.delete(t),t.di++}},{key:"setTileVisible",value:function(t,i){var n=t.cached.scene,e=this.visibleTiles,r=this.group;i?(r.add(n),e.add(t),n.updateMatrixWorld(!0)):(r.remove(n),e.delete(t)),this.onTileVisibilityChange&&this.onTileVisibilityChange(n,t,i)}},{key:"setTileActive",value:function(t,i){var n=this.activeTiles;i?n.add(t):n.delete(t)}},{key:"calculateError",value:function(t){for(var i,n,e,r,o=t.cached,s=o.inFrustum,u=this.cameras,h=this.cameraInfo,a=o.sphere,c=o.box,f=o.boxTransformInverse,l=o.transformInverse,v=c&&f,y=-1/0,d=1/0,b=0,p=u.length;b<p;b++)s[b]&&(r=(i=h[b]).invScale,n=void 0,i.isOrthographic?(e=i.pixelSize,n=t.geometricError/(e*r)):(zy.copy(i.position),e=(v?(zy.applyMatrix4(f),c.distanceToPoint(zy)):(zy.applyMatrix4(l),Math.max(a.distanceToPoint(zy),0)))*r,r=i.sseDenominator,n=t.geometricError/(e*r),d=Math.min(d,e)),y=Math.max(y,n));t.Lt=d,t.Ct=y}},{key:"tileInView",value:function(t){var t=t.cached,i=t.sphere,n=t.inFrustum;if(i){for(var e=this.cameraInfo,r=!1,o=0,s=e.length;o<s;o++)e[o].frustum.intersectsSphere(i)?n[o]=r=!0:n[o]=!1;return r}return!0}}])&&Ly(t.prototype,i),n&&Ly(t,n),Object.defineProperty(t,"prototype",{writable:!1}),b}();function Jy(t){return(Jy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function td(t){o.call(this,t),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}function id(t,i){vl.call(this,t,i),this.type="AmbientLight",this.castShadow=void 0}function nd(t){return(nd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ed(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==nd(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==nd(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===nd(t)?t:String(t)}(e.key),e)}}td.prototype=Object.assign(Object.create(o.prototype),{constructor:td,setDecoderPath:function(t){return this.decoderPath=t,this},setDecoderConfig:function(t){return this.decoderConfig=t,this},setWorkerLimit:function(t){return this.workerLimit=t,this},setVerbosity:function(){console.warn("THREE.DRACOLoader: The .setVerbosity() method has been removed.")},setDrawMode:function(){console.warn("THREE.DRACOLoader: The .setDrawMode() method has been removed.")},setSkipDequantization:function(){console.warn("THREE.DRACOLoader: The .setSkipDequantization() method has been removed.")},load:function(t,n,i,e){var r=this,o=new Kl(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),"use-credentials"===this.crossOrigin&&o.setWithCredentials(!0),o.load(t,function(t){var i={attributeIDs:r.defaultAttributeIDs,attributeTypes:r.defaultAttributeTypes,useUniqueIDs:!1};r.decodeGeometry(t,i).then(n).catch(e)},i,e)},decodeDracoFile:function(t,i,n,e){e={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:e||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(t,e).then(i)},decodeGeometry:function(n,e){var t,i=this;for(t in e.attributeTypes){var r=e.attributeTypes[t];void 0!==r.BYTES_PER_ELEMENT&&(e.attributeTypes[t]=r.name)}var o,s=JSON.stringify(e);if(td.taskCache.has(n)){var u=td.taskCache.get(n);if(u.key===s)return u.promise;if(0===n.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var h=this.workerNextTaskID++,u=n.byteLength,u=this.bi(h,u).then(function(t){return o=t,new Promise(function(t,i){o.pi[h]={resolve:t,reject:i},o.postMessage({type:"decode",id:h,taskConfig:e,buffer:n},[n])})}).then(function(t){return i.mi(t.geometry)});return u.finally(function(){o&&h&&i.wi(o,h)}),td.taskCache.set(n,{key:s,promise:u}),u},mi:function(t){var i=new mi;t.index&&i.setIndex(new M(t.index.array,1));for(var n=0;n<t.attributes.length;n++){var e=t.attributes[n],r=e.name,o=e.array,e=e.itemSize;i.setAttribute(r,new M(o,e))}return i},gi:function(n,t){var e=new Kl(this.manager);return e.setPath(this.decoderPath),e.setResponseType(t),new Promise(function(t,i){e.load(n,t,void 0,i)})},preload:function(){return this.ji(),this},ji:function(){var n,t,e=this;return this.decoderPending||(t=[],(n="object"!==("undefined"==typeof WebAssembly?"undefined":Jy(WebAssembly))||"js"===this.decoderConfig.type)?t.push(this.gi("draco_decoder.js","text")):(t.push(this.gi("draco_wasm_wrapper.js","text")),t.push(this.gi("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(function(t){var i=t[0],t=(n||(e.decoderConfig.wasmBinary=t[1]),td.DRACOWorker.toString()),i=["/* draco decoder */",i,"","/* worker */",t.substring(t.indexOf("{")+1,t.lastIndexOf("}"))].join("\n");e.workerSourceURL=URL.createObjectURL(new Blob([i]))})),this.decoderPending},bi:function(t,i){var e=this;return this.ji().then(function(){e.workerPool.length<e.workerLimit?((n=new Worker(e.workerSourceURL)).pi={},n.Mi={},n.Si=0,n.postMessage({type:"init",decoderConfig:e.decoderConfig}),n.onmessage=function(t){var i=t.data;switch(i.type){case"decode":n.pi[i.id].resolve(i);break;case"error":n.pi[i.id].reject(i);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+i.type+'"')}},e.workerPool.push(n)):e.workerPool.sort(function(t,i){return t.Si>i.Si?-1:1});var n=e.workerPool[e.workerPool.length-1];return n.Mi[t]=i,n.Si+=i,n})},wi:function(t,i){t.Si-=t.Mi[i],delete t.pi[i],delete t.Mi[i]},debug:function(){this.workerPool.map(function(t){return t.Si})},dispose:function(){for(var t=0;t<this.workerPool.length;++t)this.workerPool[t].terminate();return this.workerPool.length=0,this}}),td.DRACOWorker=function(){var n,i;onmessage=function(t){var o=t.data;switch(o.type){case"init":n=o.decoderConfig,i=new Promise(function(i){n.onModuleLoaded=function(t){i({draco:t})},DracoDecoderModule(n)});break;case"decode":var s=o.buffer,u=o.taskConfig;i.then(function(t){var t=t.draco,i=new t.Decoder,n=new t.DecoderBuffer;n.Init(new Int8Array(s),s.byteLength);try{var e=function(t,i,n,e){var r,o,s=e.attributeIDs,u=e.attributeTypes,h=i.GetEncodedGeometryType(n);if(h===t.TRIANGULAR_MESH)r=new t.Mesh,o=i.DecodeBufferToMesh(n,r);else{if(h!==t.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");r=new t.PointCloud,o=i.DecodeBufferToPointCloud(n,r)}if(!o.ok()||0===r.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+o.error_msg());var a,c,f,l={index:null,attributes:[]};for(a in s){var v=self[u[a]];if(e.useUniqueIDs)f=s[a],c=i.GetAttributeByUniqueId(r,f);else{if(-1===(f=i.GetAttributeId(r,t[s[a]])))continue;c=i.GetAttribute(r,f)}l.attributes.push(function(t,i,n,e,r,o){var s,u,h=o.num_components(),a=n.num_points()*h;switch(r){case Float32Array:s=new t.DracoFloat32Array,i.GetAttributeFloatForAllPoints(n,o,s),u=new Float32Array(a);break;case Int8Array:s=new t.DracoInt8Array,i.GetAttributeInt8ForAllPoints(n,o,s),u=new Int8Array(a);break;case Int16Array:s=new t.DracoInt16Array,i.GetAttributeInt16ForAllPoints(n,o,s),u=new Int16Array(a);break;case Int32Array:s=new t.DracoInt32Array,i.GetAttributeInt32ForAllPoints(n,o,s),u=new Int32Array(a);break;case Uint8Array:s=new t.DracoUInt8Array,i.GetAttributeUInt8ForAllPoints(n,o,s),u=new Uint8Array(a);break;case Uint16Array:s=new t.DracoUInt16Array,i.GetAttributeUInt16ForAllPoints(n,o,s),u=new Uint16Array(a);break;case Uint32Array:s=new t.DracoUInt32Array,i.GetAttributeUInt32ForAllPoints(n,o,s),u=new Uint32Array(a);break;default:throw new Error("THREE.DRACOLoader: Unexpected attribute type.")}for(var c=0;c<a;c++)u[c]=s.GetValue(c);return t.destroy(s),{name:e,array:u,itemSize:h}}(t,i,r,a,v,c))}if(h===t.TRIANGULAR_MESH){for(var y=r.num_faces(),d=new Uint32Array(3*y),b=new t.DracoInt32Array,p=0;p<y;++p){i.GetFaceFromMesh(r,p,b);for(var m=0;m<3;++m)d[3*p+m]=b.GetValue(m)}l.index={array:d,itemSize:1},t.destroy(b)}return t.destroy(r),l}(t,i,n,u),r=e.attributes.map(function(t){return t.array.buffer});e.index&&r.push(e.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:e},r)}catch(t){console.error(t),self.postMessage({type:"error",id:o.id,error:t.message})}finally{t.destroy(n),t.destroy(i)}})}}},td.taskCache=new WeakMap,td.setDecoderPath=function(){console.warn("THREE.DRACOLoader: The .setDecoderPath() method has been removed. Use instance methods.")},td.setDecoderConfig=function(){console.warn("THREE.DRACOLoader: The .setDecoderConfig() method has been removed. Use instance methods.")},td.releaseDecoderModule=function(){console.warn("THREE.DRACOLoader: The .releaseDecoderModule() method has been removed. Use instance methods.")},td.getDecoderModule=function(){console.warn("THREE.DRACOLoader: The .getDecoderModule() method has been removed. Use instance methods.")},id.prototype=Object.assign(Object.create(vl.prototype),{constructor:id,isAmbientLight:!0});var rd=function(){function i(t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.Oi=t,this.Ei=null,this.ki=null,this.Ti=null,this.Ri=null,this.createLight=this.createLight.bind(this)}var t,n,e;return t=i,(n=[{key:"createLight",value:function(t,i){var n=this.Oi.getMapOptions(),e=n.lockedLight,n=n.lightConfig[i];return t.Ai=new id(n[1].color,n[1].intensity),t.xi=new u,t.Pi=new jl(n[0].color,n[0].intensity),t.Pi.position.set(n[0].position.x,n[0].position.y,n[0].position.z),t.Pi.target=t.xi,t.Ci=new jl(n[2].color,n[2].intensity),t.Ci.position.set(n[2].position.x,n[2].position.y,n[2].position.z),t.Ci.target=t.xi,this.Ei=t,this.ki=i,e&&(this.Li=this.Li.bind(this),this.Oi.on("viewChanged",this.Li)),this}},{key:"createLightByTheme",value:function(t,i,n){return t.Ai=new id(new y("rgb("+n[1].color+")"),n[1].intensity),t.Pi=new jl(new y("rgb("+n[0].color+")"),n[0].intensity),t.Pi.position.set(n[0].position.x,n[0].position.y,n[0].position.z),t.xi=new u,t.xi.position.set(n[0].target.x,n[0].target.y,n[0].target.z),t.Pi.target=t.xi,t.Ci=new jl(new y("rgb("+n[2].color+")"),n[2].intensity),t.Ci.position.set(n[2].position.x,n[2].position.y,n[2].position.z),t.Ii=new u,t.Ii.position.set(n[2].target.x,n[2].target.y,n[2].target.z),t.Ci.target=t.Ii,this.Ei=t,this.ki=i,this}}])&&ed(t.prototype,n),e&&ed(t,e),Object.defineProperty(t,"prototype",{writable:!1}),i}(),od=(Object.assign(rd.prototype,{Ni:function(t){var i=new Qv;return i.setFromVector3(t),i.theta},Bi:function(t,i){var n=new Qv,i=(n.setFromVector3(t),n.theta=i,new j);i.setFromSpherical(n),t.copy(i)},Li:function(){var t,i,n;this.Ei&&(t=this.Ni(this.Oi.camera.position),null===this.Ti&&(i=this.Ni(this.Ei.Pi.position),n=this.Ni(this.Ei.Ci.position),this.Ti=i-t,this.Ri=n-t),i=t+this.Ti,this.Bi(this.Ei.Pi.position,i),n=t+this.Ri,this.Bi(this.Ei.Ci.position,n))},Di:function(){this.Oi.getMapOptions().lockedLight&&this.Oi.off("viewChanged",this.Li)}}),t(0)),sd={NAME_KEY_ERROR:0,MAP_ID_URL_ERROR:2,THEME_ID_URL_ERROR:4,LICENSE_ERROR:8,PATH_ERROR:404,INFO:32,DEFAULT_LEVEL_ERROR:64};function ud(t){return(ud="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hd(i,t){var n,e=Object.keys(i);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(i),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable})),e.push.apply(e,n)),e}function ad(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?hd(Object(r),!0).forEach(function(t){var i,n;i=e,n=r[t=t],(t=ld(t))in i?Object.defineProperty(i,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hd(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function cd(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,ld(e.key),e)}}function fd(t,i,n){return i&&cd(t.prototype,i),n&&cd(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ld(t){t=function(t,i){if("object"!==ud(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==ud(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===ud(t)?t:String(t)}var H0=fd(function t(i){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Fi=ad({data:null,method:"GET",responseType:"json"},i),this._i=null}),vd=(Object.assign(H0.prototype,{Hi:function(t,i,n){var e=this.Fi,r=e.data,o=e.method,s=e.url,u=e.responseType,h=e.header,a=null;if((a=new("undefined"!=typeof XMLHttpRequest?XMLHttpRequest:od.a.global().fengmap.XMLHttpRequest)).responseType=u,a.open(o,s),"object"==ud(h))for(var c in h)a.setRequestHeader(c,h[c]);a.addEventListener("load",function(){200===a.status||0===a.status||201===a.status?t&&t(a.response):i&&(404===a.status?i(sd.PATH_ERROR):2069===a.response.error_code?i(sd.NAME_KEY_ERROR):2063===a.response.error_code?i(sd.MAP_ID_URL_ERROR):400===a.response.error_code?i(sd.THEME_ID_URL_ERROR):i(a.response))}),a.addEventListener("timeout",function(t){n&&n(t)}),a.addEventListener("error",function(t){i&&i(t)}),a.send(JSON.stringify(r)),this._i=a},Di:function(){this._i&&this._i.abort&&(this._i.abort(),this._i=null)}}),H0);var E=function(t){return null!=t};function yd(t){var i;this.name="DeveloperError",this.message=t;try{throw new Error}catch(t){i=t.stack}this.stack=i}E(Object.create)&&((yd.prototype=Object.create(Error.prototype)).constructor=yd),yd.prototype.toString=function(){var t="".concat(this.name,": ").concat(this.message);return E(this.stack)&&(t+="\n".concat(this.stack.toString())),t},yd.throwInstantiationError=function(){throw new yd("This function defines an interface and should not be called directly.")};var k=yd;function dd(t){return(dd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var T={};function bd(t,i,n){return"Expected ".concat(n," to be typeof ").concat(i,", actual typeof was ").concat(t)}T.typeOf={},T.defined=function(t,i){if(!E(i))throw new k("".concat(t," is required, actual value was undefined"))},T.typeOf.func=function(t,i){if("function"!=typeof i)throw new k(bd(dd(i),"function",t))},T.typeOf.string=function(t,i){if("string"!=typeof i)throw new k(bd(dd(i),"string",t))},T.typeOf.number=function(t,i){if("number"!=typeof i)throw new k(bd(dd(i),"number",t))},T.typeOf.number.lessThan=function(t,i,n){if(T.typeOf.number(t,i),n<=i)throw new k("Expected ".concat(t," to be less than ").concat(n,", actual value was ").concat(i))},T.typeOf.number.lessThanOrEquals=function(t,i,n){if(T.typeOf.number(t,i),n<i)throw new k("Expected ".concat(t," to be less than or equal to ").concat(n,", actual value was ").concat(i))},T.typeOf.number.greaterThan=function(t,i,n){if(T.typeOf.number(t,i),i<=n)throw new k("Expected ".concat(t," to be greater than ").concat(n,", actual value was ").concat(i))},T.typeOf.number.greaterThanOrEquals=function(t,i,n){if(T.typeOf.number(t,i),i<n)throw new k("Expected ".concat(t," to be greater than or equal to ").concat(n,", actual value was ").concat(i))},T.typeOf.object=function(t,i){if("object"!==dd(i))throw new k(bd(dd(i),"object",t))},T.typeOf.bool=function(t,i){if("boolean"!=typeof i)throw new k(bd(dd(i),"boolean",t))},T.typeOf.bigint=function(t,i){if("bigint"!=typeof i)throw new k(bd(dd(i),"bigint",t))},T.typeOf.number.equals=function(t,i,n,e){if(T.typeOf.number(t,n),T.typeOf.number(i,e),n!==e)throw new k("".concat(t," must be equal to ").concat(i,", the actual values are ").concat(n," and ").concat(e))};var R=T;function pd(t,i){return null!=t?t:i}pd.EMPTY_OBJECT=Object.freeze({});var A=pd,x={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,EPSILON21:1e-21,GRAVITATIONALPARAMETER:3986004418e5,SOLAR_RADIUS:6955e5,LUNAR_RADIUS:1737400,SIXTY_FOUR_KILOBYTES:65536,FOUR_GIGABYTES:4294967296},md=(x.sign=A(Math.sign,function(t){return 0===(t=+t)||t!=t?t:0<t?1:-1}),x.signNotZero=function(t){return t<0?-1:1},x.toSNorm=function(t,i){return i=A(i,255),Math.round((.5*x.clamp(t,-1,1)+.5)*i)},x.fromSNorm=function(t,i){return i=A(i,255),x.clamp(t,0,i)/i*2-1},x.normalize=function(t,i,n){return 0===(n=Math.max(n-i,0))?0:x.clamp((t-i)/n,0,1)},x.sinh=A(Math.sinh,function(t){return(Math.exp(t)-Math.exp(-t))/2}),x.cosh=A(Math.cosh,function(t){return(Math.exp(t)+Math.exp(-t))/2}),x.lerp=function(t,i,n){return(1-n)*t+n*i},x.PI=Math.PI,x.ONE_OVER_PI=1/Math.PI,x.PI_OVER_TWO=Math.PI/2,x.PI_OVER_THREE=Math.PI/3,x.PI_OVER_FOUR=Math.PI/4,x.PI_OVER_SIX=Math.PI/6,x.THREE_PI_OVER_TWO=3*Math.PI/2,x.TWO_PI=2*Math.PI,x.ONE_OVER_TWO_PI=1/(2*Math.PI),x.RADIANS_PER_DEGREE=Math.PI/180,x.DEGREES_PER_RADIAN=180/Math.PI,x.RADIANS_PER_ARCSECOND=x.RADIANS_PER_DEGREE/3600,x.toRadians=function(t){if(E(t))return t*x.RADIANS_PER_DEGREE;throw new k("degrees is required.")},x.toDegrees=function(t){if(E(t))return t*x.DEGREES_PER_RADIAN;throw new k("radians is required.")},x.convertLongitudeRange=function(t){var i;if(E(t))return i=x.TWO_PI,(t=t-Math.floor(t/i)*i)<-Math.PI?t+i:t>=Math.PI?t-i:t;throw new k("angle is required.")},x.clampToLatitudeRange=function(t){if(E(t))return x.clamp(t,-1*x.PI_OVER_TWO,x.PI_OVER_TWO);throw new k("angle is required.")},x.negativePiToPi=function(t){if(E(t))return-x.PI<=t&&t<=x.PI?t:x.zeroToTwoPi(t+x.PI)-x.PI;throw new k("angle is required.")},x.zeroToTwoPi=function(t){var i;if(E(t))return 0<=t&&t<=x.TWO_PI?t:(i=x.mod(t,x.TWO_PI),Math.abs(i)<x.EPSILON14&&Math.abs(t)>x.EPSILON14?x.TWO_PI:i);throw new k("angle is required.")},x.mod=function(t,i){if(!E(t))throw new k("m is required.");if(!E(i))throw new k("n is required.");if(0===i)throw new k("divisor cannot be 0.");return x.sign(t)===x.sign(i)&&Math.abs(t)<Math.abs(i)?t:(t%i+i)%i},x.equalsEpsilon=function(t,i,n,e){if(!E(t))throw new k("left is required.");if(!E(i))throw new k("right is required.");n=A(n,0),e=A(e,n);var r=Math.abs(t-i);return r<=e||r<=n*Math.max(Math.abs(t),Math.abs(i))},x.lessThan=function(t,i,n){if(!E(t))throw new k("first is required.");if(!E(i))throw new k("second is required.");if(E(n))return t-i<-n;throw new k("absoluteEpsilon is required.")},x.lessThanOrEquals=function(t,i,n){if(!E(t))throw new k("first is required.");if(!E(i))throw new k("second is required.");if(E(n))return t-i<n;throw new k("absoluteEpsilon is required.")},x.greaterThan=function(t,i,n){if(!E(t))throw new k("first is required.");if(!E(i))throw new k("second is required.");if(E(n))return n<t-i;throw new k("absoluteEpsilon is required.")},x.greaterThanOrEquals=function(t,i,n){if(!E(t))throw new k("first is required.");if(!E(i))throw new k("second is required.");if(E(n))return-n<t-i;throw new k("absoluteEpsilon is required.")},[1]),P=(x.factorial=function(t){if("number"!=typeof t||t<0)throw new k("A number greater than or equal to 0 is required.");var i=md.length;if(i<=t)for(var n=md[i-1],e=i;e<=t;e++){var r=n*e;md.push(r),n=r}return md[t]},x.incrementWrap=function(t,i,n){if(n=A(n,0),!E(t))throw new k("n is required.");if(i<=n)throw new k("maximumValue must be greater than minimumValue.");return t=i<++t?n:t},x.isPowerOfTwo=function(t){if("number"!=typeof t||t<0||4294967295<t)throw new k("A number between 0 and (2^32)-1 is required.");return 0!==t&&0==(t&t-1)},x.nextPowerOfTwo=function(t){if("number"!=typeof t||t<0||2147483648<t)throw new k("A number between 0 and 2^31 is required.");return--t,t=(t=(t=(t=(t|=t>>1)|t>>2)|t>>4)|t>>8)|t>>16,++t},x.previousPowerOfTwo=function(t){if("number"!=typeof t||t<0||4294967295<t)throw new k("A number between 0 and (2^32)-1 is required.");return t=((t=(t=(t=(t=(t=(t|=t>>1)|t>>2)|t>>4)|t>>8)|t>>16)|t>>32)>>>0)-(t>>>1)},x.clamp=function(t,i,n){return R.typeOf.number("value",t),R.typeOf.number("min",i),R.typeOf.number("max",n),t<i?i:n<t?n:t},x.nextRandomNumber=function(){return randomNumberGenerator.random()},x.randomBetween=function(t,i){return x.nextRandomNumber()*(i-t)+t},x.acosClamped=function(t){if(E(t))return Math.acos(x.clamp(t,-1,1));throw new k("value is required.")},x.asinClamped=function(t){if(E(t))return Math.asin(x.clamp(t,-1,1));throw new k("value is required.")},x.chordLength=function(t,i){if(!E(t))throw new k("angle is required.");if(E(i))return 2*i*Math.sin(.5*t);throw new k("radius is required.")},x.logBase=function(t,i){if(!E(t))throw new k("number is required.");if(E(i))return Math.log(t)/Math.log(i);throw new k("base is required.")},x.cbrt=A(Math.cbrt,function(t){var i=Math.pow(Math.abs(t),1/3);return t<0?-i:i}),x.log2=A(Math.log2,function(t){return Math.log(t)*Math.LOG2E}),x.fog=function(t,i){t*=i;return 1-Math.exp(-t*t)},x.fastApproximateAtan=function(t){return R.typeOf.number("x",t),t*(-.1784*Math.abs(t)-.0663*t*t+1.0301)},x.fastApproximateAtan2=function(t,i){R.typeOf.number("x",t),R.typeOf.number("y",i);var n=Math.abs(t),e=Math.abs(i),r=Math.max(n,e),e=Math.min(n,e)/r;if(isNaN(e))throw new k("either x or y must be nonzero");return n=x.fastApproximateAtan(e),n=Math.abs(i)>Math.abs(t)?x.PI_OVER_TWO-n:n,n=t<0?x.PI-n:n,i<0?-n:n},x);function C(t,i,n){this.x=A(t,0),this.y=A(i,0),this.z=A(n,0)}C.fromSpherical=function(t,i){R.typeOf.object("spherical",t),E(i)||(i=new C);var n=t.clock,e=t.cone,t=A(t.magnitude,1),r=t*Math.sin(e);return i.x=r*Math.cos(n),i.y=r*Math.sin(n),i.z=t*Math.cos(e),i},C.fromElements=function(t,i,n,e){return E(e)?(e.x=t,e.y=i,e.z=n,e):new C(t,i,n)},C.fromCartesian4=C.clone=function(t,i){if(E(t))return E(i)?(i.x=t.x,i.y=t.y,i.z=t.z,i):new C(t.x,t.y,t.z)},C.packedLength=3,C.pack=function(t,i,n){return R.typeOf.object("value",t),R.defined("array",i),n=A(n,0),i[n++]=t.x,i[n++]=t.y,i[n]=t.z,i},C.unpack=function(t,i,n){return R.defined("array",t),i=A(i,0),(n=E(n)?n:new C).x=t[i++],n.y=t[i++],n.z=t[i],n},C.packArray=function(t,i){R.defined("array",t);var n=t.length,e=3*n;if(E(i)){if(!Array.isArray(i)&&i.length!==e)throw new k("If result is a typed array, it must have exactly array.length * 3 elements");i.length!==e&&(i.length=e)}else i=new Array(e);for(var r=0;r<n;++r)C.pack(t[r],i,3*r);return i},C.unpackArray=function(t,i){if(R.defined("array",t),R.typeOf.number.greaterThanOrEquals("array.length",t.length,3),t.length%3!=0)throw new k("array length must be a multiple of 3.");var n=t.length;E(i)?i.length=n/3:i=new Array(n/3);for(var e=0;e<n;e+=3){var r=e/3;i[r]=C.unpack(t,e,i[r])}return i},C.fromArray=C.unpack,C.maximumComponent=function(t){return R.typeOf.object("cartesian",t),Math.max(t.x,t.y,t.z)},C.minimumComponent=function(t){return R.typeOf.object("cartesian",t),Math.min(t.x,t.y,t.z)},C.minimumByComponent=function(t,i,n){return R.typeOf.object("first",t),R.typeOf.object("second",i),R.typeOf.object("result",n),n.x=Math.min(t.x,i.x),n.y=Math.min(t.y,i.y),n.z=Math.min(t.z,i.z),n},C.maximumByComponent=function(t,i,n){return R.typeOf.object("first",t),R.typeOf.object("second",i),R.typeOf.object("result",n),n.x=Math.max(t.x,i.x),n.y=Math.max(t.y,i.y),n.z=Math.max(t.z,i.z),n},C.clamp=function(t,i,n,e){R.typeOf.object("value",t),R.typeOf.object("min",i),R.typeOf.object("max",n),R.typeOf.object("result",e);var r=P.clamp(t.x,i.x,n.x),o=P.clamp(t.y,i.y,n.y),t=P.clamp(t.z,i.z,n.z);return e.x=r,e.y=o,e.z=t,e},C.magnitudeSquared=function(t){return R.typeOf.object("cartesian",t),t.x*t.x+t.y*t.y+t.z*t.z},C.magnitude=function(t){return Math.sqrt(C.magnitudeSquared(t))};var wd=new C,gd=(C.distance=function(t,i){return R.typeOf.object("left",t),R.typeOf.object("right",i),C.subtract(t,i,wd),C.magnitude(wd)},C.distanceSquared=function(t,i){return R.typeOf.object("left",t),R.typeOf.object("right",i),C.subtract(t,i,wd),C.magnitudeSquared(wd)},C.normalize=function(t,i){R.typeOf.object("cartesian",t),R.typeOf.object("result",i);var n=C.magnitude(t);if(i.x=t.x/n,i.y=t.y/n,i.z=t.z/n,isNaN(i.x)||isNaN(i.y)||isNaN(i.z))throw new k("normalized result is not a number");return i},C.dot=function(t,i){return R.typeOf.object("left",t),R.typeOf.object("right",i),t.x*i.x+t.y*i.y+t.z*i.z},C.multiplyComponents=function(t,i,n){return R.typeOf.object("left",t),R.typeOf.object("right",i),R.typeOf.object("result",n),n.x=t.x*i.x,n.y=t.y*i.y,n.z=t.z*i.z,n},C.divideComponents=function(t,i,n){return R.typeOf.object("left",t),R.typeOf.object("right",i),R.typeOf.object("result",n),n.x=t.x/i.x,n.y=t.y/i.y,n.z=t.z/i.z,n},C.add=function(t,i,n){return R.typeOf.object("left",t),R.typeOf.object("right",i),R.typeOf.object("result",n),n.x=t.x+i.x,n.y=t.y+i.y,n.z=t.z+i.z,n},C.subtract=function(t,i,n){return R.typeOf.object("left",t),R.typeOf.object("right",i),R.typeOf.object("result",n),n.x=t.x-i.x,n.y=t.y-i.y,n.z=t.z-i.z,n},C.multiplyByScalar=function(t,i,n){return R.typeOf.object("cartesian",t),R.typeOf.number("scalar",i),R.typeOf.object("result",n),n.x=t.x*i,n.y=t.y*i,n.z=t.z*i,n},C.divideByScalar=function(t,i,n){return R.typeOf.object("cartesian",t),R.typeOf.number("scalar",i),R.typeOf.object("result",n),n.x=t.x/i,n.y=t.y/i,n.z=t.z/i,n},C.negate=function(t,i){return R.typeOf.object("cartesian",t),R.typeOf.object("result",i),i.x=-t.x,i.y=-t.y,i.z=-t.z,i},C.abs=function(t,i){return R.typeOf.object("cartesian",t),R.typeOf.object("result",i),i.x=Math.abs(t.x),i.y=Math.abs(t.y),i.z=Math.abs(t.z),i},new C),jd=(C.lerp=function(t,i,n,e){return R.typeOf.object("start",t),R.typeOf.object("end",i),R.typeOf.number("t",n),R.typeOf.object("result",e),C.multiplyByScalar(i,n,gd),e=C.multiplyByScalar(t,1-n,e),C.add(gd,e,e)},new C),Md=new C,Sd=(C.angleBetween=function(t,i){R.typeOf.object("left",t),R.typeOf.object("right",i),C.normalize(t,jd),C.normalize(i,Md);t=C.dot(jd,Md),i=C.magnitude(C.cross(jd,Md,jd));return Math.atan2(i,t)},new C),Od=(C.mostOrthogonalAxis=function(t,i){R.typeOf.object("cartesian",t),R.typeOf.object("result",i);t=C.normalize(t,Sd);return C.abs(t,t),i=t.x<=t.y?t.x<=t.z?C.clone(C.UNIT_X,i):C.clone(C.UNIT_Z,i):t.y<=t.z?C.clone(C.UNIT_Y,i):C.clone(C.UNIT_Z,i)},C.projectVector=function(t,i,n){R.defined("a",t),R.defined("b",i),R.defined("result",n);t=C.dot(t,i)/C.dot(i,i);return C.multiplyByScalar(i,t,n)},C.equals=function(t,i){return t===i||E(t)&&E(i)&&t.x===i.x&&t.y===i.y&&t.z===i.z},C.equalsArray=function(t,i,n){return t.x===i[n]&&t.y===i[n+1]&&t.z===i[n+2]},C.equalsEpsilon=function(t,i,n,e){return t===i||E(t)&&E(i)&&P.equalsEpsilon(t.x,i.x,n,e)&&P.equalsEpsilon(t.y,i.y,n,e)&&P.equalsEpsilon(t.z,i.z,n,e)},C.cross=function(t,i,n){R.typeOf.object("left",t),R.typeOf.object("right",i),R.typeOf.object("result",n);var e=t.x,r=t.y,t=t.z,o=i.x,s=i.y,i=i.z,u=t*o-e*i,e=e*s-r*o;return n.x=r*i-t*s,n.y=u,n.z=e,n},C.midpoint=function(t,i,n){return R.typeOf.object("left",t),R.typeOf.object("right",i),R.typeOf.object("result",n),n.x=.5*(t.x+i.x),n.y=.5*(t.y+i.y),n.z=.5*(t.z+i.z),n},C.fromDegrees=function(t,i,n,e,r){return R.typeOf.number("longitude",t),R.typeOf.number("latitude",i),t=P.toRadians(t),i=P.toRadians(i),C.fromRadians(t,i,n,e,r)},new C),Ed=new C,kd=new C(40680631590769,40680631590769,40408299984661.445),L=(C.fromRadians=function(t,i,n,e,r){R.typeOf.number("longitude",t),R.typeOf.number("latitude",i),n=A(n,0);var e=E(e)?e.radiiSquared:kd,o=Math.cos(i),o=(Od.x=o*Math.cos(t),Od.y=o*Math.sin(t),Od.z=Math.sin(i),Od=C.normalize(Od,Od),C.multiplyComponents(e,Od,Ed),Math.sqrt(C.dot(Od,Ed)));return Ed=C.divideByScalar(Ed,o,Ed),Od=C.multiplyByScalar(Od,n,Od),E(r)||(r=new C),C.add(Ed,Od,r)},C.fromDegreesArray=function(t,i,n){if(R.defined("coordinates",t),t.length<2||t.length%2!=0)throw new k("the number of coordinates must be a multiple of 2 and at least 2");var e=t.length;E(n)?n.length=e/2:n=new Array(e/2);for(var r=0;r<e;r+=2){var o=t[r],s=t[r+1],u=r/2;n[u]=C.fromDegrees(o,s,0,i,n[u])}return n},C.fromRadiansArray=function(t,i,n){if(R.defined("coordinates",t),t.length<2||t.length%2!=0)throw new k("the number of coordinates must be a multiple of 2 and at least 2");var e=t.length;E(n)?n.length=e/2:n=new Array(e/2);for(var r=0;r<e;r+=2){var o=t[r],s=t[r+1],u=r/2;n[u]=C.fromRadians(o,s,0,i,n[u])}return n},C.fromDegreesArrayHeights=function(t,i,n){if(R.defined("coordinates",t),t.length<3||t.length%3!=0)throw new k("the number of coordinates must be a multiple of 3 and at least 3");var e=t.length;E(n)?n.length=e/3:n=new Array(e/3);for(var r=0;r<e;r+=3){var o=t[r],s=t[r+1],u=t[r+2],h=r/3;n[h]=C.fromDegrees(o,s,u,i,n[h])}return n},C.fromRadiansArrayHeights=function(t,i,n){if(R.defined("coordinates",t),t.length<3||t.length%3!=0)throw new k("the number of coordinates must be a multiple of 3 and at least 3");var e=t.length;E(n)?n.length=e/3:n=new Array(e/3);for(var r=0;r<e;r+=3){var o=t[r],s=t[r+1],u=t[r+2],h=r/3;n[h]=C.fromRadians(o,s,u,i,n[h])}return n},C.ZERO=Object.freeze(new C(0,0,0)),C.ONE=Object.freeze(new C(1,1,1)),C.UNIT_X=Object.freeze(new C(1,0,0)),C.UNIT_Y=Object.freeze(new C(0,1,0)),C.UNIT_Z=Object.freeze(new C(0,0,1)),C.prototype.clone=function(t){return C.clone(this,t)},C.prototype.equals=function(t){return C.equals(this,t)},C.prototype.equalsEpsilon=function(t,i,n){return C.equalsEpsilon(this,t,i,n)},C.prototype.toString=function(){return"(".concat(this.x,", ").concat(this.y,", ").concat(this.z,")")},C),Td=new L,Rd=new L;var Ad=function(t,i,n,e,r){if(!E(t))throw new k("cartesian is required.");if(!E(i))throw new k("oneOverRadii is required.");if(!E(n))throw new k("oneOverRadiiSquared is required.");if(!E(e))throw new k("centerToleranceSquared is required.");var o=t.x,s=t.y,u=t.z,h=i.x,a=i.y,i=i.z,c=o*o*h*h,f=s*s*a*a,l=u*u*i*i,h=c+f+l,a=Math.sqrt(1/h),i=L.multiplyByScalar(t,a,Td);if(h<e)return isFinite(a)?L.clone(i,r):void 0;var v=n.x,y=n.y,d=n.z,b=((h=Rd).x=i.x*v*2,h.y=i.y*y*2,h.z=i.z*d*2,(1-a)*L.magnitude(t)/(.5*L.magnitude(h))),p=0;do{var m,w,g,j,M,S,O,p=(O=c*(j=(m=1/(1+(b-=p)*v))*m)+f*(M=(w=1/(1+b*y))*w)+l*(S=(g=1/(1+b*d))*g)-1)/(-2*(c*(j*m)*v+f*(M*w)*y+l*(S*g)*d))}while(Math.abs(O)>P.EPSILON12);return E(r)?(r.x=o*m,r.y=s*w,r.z=u*g,r):new L(o*m,s*w,u*g)};function N(t,i,n){this.longitude=A(t,0),this.latitude=A(i,0),this.height=A(n,0)}N.fromRadians=function(t,i,n,e){return R.typeOf.number("longitude",t),R.typeOf.number("latitude",i),n=A(n,0),E(e)?(e.longitude=t,e.latitude=i,e.height=n,e):new N(t,i,n)},N.fromDegrees=function(t,i,n,e){return R.typeOf.number("longitude",t),R.typeOf.number("latitude",i),t=P.toRadians(t),i=P.toRadians(i),N.fromRadians(t,i,n,e)};var xd=new L,Pd=new L,Cd=new L,Ld=new L(1/6378137,1/6378137,1/6356752.314245179),Id=new L(1/40680631590769,1/40680631590769,1/40408299984661.445),Nd=P.EPSILON1,Bd=(N.fromCartesian=function(t,i,n){var e=E(i)?i.oneOverRadii:Ld,r=E(i)?i.oneOverRadiiSquared:Id,i=E(i)?i._centerToleranceSquared:Nd,e=Ad(t,e,r,i,Pd);if(E(e))return i=L.multiplyComponents(e,r,xd),i=L.normalize(i,i),r=L.subtract(t,e,Cd),e=Math.atan2(i.y,i.x),i=Math.asin(i.z),t=P.sign(L.dot(r,t))*L.magnitude(r),E(n)?(n.longitude=e,n.latitude=i,n.height=t,n):new N(e,i,t)},N.toCartesian=function(t,i,n){return R.defined("cartographic",t),L.fromRadians(t.longitude,t.latitude,t.height,i,n)},N.clone=function(t,i){if(E(t))return E(i)?(i.longitude=t.longitude,i.latitude=t.latitude,i.height=t.height,i):new N(t.longitude,t.latitude,t.height)},N.equals=function(t,i){return t===i||E(t)&&E(i)&&t.longitude===i.longitude&&t.latitude===i.latitude&&t.height===i.height},N.equalsEpsilon=function(t,i,n){return n=A(n,0),t===i||E(t)&&E(i)&&Math.abs(t.longitude-i.longitude)<=n&&Math.abs(t.latitude-i.latitude)<=n&&Math.abs(t.height-i.height)<=n},N.ZERO=Object.freeze(new N(0,0,0)),N.prototype.clone=function(t){return N.clone(this,t)},N.prototype.equals=function(t){return N.equals(this,t)},N.prototype.equalsEpsilon=function(t,i){return N.equalsEpsilon(this,t,i)},N.prototype.toString=function(){return"(".concat(this.longitude,", ").concat(this.latitude,", ").concat(this.height,")")},N);function Dd(t){this.Ui=6378137,this.Gi=1/this.Ui}Object.defineProperties(Dd.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),Dd.mercatorAngleToGeodeticLatitude=function(t){return P.PI_OVER_TWO-2*Math.atan(Math.exp(-t))},Dd.geodeticLatitudeToMercatorAngle=function(t){Dd.MaximumLatitude<t?t=Dd.MaximumLatitude:t<-Dd.MaximumLatitude&&(t=-Dd.MaximumLatitude);t=Math.sin(t);return.5*Math.log((1+t)/(1-t))},Dd.MaximumLatitude=Dd.mercatorAngleToGeodeticLatitude(Math.PI),Dd.prototype.project=function(t,i){var n=this.Ui,e=t.longitude*n,n=Dd.geodeticLatitudeToMercatorAngle(t.latitude)*n,t=t.height;return E(i)?(i.x=e,i.y=n,i.z=t,i):new L(e,n,t)},Dd.prototype.unproject=function(t,i){var n,e;if(E(t))return e=this.Gi,n=t.x*e,e=Dd.mercatorAngleToGeodeticLatitude(t.y*e),t=t.z,E(i)?(i.longitude=n,i.latitude=e,i.height=t,i):new Bd(n,e,t);throw new k("cartesian is required")};var Fd=Dd;function _d(t){return(_d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hd(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==_d(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==_d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===_d(t)?t:String(t)}(e.key),e)}}n=function(){function i(t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.Vi=void 0!==(t=t||{}).url?t.url:"",this.L=null!=t.offset?parseFloat(t.offset):1,this.$=this.L,this.qi=null==t.isClamp||t.isClamp,this.zi=t.decoderURL,this.X=null,this.Oi=null,this.Xi=null,this.St=null,this.Z=new yt,this.Zi=null,this.Wi=this.Wi.bind(this),this.nt=this.nt.bind(this),this.it=!1,this.Yi=null,this.Ki=null,this.Qi=null,this.$i=null,this.Ji=null,this.tn=null,this.nn=null,this.en=null,this.rn=!0}var t,n,e;return t=i,(n=[{key:"visible",get:function(){return this.I},set:function(t){this.I=t,this.Z.visible=this.I,this.Oi.enableUpdateRender()}},{key:"addTo",value:function(t){this.Oi=t,this.$=this.Oi.getFloor(this.Oi.getVisibleLevels()[0]).height-this.L,this.Oi.getRenderManager().set3DTilesLayerSceneArr(this.Z),this.ut(),this.sn(),this.rn=!0}},{key:"remove",value:function(){for(var t=this.Oi.getRenderManager().get3DTilesLayerSceneArr(),i=t.length-1;0<=i;i--)t[i]===this.Z&&t.splice(i,1);0==t.length&&(this.Oi.off("update",this.Wi),this.Oi.off("viewModeChanged",this.nt),this.Oi.off("visibleLevelsLoaded",this.nt),this.it=!1),this.Oi.enableUpdateRender(),0==t.length&&(this.Oi=null),this.Ki&&(this.Ki.dispose(),this.Ki=null)}}])&&Hd(t.prototype,n),e&&Hd(t,e),Object.defineProperty(t,"prototype",{writable:!1}),i}(),Object.assign(n.prototype,{ut:function(){this.it||(this.Zi=new rd(this.Oi).createLight(this,"FMExternalModelLayer"),this.X=this.Oi.getContainer(),this.Oi.on("update",this.Wi),this.Oi.on("viewModeChanged",this.nt),this.Oi.on("visibleLevelsLoaded",this.nt),this.Oi.camera.far=1e3*wn.CAMERA_FAR,this.Oi.camera.updateProjectionMatrix(),this.hn(this.Vi),this.it=!0)},sn:function(){this.Z.add(this.Pi),this.Z.add(this.Ai),this.Z.add(this.Ci)},hn:function(t){var i=this;new vd({method:"GET",responseType:"json",url:t}).Hi(function(t){t&&(i.Qi=t.root.transform,i.nn=new p,i.$i=i.an(),i.Ji=new p,i.Ji.makeTranslation(i.$i.offsetX,i.$i.offsetY,i.$),i.Xi=i.Oi.camera,i.St=i.Oi.getRenderManager().renderer,i.cn(),i.fn())},function(t){})},cn:function(){this.Yi=new gn,this.Yi.rotation.set(0,0,0),this.Z.add(this.Yi)},fn:function(){var t,o=this,s=this,i=(this.Ki=new $y(this.Vi),new Bv(this.Ki.manager));this.zi&&((t=new td).setDecoderPath(this.zi),i.setDRACOLoader(t)),this.Ki.fetchOptions.mode="cors",this.Ki.manager.addHandler(/\.gltf$/,i),this.Ki.manager.addHandler(/\.glb$/,i),this.Ki.onLoadModel=function(t){t.traverse(function(t){t.isMesh&&(t.material.map.encoding=3e3,t.material.map.wrapS=Zt,t.material.map.wrapT=Zt,t.material.map.minFilter=Wt)}),s.rn=!0},this.Ki.onDisposeModel=function(t){t.traverse(function(t){t.isMesh&&t.material.dispose()}),s.rn=!0},this.Ki.onLoadTileSet=function(){var t,i,n=new Nt,e=new p,r=new p,n=(r.fromArray(s.Qi),o.Ki.getOrientedBounds(n,e)&&(i=(t=(new j).setFromMatrixPosition(r)).length()),t.normalize()),e=new j(0,1,0),r=o.rotationBetweenDirections(n,e);o.Ki.group.quaternion.x=r.x,o.Ki.group.quaternion.y=r.y,o.Ki.group.quaternion.z=r.z,o.Ki.group.quaternion.w=r.w,o.Ki.group.position.y=-i,s.rn=!0},this.Yi.add(this.Ki.group),this.Yi.position.x=s.$i.offsetX,this.Yi.position.z=s.$i.offsetY,this.Yi.position.y=s.$,this.Yi.rotation.y=P.PI-P.PI/20},rotationBetweenDirections:function(t,i){var n=new _,e=(new j).crossVectors(t,i);return n.x=e.x,n.y=e.y,n.z=e.z,n.w=1+t.clone().dot(i),n.normalize(),n},an:function(){var t=this.Oi.getCenter(),i=this.Qi[12],n=this.Qi[13],e=this.Qi[14],i=new L(i,n,e),n=Bd.fromCartesian(i),e=(new Fd).project(n);return{offsetX:e.x-t.x,offsetY:t.y-e.y}},Wi:function(){this.Ki&&(this.Ki.setCamera(this.Xi),this.Ki.setResolutionFromRenderer(this.Xi,this.St),this.Ki.update(),this.rn)&&(null!=this.Oi&&this.Oi.enableUpdateRender(),this.rn=!1)},nt:function(t){"viewModeChanged"==t.type&&(this.Ki.deleteCamera(this.Xi),this.Xi=this.Oi.camera,this.Xi.far===wn.CAMERA_FAR&&(this.Xi.far=1e3*wn.CAMERA_FAR,this.Xi.updateProjectionMatrix()),this.Ki.setCamera(this.Xi),this.Ki.setResolutionFromRenderer(this.Xi,this.St),this.Ki.update()),this.$=this.Oi.getFloor(this.Oi.getVisibleLevels()[0]).height-this.L,this.qi&&(this.Yi.position.y=this.$)}}),U0=n;function Ud(t,i,n,e){t=t||10,i=i||10,n=new y(void 0!==n?n:4473924),e=new y(void 0!==e?e:8947848);for(var r=i/2,o=t/i,s=t/2,u=[],h=[],a=0,c=0,f=-s;a<=i;a++,f+=o){u.push(-s,0,f,s,0,f),u.push(f,0,-s,f,0,s);var l=a===r?n:e;l.toArray(h,c),c+=3,l.toArray(h,c),c+=3,l.toArray(h,c),c+=3,l.toArray(h,c),c+=3}var t=new mi,v=(t.setAttribute("position",new S(u,3)),t.setAttribute("color",new S(h,3)),new Gl({vertexColors:!0,toneMapped:!1}));b0.call(this,t,v)}function Gd(t){return(Gd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vd(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==Gd(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==Gd(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===Gd(t)?t:String(t)}(e.key),e)}}Ud.prototype=Object.assign(Object.create(b0.prototype),{constructor:Ud,copy:function(t){return b0.prototype.copy.call(this,t),this.geometry.copy(t.geometry),this.material.copy(t.material),this},clone:function(){return(new this.constructor).copy(this)}});_0=function(){function i(t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.L=t.offset,void 0===this.L&&(this.L=1),this.ln=t.color,void 0===this.ln&&(this.ln="#6E6A62"),this.vn=t.opacity,void 0===this.vn&&(this.vn=1),this.yn=t.gridColor,void 0===this.yn&&(this.yn="#000000"),this.dn=t.gridOpacity,void 0===this.dn&&(this.dn=.1),this.C=1e3,this.Z=new yt,this.tt=new Ri(new j(0,1,0),0),this.Y=new bn,this.bn=null,this.pn=null,this.mn=null,this.Oi=null,this.I=!0,this.yt=this.yt.bind(this)}var t,n,e;return t=i,(n=[{key:"color",get:function(){return this.ln},set:function(t){this.ln=t,this.pn.material.color=new y(t),this.wn()}},{key:"opacity",get:function(){return this.vn},set:function(t){this.vn=t,this.pn.material.opacity=t,this.wn()}},{key:"gridColor",get:function(){return this.yn},set:function(t){this.yn=t,this.mn.material.color=new y(t),this.wn()}},{key:"gridOpacity",get:function(){return this.dn},set:function(t){this.dn=t,this.mn.material.opacity=t,this.wn()}},{key:"visible",get:function(){return this.I},set:function(t){this.I=t,this.pn.visible=t,this.mn.visible=t,this.wn()}},{key:"addTo",value:function(t){this.Oi=t,this.bn=this.Oi.getBuilding(this.Oi.getMapOptions().mapID).bound,this.C=20*Math.ceil(Math.max(this.bn.size.x,this.bn.size.y)),this.Oi.getRenderManager().setGroundLayerScene(this.Z),this.gn(),this.wn()}},{key:"remove",value:function(){this.Z.remove(this.pn),this.Z.remove(this.mn),this.pn.geometry.dispose(),this.pn=void 0,this.mn.material.dispose(),this.mn=void 0,this.Oi.off("levelChanged",this.yt),this.Oi.getRenderManager().setGroundLayerScene(void 0),this.Oi.enableUpdateRender()}}])&&Vd(t.prototype,n),e&&Vd(t,e),Object.defineProperty(t,"prototype",{writable:!1}),i}(),Object.assign(_0.prototype,{gn:function(){this.pn=new vn(new wi(this.C,this.C),new ji({color:new y(this.ln),opacity:this.vn,transparent:!0,depthWrite:!1})),this.pn.material.polygonOffset=!0,this.pn.material.polygonOffsetFactor=1,this.pn.material.polygonOffsetUnits=4;var t=this.Oi.getFloor(this.Oi.getVisibleLevels()[0]).height-this.L;this.pn.position.x=this.bn.center.x-this.Oi.x,this.pn.position.y=t,this.pn.position.z=this.Oi.y-this.bn.center.y,this.pn.rotation.x=-Math.PI/2,this.Z.add(this.pn),this.mn=new Ud(this.C,40,this.yn,this.yn),this.mn.material.opacity=this.dn,this.mn.material.depthWrite=!1,this.mn.material.transparent=!0,this.mn.material.polygonOffset=!0,this.mn.material.polygonOffsetFactor=1,this.mn.material.polygonOffsetUnits=4,this.mn.position.x=this.bn.center.x-this.Oi.x,this.mn.position.y=t,this.mn.position.z=this.Oi.y-this.bn.center.y,this.Z.add(this.mn),this.Oi.on("levelChanged",this.yt)},yt:function(){var t=this.Oi.getFloor(this.Oi.getVisibleLevels()[0]).height-this.L;this.pn.position.y=t,this.mn.position.y=t},wn:function(){this.Oi.enableUpdateRender()}}),t=_0,H0=window.fengmap||{};H0.FMTileLayer=i,H0.FM3DTilesLayer=U0,H0.FMTileProvider=a,H0.FMGroundLayer=t,D.default=H0}],e={},r.m=n,r.c=e,r.d=function(t,i,n){r.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"jn",{value:!0})},r.t=function(i,t){if(1&t&&(i=r(i)),8&t)return i;if(4&t&&"object"==typeof i&&i&&i.jn)return i;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:i}),2&t&&"string"!=typeof i)for(var e in i)r.d(n,e,function(t){return i[t]}.bind(null,e));return n},r.n=function(t){var i=t&&t.jn?function(){return t.default}:function(){return t};return r.d(i,"a",i),i},r.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},r.p="",r(r.s=2).default;function r(t){var i;return(e[t]||(i=e[t]={i:t,l:!1,exports:{}},n[t].call(i.exports,i,i.exports,r),i.l=!0,i)).exports}var n,e});